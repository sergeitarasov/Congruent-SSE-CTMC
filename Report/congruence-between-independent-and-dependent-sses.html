<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Congruence between independent and dependent SSEs | Report for Simulations using HiClaSSE model</title>
  <meta name="description" content="4 Congruence between independent and dependent SSEs | Report for Simulations using HiClaSSE model" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Congruence between independent and dependent SSEs | Report for Simulations using HiClaSSE model" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Congruence between independent and dependent SSEs | Report for Simulations using HiClaSSE model" />
  
  
  

<meta name="author" content="Sergei Tarasov" />


<meta name="date" content="2024-02-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="misse-congruence.html"/>
<link rel="next" href="equal-rate-hidden-expansion-ehe.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Setting-up HiClaSSE</a></li>
<li class="chapter" data-level="2" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html"><i class="fa fa-check"></i><b>2</b> Validation of HiClaSSE</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#make-data"><i class="fa fa-check"></i><b>2.0.1</b> Make data</a></li>
<li class="chapter" data-level="2.1" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#bisse-ness-and-hiclasse"><i class="fa fa-check"></i><b>2.1</b> BiSSE-ness and HiClaSSE</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#bisse-ness-likelihood"><i class="fa fa-check"></i><b>2.1.1</b> BiSSE-ness Likelihood</a></li>
<li class="chapter" data-level="2.1.2" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#hiclasse2-likelihood"><i class="fa fa-check"></i><b>2.1.2</b> HiClaSSE2 Likelihood</a></li>
<li class="chapter" data-level="2.1.3" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#compare-models"><i class="fa fa-check"></i><b>2.1.3</b> Compare models</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#bisse-and-hiclasse"><i class="fa fa-check"></i><b>2.2</b> BiSSE and HiClaSSE</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#bisse"><i class="fa fa-check"></i><b>2.2.1</b> BiSSE</a></li>
<li class="chapter" data-level="2.2.2" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#hiclasse2"><i class="fa fa-check"></i><b>2.2.2</b> HiClaSSE2</a></li>
<li class="chapter" data-level="2.2.3" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#compare-models-1"><i class="fa fa-check"></i><b>2.2.3</b> Compare models</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#hisse4-and-hiclasse4"><i class="fa fa-check"></i><b>2.3</b> HiSSE4 and HiClaSSE4</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#hiclasse4"><i class="fa fa-check"></i><b>2.3.1</b> HiClaSSE4</a></li>
<li class="chapter" data-level="2.3.2" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#hisse4"><i class="fa fa-check"></i><b>2.3.2</b> HiSSE4</a></li>
<li class="chapter" data-level="2.3.3" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#compare-models-2"><i class="fa fa-check"></i><b>2.3.3</b> Compare models</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#sampling-fraction-bisse-ness-and-hiclasse"><i class="fa fa-check"></i><b>2.4</b> Sampling fraction: BiSSE-ness and HiClaSSE</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#bisse-ness-likelihood-1"><i class="fa fa-check"></i><b>2.4.1</b> BiSSE-ness Likelihood</a></li>
<li class="chapter" data-level="2.4.2" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#hiclasse2-likelihood-1"><i class="fa fa-check"></i><b>2.4.2</b> HiClaSSE2 Likelihood</a></li>
<li class="chapter" data-level="2.4.3" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#compare-models-3"><i class="fa fa-check"></i><b>2.4.3</b> Compare models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="misse-congruence.html"><a href="misse-congruence.html"><i class="fa fa-check"></i><b>3</b> MiSSE Congruence</a>
<ul>
<li class="chapter" data-level="3.1" data-path="misse-congruence.html"><a href="misse-congruence.html#set-up-q-matrix-for-inference"><i class="fa fa-check"></i><b>3.1</b> SET-UP Q matrix for inference</a></li>
<li class="chapter" data-level="3.2" data-path="misse-congruence.html"><a href="misse-congruence.html#misse-2"><i class="fa fa-check"></i><b>3.2</b> MiSSE-2</a></li>
<li class="chapter" data-level="3.3" data-path="misse-congruence.html"><a href="misse-congruence.html#misse-3-congruent"><i class="fa fa-check"></i><b>3.3</b> MiSSE-3 Congruent</a></li>
<li class="chapter" data-level="3.4" data-path="misse-congruence.html"><a href="misse-congruence.html#misse-3-congruent-inferred-pars"><i class="fa fa-check"></i><b>3.4</b> MiSSE-3 Congruent, Inferred Pars</a></li>
<li class="chapter" data-level="3.5" data-path="misse-congruence.html"><a href="misse-congruence.html#misse-3-non-congruent"><i class="fa fa-check"></i><b>3.5</b> MiSSE-3 Non-congruent</a></li>
<li class="chapter" data-level="3.6" data-path="misse-congruence.html"><a href="misse-congruence.html#another-non-congruent-models"><i class="fa fa-check"></i><b>3.6</b> Another Non-congruent Models</a></li>
<li class="chapter" data-level="3.7" data-path="misse-congruence.html"><a href="misse-congruence.html#zero-extinction"><i class="fa fa-check"></i><b>3.7</b> Zero Extinction</a></li>
<li class="chapter" data-level="3.8" data-path="misse-congruence.html"><a href="misse-congruence.html#results"><i class="fa fa-check"></i><b>3.8</b> Results</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="misse-congruence.html"><a href="misse-congruence.html#likelihood-table"><i class="fa fa-check"></i><b>3.8.1</b> Likelihood table</a></li>
<li class="chapter" data-level="3.8.2" data-path="misse-congruence.html"><a href="misse-congruence.html#mean-absolute-error"><i class="fa fa-check"></i><b>3.8.2</b> Mean absolute error</a></li>
<li class="chapter" data-level="3.8.3" data-path="misse-congruence.html"><a href="misse-congruence.html#parameter-estimates"><i class="fa fa-check"></i><b>3.8.3</b> Parameter estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html"><i class="fa fa-check"></i><b>4</b> Congruence between independent and dependent SSEs</a>
<ul>
<li class="chapter" data-level="4.1" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#read-in-data"><i class="fa fa-check"></i><b>4.1</b> Read in data</a></li>
<li class="chapter" data-level="4.2" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#setting-up-q-matrices-for-inference"><i class="fa fa-check"></i><b>4.2</b> Setting-up Q matrices for inference</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cid4"><i class="fa fa-check"></i><b>4.2.1</b> CID4</a></li>
<li class="chapter" data-level="4.2.2" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cid8-congruent-to-cid4"><i class="fa fa-check"></i><b>4.2.2</b> CID8 (congruent to CID4)</a></li>
<li class="chapter" data-level="4.2.3" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cor8-c-correlated-evolution-congruent-to-cid4"><i class="fa fa-check"></i><b>4.2.3</b> COR8-C (correlated evolution, congruent to CID4)</a></li>
<li class="chapter" data-level="4.2.4" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cor8-nc-non-correlated-evolution-congruent-to-cid4"><i class="fa fa-check"></i><b>4.2.4</b> COR8-NC (Non-correlated evolution, congruent to CID4)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#irreducible-model"><i class="fa fa-check"></i><b>4.3</b> Irreducible model</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cid4-4-pars"><i class="fa fa-check"></i><b>4.3.1</b> CID4 (4 pars)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#inferences-using-parameters-from-cid4"><i class="fa fa-check"></i><b>4.4</b> Inferences using parameters from CID4</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cid8-4-pars"><i class="fa fa-check"></i><b>4.4.1</b> CID8 (4 pars)</a></li>
<li class="chapter" data-level="4.4.2" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cor8-c-4-pars"><i class="fa fa-check"></i><b>4.4.2</b> COR8-C (4 pars)</a></li>
<li class="chapter" data-level="4.4.3" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cor8-nc-4-pars"><i class="fa fa-check"></i><b>4.4.3</b> COR8-NC (4 pars)</a></li>
<li class="chapter" data-level="4.4.4" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cla8-c-4-pars"><i class="fa fa-check"></i><b>4.4.4</b> CLA8-C (4 pars)</a></li>
<li class="chapter" data-level="4.4.5" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cla8-nc-4-pars"><i class="fa fa-check"></i><b>4.4.5</b> CLA8-NC (4 pars)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#maximum-likelihood.-all-models-have-4-pars."><i class="fa fa-check"></i><b>4.5</b> Maximum Likelihood. All models have 4 pars.</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cid8"><i class="fa fa-check"></i><b>4.5.1</b> CID8</a></li>
<li class="chapter" data-level="4.5.2" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cor8-c"><i class="fa fa-check"></i><b>4.5.2</b> COR8-C</a></li>
<li class="chapter" data-level="4.5.3" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cor8-nc"><i class="fa fa-check"></i><b>4.5.3</b> COR8-NC</a></li>
<li class="chapter" data-level="4.5.4" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cla8-c"><i class="fa fa-check"></i><b>4.5.4</b> CLA8-C</a></li>
<li class="chapter" data-level="4.5.5" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cla8-nc"><i class="fa fa-check"></i><b>4.5.5</b> CLA8-NC</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#results-1"><i class="fa fa-check"></i><b>4.6</b> Results</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#inferences-using-parameters-from-cid4-1"><i class="fa fa-check"></i><b>4.6.1</b> Inferences using parameters from CID4</a></li>
<li class="chapter" data-level="4.6.2" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#maximum-likelihood-estimates"><i class="fa fa-check"></i><b>4.6.2</b> Maximum Likelihood estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html"><i class="fa fa-check"></i><b>5</b> Equal Rate Hidden Expansion (EHE)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#read-in-data-1"><i class="fa fa-check"></i><b>5.1</b> Read in data</a></li>
<li class="chapter" data-level="5.2" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#setting-up-q-matrices-for-inference-1"><i class="fa fa-check"></i><b>5.2</b> Setting-up Q matrices for inference</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#cid4-1"><i class="fa fa-check"></i><b>5.2.1</b> CID4</a></li>
<li class="chapter" data-level="5.2.2" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#cid8-congruent-to-cid4-1"><i class="fa fa-check"></i><b>5.2.2</b> CID8 (congruent to CID4)</a></li>
<li class="chapter" data-level="5.2.3" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#ehe8-c-correlated-evolution-congruent-to-cid4"><i class="fa fa-check"></i><b>5.2.3</b> EHE8-C (correlated evolution, congruent to CID4)</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#inferences-using-parameters-from-cid4-2"><i class="fa fa-check"></i><b>5.3</b> Inferences using parameters from CID4</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#cid4-4-pars-1"><i class="fa fa-check"></i><b>5.3.1</b> CID4 (4 pars)</a></li>
<li class="chapter" data-level="5.3.2" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#ehe8-c-2-pars"><i class="fa fa-check"></i><b>5.3.2</b> EHE8-C (2 pars)</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#compare-ln-estimates"><i class="fa fa-check"></i><b>5.4</b> Compare Ln estimates</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html"><i class="fa fa-check"></i><b>6</b> Semi-congruent Behavior</a>
<ul>
<li class="chapter" data-level="6.1" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html#setting-up-q-matrices-for-inference-2"><i class="fa fa-check"></i><b>6.1</b> Setting-up Q matrices for inference</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html#cid4-2"><i class="fa fa-check"></i><b>6.1.1</b> CID4</a></li>
<li class="chapter" data-level="6.1.2" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html#ehe8-c-correlated-evolution-congruent-to-cid4-1"><i class="fa fa-check"></i><b>6.1.2</b> EHE8-C (correlated evolution, congruent to CID4)</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html#read-in-data-2"><i class="fa fa-check"></i><b>6.2</b> Read in data</a></li>
<li class="chapter" data-level="6.3" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html#maximum-likelihood"><i class="fa fa-check"></i><b>6.3</b> Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html#cid4-4-pars-2"><i class="fa fa-check"></i><b>6.3.1</b> CID4 (4 pars)</a></li>
<li class="chapter" data-level="6.3.2" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html#ehe8-c"><i class="fa fa-check"></i><b>6.3.2</b> EHE8-C</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html#results-2"><i class="fa fa-check"></i><b>6.4</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html"><i class="fa fa-check"></i><b>7</b> Congruence under varying Sampling Fraction</a>
<ul>
<li class="chapter" data-level="7.1" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#read-in-data-3"><i class="fa fa-check"></i><b>7.1</b> Read in data</a></li>
<li class="chapter" data-level="7.2" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#setup-sampling-fraction"><i class="fa fa-check"></i><b>7.2</b> Setup Sampling Fraction</a></li>
<li class="chapter" data-level="7.3" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#setting-up-q-matrices-for-inference-3"><i class="fa fa-check"></i><b>7.3</b> Setting-up Q matrices for inference</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cid4-3"><i class="fa fa-check"></i><b>7.3.1</b> CID4</a></li>
<li class="chapter" data-level="7.3.2" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cid8-congruent-to-cid4-2"><i class="fa fa-check"></i><b>7.3.2</b> CID8 (congruent to CID4)</a></li>
<li class="chapter" data-level="7.3.3" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cor8-c-correlated-evolution-congruent-to-cid4-1"><i class="fa fa-check"></i><b>7.3.3</b> COR8-C (correlated evolution, congruent to CID4)</a></li>
<li class="chapter" data-level="7.3.4" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cor8-nc-non-correlated-evolution-congruent-to-cid4-1"><i class="fa fa-check"></i><b>7.3.4</b> COR8-NC (Non-correlated evolution, congruent to CID4)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#irreducible-model-1"><i class="fa fa-check"></i><b>7.4</b> Irreducible model</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cid4-4-pars-3"><i class="fa fa-check"></i><b>7.4.1</b> CID4 (4 pars)</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#inferences-using-parameters-from-cid4-3"><i class="fa fa-check"></i><b>7.5</b> Inferences using parameters from CID4</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cid8-4-pars-1"><i class="fa fa-check"></i><b>7.5.1</b> CID8 (4 pars)</a></li>
<li class="chapter" data-level="7.5.2" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cor8-c-4-pars-1"><i class="fa fa-check"></i><b>7.5.2</b> COR8-C (4 pars)</a></li>
<li class="chapter" data-level="7.5.3" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cor8-nc-4-pars-1"><i class="fa fa-check"></i><b>7.5.3</b> COR8-NC (4 pars)</a></li>
<li class="chapter" data-level="7.5.4" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cla8-c-4-pars-1"><i class="fa fa-check"></i><b>7.5.4</b> CLA8-C (4 pars)</a></li>
<li class="chapter" data-level="7.5.5" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cla8-nc-4-pars-1"><i class="fa fa-check"></i><b>7.5.5</b> CLA8-NC (4 pars)</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#results-3"><i class="fa fa-check"></i><b>7.6</b> Results</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#inferences-using-parameters-from-cid4-4"><i class="fa fa-check"></i><b>7.6.1</b> Inferences using parameters from CID4</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Report for Simulations using HiClaSSE model</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="congruence-between-independent-and-dependent-sses" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Congruence between independent and dependent SSEs<a href="congruence-between-independent-and-dependent-sses.html#congruence-between-independent-and-dependent-sses" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<table>
<colgroup>
<col width="8%" />
<col width="3%" />
<col width="27%" />
<col width="17%" />
<col width="15%" />
<col width="27%" />
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>np</th>
<th>pars</th>
<th>Cong. with CID4</th>
<th>Trait &amp; Div.</th>
<th>Speciation Rates</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CID4</td>
<td>4</td>
<td>2d 1q 1mu</td>
<td>–</td>
<td>independent</td>
<td>decoupled (d)</td>
</tr>
<tr class="even">
<td>CID8</td>
<td>4</td>
<td>2d 1q 1mu</td>
<td>yes</td>
<td>independent</td>
<td>decoupled (d)</td>
</tr>
<tr class="odd">
<td>COR8-C</td>
<td>4</td>
<td>2d 1q 1mu</td>
<td>yes</td>
<td>correlated</td>
<td>decoupled (d)</td>
</tr>
<tr class="even">
<td>CLA8-C</td>
<td>4</td>
<td>2c 1q 1mu</td>
<td>yes</td>
<td>correlated</td>
<td>coupled (c)</td>
</tr>
<tr class="odd">
<td>COR8-NC</td>
<td>4</td>
<td>2d 1q 1mu</td>
<td>no</td>
<td>correlated*</td>
<td>decoupled (d)</td>
</tr>
<tr class="even">
<td>CLA8-NC</td>
<td>4</td>
<td>2c 1q 1mu</td>
<td>no</td>
<td>correlated</td>
<td>coupled* (c)</td>
</tr>
</tbody>
</table>
<p>*indicates non-lumpable transition or speciation rates. See also, Fig. referenced and Table S1.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="congruence-between-independent-and-dependent-sses.html#cb156-1" tabindex="-1"></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb156-2"><a href="congruence-between-independent-and-dependent-sses.html#cb156-2" tabindex="-1"></a><span class="do">##  ~ installations and dependencies  ----</span></span>
<span id="cb156-3"><a href="congruence-between-independent-and-dependent-sses.html#cb156-3" tabindex="-1"></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb156-4"><a href="congruence-between-independent-and-dependent-sses.html#cb156-4" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;R/utils/dependencies.R&#39;</span>)</span>
<span id="cb156-5"><a href="congruence-between-independent-and-dependent-sses.html#cb156-5" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;R/hiclasse/HiClaSSE-R.R&#39;</span>) <span class="co"># pure R implementation of HiCLaSSE</span></span></code></pre></div>
<pre><code>## [1] &quot;Original matrix:&quot;
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
## [1] &quot;Matrix with right diagonal set to zero:&quot;
##      [,1] [,2] [,3]
## [1,]    1    4    0
## [2,]    2    0    8
## [3,]    0    6    9</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="congruence-between-independent-and-dependent-sses.html#cb158-1" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;R/hiclasse/HiClaSSE_cpp.R&#39;</span>) <span class="co"># fast implementation</span></span></code></pre></div>
<pre><code>## [1] &quot;Original matrix:&quot;
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
## [1] &quot;Matrix with right diagonal set to zero:&quot;
##      [,1] [,2] [,3]
## [1,]    1    4    0
## [2,]    2    0    8
## [3,]    0    6    9
## [1] TRUE
## [1] TRUE
## [1] TRUE
## [1] TRUE</code></pre>
<div id="read-in-data" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Read in data<a href="congruence-between-independent-and-dependent-sses.html#read-in-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="congruence-between-independent-and-dependent-sses.html#cb160-1" tabindex="-1"></a>NSIM <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb160-2"><a href="congruence-between-independent-and-dependent-sses.html#cb160-2" tabindex="-1"></a>phy <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file=</span><span class="st">&#39;R/data/phy_CID4.RDS&#39;</span>)</span></code></pre></div>
</div>
<div id="setting-up-q-matrices-for-inference" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Setting-up Q matrices for inference<a href="congruence-between-independent-and-dependent-sses.html#setting-up-q-matrices-for-inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="cid4" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> CID4<a href="congruence-between-independent-and-dependent-sses.html#cid4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="congruence-between-independent-and-dependent-sses.html#cb161-1" tabindex="-1"></a><span class="co"># trait</span></span>
<span id="cb161-2"><a href="congruence-between-independent-and-dependent-sses.html#cb161-2" tabindex="-1"></a>Q_t <span class="ot">&lt;-</span> <span class="fu">initQ</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>))</span>
<span id="cb161-3"><a href="congruence-between-independent-and-dependent-sses.html#cb161-3" tabindex="-1"></a></span>
<span id="cb161-4"><a href="congruence-between-independent-and-dependent-sses.html#cb161-4" tabindex="-1"></a><span class="co"># diversification regime</span></span>
<span id="cb161-5"><a href="congruence-between-independent-and-dependent-sses.html#cb161-5" tabindex="-1"></a>Q_r2 <span class="ot">&lt;-</span> <span class="fu">initQ</span>(<span class="fu">c</span>(<span class="st">&#39;A&#39;</span>,<span class="st">&#39;B&#39;</span>), <span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>))</span>
<span id="cb161-6"><a href="congruence-between-independent-and-dependent-sses.html#cb161-6" tabindex="-1"></a></span>
<span id="cb161-7"><a href="congruence-between-independent-and-dependent-sses.html#cb161-7" tabindex="-1"></a></span>
<span id="cb161-8"><a href="congruence-between-independent-and-dependent-sses.html#cb161-8" tabindex="-1"></a><span class="co"># speciation rates for tracking the order</span></span>
<span id="cb161-9"><a href="congruence-between-independent-and-dependent-sses.html#cb161-9" tabindex="-1"></a>La4 <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="sc">-</span><span class="fl">0.05</span>),<span class="dv">2</span>)</span>
<span id="cb161-10"><a href="congruence-between-independent-and-dependent-sses.html#cb161-10" tabindex="-1"></a>La4 <span class="ot">=</span> La4 <span class="sc">%x%</span> <span class="fu">diag</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb161-11"><a href="congruence-between-independent-and-dependent-sses.html#cb161-11" tabindex="-1"></a><span class="co"># order according to regimes</span></span>
<span id="cb161-12"><a href="congruence-between-independent-and-dependent-sses.html#cb161-12" tabindex="-1"></a>Q_cid4.r <span class="ot">&lt;-</span> <span class="fu">amaSMM</span>(Q_r2, Q_t)</span>
<span id="cb161-13"><a href="congruence-between-independent-and-dependent-sses.html#cb161-13" tabindex="-1"></a></span>
<span id="cb161-14"><a href="congruence-between-independent-and-dependent-sses.html#cb161-14" tabindex="-1"></a><span class="co"># order according to trait</span></span>
<span id="cb161-15"><a href="congruence-between-independent-and-dependent-sses.html#cb161-15" tabindex="-1"></a>v<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>, <span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb161-16"><a href="congruence-between-independent-and-dependent-sses.html#cb161-16" tabindex="-1"></a>Q_cid4.t <span class="ot">&lt;-</span> Q_cid4.r[v,v]</span>
<span id="cb161-17"><a href="congruence-between-independent-and-dependent-sses.html#cb161-17" tabindex="-1"></a></span>
<span id="cb161-18"><a href="congruence-between-independent-and-dependent-sses.html#cb161-18" tabindex="-1"></a><span class="fu">print</span>(Q_cid4.r)</span></code></pre></div>
<pre><code>##      A0   A1   B0   B1
## A0 -0.2  0.1  0.1  0.0
## A1  0.1 -0.2  0.0  0.1
## B0  0.1  0.0 -0.2  0.1
## B1  0.0  0.1  0.1 -0.2</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="congruence-between-independent-and-dependent-sses.html#cb163-1" tabindex="-1"></a><span class="fu">print</span>(La4)</span></code></pre></div>
<pre><code>##      [,1] [,2]  [,3]  [,4]
## [1,] -0.1  0.0  0.00  0.00
## [2,]  0.0 -0.1  0.00  0.00
## [3,]  0.0  0.0 -0.05  0.00
## [4,]  0.0  0.0  0.00 -0.05</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="congruence-between-independent-and-dependent-sses.html#cb165-1" tabindex="-1"></a><span class="fu">print</span>(Q_cid4.t)</span></code></pre></div>
<pre><code>##      A0   B0   A1   B1
## A0 -0.2  0.1  0.1  0.0
## B0  0.1 -0.2  0.0  0.1
## A1  0.1  0.0 -0.2  0.1
## B1  0.0  0.1  0.1 -0.2</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="congruence-between-independent-and-dependent-sses.html#cb167-1" tabindex="-1"></a><span class="fu">print</span>(La4[v,v])</span></code></pre></div>
<pre><code>##      [,1]  [,2] [,3]  [,4]
## [1,] -0.1  0.00  0.0  0.00
## [2,]  0.0 -0.05  0.0  0.00
## [3,]  0.0  0.00 -0.1  0.00
## [4,]  0.0  0.00  0.0 -0.05</code></pre>
</div>
<div id="cid8-congruent-to-cid4" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> CID8 (congruent to CID4)<a href="congruence-between-independent-and-dependent-sses.html#cid8-congruent-to-cid4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="congruence-between-independent-and-dependent-sses.html#cb169-1" tabindex="-1"></a><span class="co"># diversification regime</span></span>
<span id="cb169-2"><a href="congruence-between-independent-and-dependent-sses.html#cb169-2" tabindex="-1"></a><span class="co">#Q_r4 &lt;- initQ(c(&#39;a&#39;,&#39;b&#39;, &#39;c&#39;, &#39;d&#39;), c(.01,.01))</span></span>
<span id="cb169-3"><a href="congruence-between-independent-and-dependent-sses.html#cb169-3" tabindex="-1"></a></span>
<span id="cb169-4"><a href="congruence-between-independent-and-dependent-sses.html#cb169-4" tabindex="-1"></a>Q_r4 <span class="ot">&lt;-</span><span class="fu">amaSMM</span>(Q_t, Q_t) </span>
<span id="cb169-5"><a href="congruence-between-independent-and-dependent-sses.html#cb169-5" tabindex="-1"></a><span class="fu">colnames</span>(Q_r4) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Q_r4) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;d&#39;</span>)</span>
<span id="cb169-6"><a href="congruence-between-independent-and-dependent-sses.html#cb169-6" tabindex="-1"></a></span>
<span id="cb169-7"><a href="congruence-between-independent-and-dependent-sses.html#cb169-7" tabindex="-1"></a><span class="co"># speciation rates for tracking the order</span></span>
<span id="cb169-8"><a href="congruence-between-independent-and-dependent-sses.html#cb169-8" tabindex="-1"></a>La8 <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="sc">-</span><span class="fl">0.05</span>),<span class="dv">2</span>)</span>
<span id="cb169-9"><a href="congruence-between-independent-and-dependent-sses.html#cb169-9" tabindex="-1"></a>La8 <span class="ot">=</span> La8 <span class="sc">%x%</span> <span class="fu">diag</span>(<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb169-10"><a href="congruence-between-independent-and-dependent-sses.html#cb169-10" tabindex="-1"></a></span>
<span id="cb169-11"><a href="congruence-between-independent-and-dependent-sses.html#cb169-11" tabindex="-1"></a><span class="co"># order according to regimes</span></span>
<span id="cb169-12"><a href="congruence-between-independent-and-dependent-sses.html#cb169-12" tabindex="-1"></a>Q_cid8.r <span class="ot">&lt;-</span> <span class="fu">amaSMM</span>(Q_r4, Q_t) </span>
<span id="cb169-13"><a href="congruence-between-independent-and-dependent-sses.html#cb169-13" tabindex="-1"></a></span>
<span id="cb169-14"><a href="congruence-between-independent-and-dependent-sses.html#cb169-14" tabindex="-1"></a><span class="co"># order according to trait</span></span>
<span id="cb169-15"><a href="congruence-between-independent-and-dependent-sses.html#cb169-15" tabindex="-1"></a>v<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>, <span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>)</span>
<span id="cb169-16"><a href="congruence-between-independent-and-dependent-sses.html#cb169-16" tabindex="-1"></a>Q_cid8.t <span class="ot">&lt;-</span> Q_cid8.r[v,v]</span>
<span id="cb169-17"><a href="congruence-between-independent-and-dependent-sses.html#cb169-17" tabindex="-1"></a></span>
<span id="cb169-18"><a href="congruence-between-independent-and-dependent-sses.html#cb169-18" tabindex="-1"></a><span class="fu">print</span>(Q_cid8.r)</span></code></pre></div>
<pre><code>##      a0   a1   b0   b1   c0   c1   d0   d1
## a0 -0.3  0.1  0.1  0.0  0.1  0.0  0.0  0.0
## a1  0.1 -0.3  0.0  0.1  0.0  0.1  0.0  0.0
## b0  0.1  0.0 -0.3  0.1  0.0  0.0  0.1  0.0
## b1  0.0  0.1  0.1 -0.3  0.0  0.0  0.0  0.1
## c0  0.1  0.0  0.0  0.0 -0.3  0.1  0.1  0.0
## c1  0.0  0.1  0.0  0.0  0.1 -0.3  0.0  0.1
## d0  0.0  0.0  0.1  0.0  0.1  0.0 -0.3  0.1
## d1  0.0  0.0  0.0  0.1  0.0  0.1  0.1 -0.3</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="congruence-between-independent-and-dependent-sses.html#cb171-1" tabindex="-1"></a><span class="fu">print</span>(La8)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]  [,5]  [,6]  [,7]  [,8]
## [1,] -0.1  0.0  0.0  0.0  0.00  0.00  0.00  0.00
## [2,]  0.0 -0.1  0.0  0.0  0.00  0.00  0.00  0.00
## [3,]  0.0  0.0 -0.1  0.0  0.00  0.00  0.00  0.00
## [4,]  0.0  0.0  0.0 -0.1  0.00  0.00  0.00  0.00
## [5,]  0.0  0.0  0.0  0.0 -0.05  0.00  0.00  0.00
## [6,]  0.0  0.0  0.0  0.0  0.00 -0.05  0.00  0.00
## [7,]  0.0  0.0  0.0  0.0  0.00  0.00 -0.05  0.00
## [8,]  0.0  0.0  0.0  0.0  0.00  0.00  0.00 -0.05</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="congruence-between-independent-and-dependent-sses.html#cb173-1" tabindex="-1"></a><span class="fu">print</span>(Q_cid8.t)</span></code></pre></div>
<pre><code>##      a0   b0   c0   d0   a1   b1   c1   d1
## a0 -0.3  0.1  0.1  0.0  0.1  0.0  0.0  0.0
## b0  0.1 -0.3  0.0  0.1  0.0  0.1  0.0  0.0
## c0  0.1  0.0 -0.3  0.1  0.0  0.0  0.1  0.0
## d0  0.0  0.1  0.1 -0.3  0.0  0.0  0.0  0.1
## a1  0.1  0.0  0.0  0.0 -0.3  0.1  0.1  0.0
## b1  0.0  0.1  0.0  0.0  0.1 -0.3  0.0  0.1
## c1  0.0  0.0  0.1  0.0  0.1  0.0 -0.3  0.1
## d1  0.0  0.0  0.0  0.1  0.0  0.1  0.1 -0.3</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="congruence-between-independent-and-dependent-sses.html#cb175-1" tabindex="-1"></a><span class="fu">print</span>(La8[v,v])</span></code></pre></div>
<pre><code>##      [,1] [,2]  [,3]  [,4] [,5] [,6]  [,7]  [,8]
## [1,] -0.1  0.0  0.00  0.00  0.0  0.0  0.00  0.00
## [2,]  0.0 -0.1  0.00  0.00  0.0  0.0  0.00  0.00
## [3,]  0.0  0.0 -0.05  0.00  0.0  0.0  0.00  0.00
## [4,]  0.0  0.0  0.00 -0.05  0.0  0.0  0.00  0.00
## [5,]  0.0  0.0  0.00  0.00 -0.1  0.0  0.00  0.00
## [6,]  0.0  0.0  0.00  0.00  0.0 -0.1  0.00  0.00
## [7,]  0.0  0.0  0.00  0.00  0.0  0.0 -0.05  0.00
## [8,]  0.0  0.0  0.00  0.00  0.0  0.0  0.00 -0.05</code></pre>
</div>
<div id="cor8-c-correlated-evolution-congruent-to-cid4" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> COR8-C (correlated evolution, congruent to CID4)<a href="congruence-between-independent-and-dependent-sses.html#cor8-c-correlated-evolution-congruent-to-cid4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="congruence-between-independent-and-dependent-sses.html#cb177-1" tabindex="-1"></a><span class="co"># like CID8 but with correlation</span></span>
<span id="cb177-2"><a href="congruence-between-independent-and-dependent-sses.html#cb177-2" tabindex="-1"></a>Q_cor8_C.t <span class="ot">&lt;-</span> Q_cid8.t</span>
<span id="cb177-3"><a href="congruence-between-independent-and-dependent-sses.html#cb177-3" tabindex="-1"></a></span>
<span id="cb177-4"><a href="congruence-between-independent-and-dependent-sses.html#cb177-4" tabindex="-1"></a>bl <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">1</span>,.<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb177-5"><a href="congruence-between-independent-and-dependent-sses.html#cb177-5" tabindex="-1"></a>Q_cor8_C.t[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> bl</span>
<span id="cb177-6"><a href="congruence-between-independent-and-dependent-sses.html#cb177-6" tabindex="-1"></a>Q_cor8_C.t[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> bl</span>
<span id="cb177-7"><a href="congruence-between-independent-and-dependent-sses.html#cb177-7" tabindex="-1"></a>Q_cor8_C.t[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="ot">&lt;-</span> bl</span>
<span id="cb177-8"><a href="congruence-between-independent-and-dependent-sses.html#cb177-8" tabindex="-1"></a>Q_cor8_C.t[<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> bl</span>
<span id="cb177-9"><a href="congruence-between-independent-and-dependent-sses.html#cb177-9" tabindex="-1"></a></span>
<span id="cb177-10"><a href="congruence-between-independent-and-dependent-sses.html#cb177-10" tabindex="-1"></a>v<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>, <span class="dv">2</span>,<span class="dv">6</span>, <span class="dv">3</span>,<span class="dv">7</span>, <span class="dv">4</span>,<span class="dv">8</span>)</span>
<span id="cb177-11"><a href="congruence-between-independent-and-dependent-sses.html#cb177-11" tabindex="-1"></a>Q_cor8_C.r <span class="ot">&lt;-</span> Q_cor8_C.t[v,v]</span>
<span id="cb177-12"><a href="congruence-between-independent-and-dependent-sses.html#cb177-12" tabindex="-1"></a></span>
<span id="cb177-13"><a href="congruence-between-independent-and-dependent-sses.html#cb177-13" tabindex="-1"></a><span class="fu">print</span>(Q_cor8_C.r)</span></code></pre></div>
<pre><code>##      a0   a1   b0   b1   c0   c1   d0   d1
## a0 -0.3  0.0  0.1  0.1  0.1  0.0  0.0  0.0
## a1  0.0 -0.3  0.1  0.1  0.0  0.1  0.0  0.0
## b0  0.1  0.1 -0.3  0.0  0.0  0.0  0.1  0.0
## b1  0.1  0.1  0.0 -0.3  0.0  0.0  0.0  0.1
## c0  0.1  0.0  0.0  0.0 -0.3  0.0  0.1  0.1
## c1  0.0  0.1  0.0  0.0  0.0 -0.3  0.1  0.1
## d0  0.0  0.0  0.1  0.0  0.1  0.1 -0.3  0.0
## d1  0.0  0.0  0.0  0.1  0.1  0.1  0.0 -0.3</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="congruence-between-independent-and-dependent-sses.html#cb179-1" tabindex="-1"></a><span class="co">#print(La8)</span></span>
<span id="cb179-2"><a href="congruence-between-independent-and-dependent-sses.html#cb179-2" tabindex="-1"></a><span class="fu">print</span>(Q_cor8_C.t)</span></code></pre></div>
<pre><code>##      a0   b0   c0   d0   a1   b1   c1   d1
## a0 -0.3  0.1  0.1  0.0  0.0  0.1  0.0  0.0
## b0  0.1 -0.3  0.0  0.1  0.1  0.0  0.0  0.0
## c0  0.1  0.0 -0.3  0.1  0.0  0.0  0.0  0.1
## d0  0.0  0.1  0.1 -0.3  0.0  0.0  0.1  0.0
## a1  0.0  0.1  0.0  0.0 -0.3  0.1  0.1  0.0
## b1  0.1  0.0  0.0  0.0  0.1 -0.3  0.0  0.1
## c1  0.0  0.0  0.0  0.1  0.1  0.0 -0.3  0.1
## d1  0.0  0.0  0.1  0.0  0.0  0.1  0.1 -0.3</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="congruence-between-independent-and-dependent-sses.html#cb181-1" tabindex="-1"></a><span class="co">#print(La8[v,v])</span></span></code></pre></div>
</div>
<div id="cor8-nc-non-correlated-evolution-congruent-to-cid4" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> COR8-NC (Non-correlated evolution, congruent to CID4)<a href="congruence-between-independent-and-dependent-sses.html#cor8-nc-non-correlated-evolution-congruent-to-cid4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="congruence-between-independent-and-dependent-sses.html#cb182-1" tabindex="-1"></a><span class="co"># like CID8 but not congruent</span></span>
<span id="cb182-2"><a href="congruence-between-independent-and-dependent-sses.html#cb182-2" tabindex="-1"></a>Q_cor8_NC.t <span class="ot">&lt;-</span> Q_cid8.t</span>
<span id="cb182-3"><a href="congruence-between-independent-and-dependent-sses.html#cb182-3" tabindex="-1"></a></span>
<span id="cb182-4"><a href="congruence-between-independent-and-dependent-sses.html#cb182-4" tabindex="-1"></a>bl <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb182-5"><a href="congruence-between-independent-and-dependent-sses.html#cb182-5" tabindex="-1"></a>Q_cor8_NC.t[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> bl</span>
<span id="cb182-6"><a href="congruence-between-independent-and-dependent-sses.html#cb182-6" tabindex="-1"></a>Q_cor8_NC.t[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> bl</span>
<span id="cb182-7"><a href="congruence-between-independent-and-dependent-sses.html#cb182-7" tabindex="-1"></a>Q_cor8_NC.t[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="ot">&lt;-</span> bl</span>
<span id="cb182-8"><a href="congruence-between-independent-and-dependent-sses.html#cb182-8" tabindex="-1"></a>Q_cor8_NC.t[<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> bl</span>
<span id="cb182-9"><a href="congruence-between-independent-and-dependent-sses.html#cb182-9" tabindex="-1"></a></span>
<span id="cb182-10"><a href="congruence-between-independent-and-dependent-sses.html#cb182-10" tabindex="-1"></a>v<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>, <span class="dv">2</span>,<span class="dv">6</span>, <span class="dv">3</span>,<span class="dv">7</span>, <span class="dv">4</span>,<span class="dv">8</span>)</span>
<span id="cb182-11"><a href="congruence-between-independent-and-dependent-sses.html#cb182-11" tabindex="-1"></a>Q_cor8_NC.r <span class="ot">&lt;-</span> Q_cor8_NC.t[v,v]</span>
<span id="cb182-12"><a href="congruence-between-independent-and-dependent-sses.html#cb182-12" tabindex="-1"></a></span>
<span id="cb182-13"><a href="congruence-between-independent-and-dependent-sses.html#cb182-13" tabindex="-1"></a><span class="fu">print</span>(Q_cor8_NC.r)</span></code></pre></div>
<pre><code>##      a0   a1   b0   b1   c0   c1   d0   d1
## a0 -0.3  0.0  0.1  0.1  0.1  0.0  0.0  0.0
## a1  0.0 -0.3  0.1  0.1  0.0  0.1  0.0  0.0
## b0  0.1  0.0 -0.3  0.0  0.0  0.0  0.1  0.0
## b1  0.0  0.1  0.0 -0.3  0.0  0.0  0.0  0.1
## c0  0.1  0.0  0.0  0.0 -0.3  0.0  0.1  0.1
## c1  0.0  0.1  0.0  0.0  0.0 -0.3  0.1  0.1
## d0  0.0  0.0  0.1  0.0  0.1  0.0 -0.3  0.0
## d1  0.0  0.0  0.0  0.1  0.0  0.1  0.0 -0.3</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="congruence-between-independent-and-dependent-sses.html#cb184-1" tabindex="-1"></a><span class="co">#print(La8)</span></span>
<span id="cb184-2"><a href="congruence-between-independent-and-dependent-sses.html#cb184-2" tabindex="-1"></a><span class="fu">print</span>(Q_cor8_NC.t)</span></code></pre></div>
<pre><code>##      a0   b0   c0   d0   a1   b1   c1   d1
## a0 -0.3  0.1  0.1  0.0  0.0  0.1  0.0  0.0
## b0  0.1 -0.3  0.0  0.1  0.0  0.0  0.0  0.0
## c0  0.1  0.0 -0.3  0.1  0.0  0.0  0.0  0.1
## d0  0.0  0.1  0.1 -0.3  0.0  0.0  0.0  0.0
## a1  0.0  0.1  0.0  0.0 -0.3  0.1  0.1  0.0
## b1  0.0  0.0  0.0  0.0  0.1 -0.3  0.0  0.1
## c1  0.0  0.0  0.0  0.1  0.1  0.0 -0.3  0.1
## d1  0.0  0.0  0.0  0.0  0.0  0.1  0.1 -0.3</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="congruence-between-independent-and-dependent-sses.html#cb186-1" tabindex="-1"></a><span class="co">#print(La8[v,v])</span></span></code></pre></div>
</div>
</div>
<div id="irreducible-model" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Irreducible model<a href="congruence-between-independent-and-dependent-sses.html#irreducible-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="cid4-4-pars" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> CID4 (4 pars)<a href="congruence-between-independent-and-dependent-sses.html#cid4-4-pars" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="congruence-between-independent-and-dependent-sses.html#cb187-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb187-2"><a href="congruence-between-independent-and-dependent-sses.html#cb187-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 4L,</span>
<span id="cb187-3"><a href="congruence-between-independent-and-dependent-sses.html#cb187-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">list</span>(</span>
<span id="cb187-4"><a href="congruence-between-independent-and-dependent-sses.html#cb187-4" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb187-5"><a href="congruence-between-independent-and-dependent-sses.html#cb187-5" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb187-6"><a href="congruence-between-independent-and-dependent-sses.html#cb187-6" tabindex="-1"></a>  ))</span>
<span id="cb187-7"><a href="congruence-between-independent-and-dependent-sses.html#cb187-7" tabindex="-1"></a></span>
<span id="cb187-8"><a href="congruence-between-independent-and-dependent-sses.html#cb187-8" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb187-9"><a href="congruence-between-independent-and-dependent-sses.html#cb187-9" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb187-10"><a href="congruence-between-independent-and-dependent-sses.html#cb187-10" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">4</span>)</span>
<span id="cb187-11"><a href="congruence-between-independent-and-dependent-sses.html#cb187-11" tabindex="-1"></a><span class="co">#args$arrays</span></span>
<span id="cb187-12"><a href="congruence-between-independent-and-dependent-sses.html#cb187-12" tabindex="-1"></a><span class="co">#args$pars</span></span>
<span id="cb187-13"><a href="congruence-between-independent-and-dependent-sses.html#cb187-13" tabindex="-1"></a><span class="co">#length(args$pars)</span></span>
<span id="cb187-14"><a href="congruence-between-independent-and-dependent-sses.html#cb187-14" tabindex="-1"></a><span class="fu">reoder_lambdas</span>(args<span class="sc">$</span>arrays, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>, <span class="dv">2</span>,<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## $lam.tensor
## $lam.tensor[[1]]
##      [,1]     [,2]     [,3]     [,4]    
## [1,] &quot;lam000&quot; &quot;lam002&quot; &quot;lam001&quot; &quot;lam003&quot;
## [2,] &quot;0&quot;      &quot;lam022&quot; &quot;0&quot;      &quot;lam023&quot;
## [3,] &quot;0&quot;      &quot;lam012&quot; &quot;lam011&quot; &quot;lam013&quot;
## [4,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam033&quot;
## 
## $lam.tensor[[2]]
##      [,1]     [,2]     [,3]     [,4]    
## [1,] &quot;lam200&quot; &quot;lam202&quot; &quot;lam201&quot; &quot;lam203&quot;
## [2,] &quot;0&quot;      &quot;lam222&quot; &quot;0&quot;      &quot;lam223&quot;
## [3,] &quot;0&quot;      &quot;lam212&quot; &quot;lam211&quot; &quot;lam213&quot;
## [4,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam233&quot;
## 
## $lam.tensor[[3]]
##      [,1]     [,2]     [,3]     [,4]    
## [1,] &quot;lam100&quot; &quot;lam102&quot; &quot;lam101&quot; &quot;lam103&quot;
## [2,] &quot;0&quot;      &quot;lam122&quot; &quot;0&quot;      &quot;lam123&quot;
## [3,] &quot;0&quot;      &quot;lam112&quot; &quot;lam111&quot; &quot;lam113&quot;
## [4,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam133&quot;
## 
## $lam.tensor[[4]]
##      [,1]     [,2]     [,3]     [,4]    
## [1,] &quot;lam300&quot; &quot;lam302&quot; &quot;lam301&quot; &quot;lam303&quot;
## [2,] &quot;0&quot;      &quot;lam322&quot; &quot;0&quot;      &quot;lam323&quot;
## [3,] &quot;0&quot;      &quot;lam312&quot; &quot;lam311&quot; &quot;lam313&quot;
## [4,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam333&quot;
## 
## 
## $mu
## [1] &quot;mu0&quot; &quot;mu2&quot; &quot;mu1&quot; &quot;mu3&quot;
## 
## $Q
##      [,1]  [,2]  [,3]  [,4] 
## [1,] &quot;0&quot;   &quot;q02&quot; &quot;q01&quot; &quot;q03&quot;
## [2,] &quot;q20&quot; &quot;0&quot;   &quot;q21&quot; &quot;q23&quot;
## [3,] &quot;q10&quot; &quot;q12&quot; &quot;0&quot;   &quot;q13&quot;
## [4,] &quot;q30&quot; &quot;q32&quot; &quot;q31&quot; &quot;0&quot;</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="congruence-between-independent-and-dependent-sses.html#cb189-1" tabindex="-1"></a>pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb189-2"><a href="congruence-between-independent-and-dependent-sses.html#cb189-2" tabindex="-1"></a><span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb189-3"><a href="congruence-between-independent-and-dependent-sses.html#cb189-3" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam000&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb189-4"><a href="congruence-between-independent-and-dependent-sses.html#cb189-4" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam111&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb189-5"><a href="congruence-between-independent-and-dependent-sses.html#cb189-5" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam222&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb189-6"><a href="congruence-between-independent-and-dependent-sses.html#cb189-6" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam333&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb189-7"><a href="congruence-between-independent-and-dependent-sses.html#cb189-7" tabindex="-1"></a>pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb189-8"><a href="congruence-between-independent-and-dependent-sses.html#cb189-8" tabindex="-1"></a>qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cid4.r)</span>
<span id="cb189-9"><a href="congruence-between-independent-and-dependent-sses.html#cb189-9" tabindex="-1"></a>qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb189-10"><a href="congruence-between-independent-and-dependent-sses.html#cb189-10" tabindex="-1"></a>pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb189-11"><a href="congruence-between-independent-and-dependent-sses.html#cb189-11" tabindex="-1"></a></span>
<span id="cb189-12"><a href="congruence-between-independent-and-dependent-sses.html#cb189-12" tabindex="-1"></a><span class="co">#pars.hc</span></span>
<span id="cb189-13"><a href="congruence-between-independent-and-dependent-sses.html#cb189-13" tabindex="-1"></a><span class="co">#pars_to_arrays(pars.hc,4)</span></span>
<span id="cb189-14"><a href="congruence-between-independent-and-dependent-sses.html#cb189-14" tabindex="-1"></a><span class="co">#args</span></span>
<span id="cb189-15"><a href="congruence-between-independent-and-dependent-sses.html#cb189-15" tabindex="-1"></a></span>
<span id="cb189-16"><a href="congruence-between-independent-and-dependent-sses.html#cb189-16" tabindex="-1"></a>zero.constr <span class="ot">&lt;-</span> <span class="fu">formulas_zero_pars</span>(pars.hc)</span>
<span id="cb189-17"><a href="congruence-between-independent-and-dependent-sses.html#cb189-17" tabindex="-1"></a>f.qs <span class="ot">&lt;-</span> <span class="fu">assign_classes_pairwise</span>(Q_cid4.r, args<span class="sc">$</span>arrays<span class="sc">$</span>Q)</span>
<span id="cb189-18"><a href="congruence-between-independent-and-dependent-sses.html#cb189-18" tabindex="-1"></a>f.mu <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1 <span class="sc">~</span> mu0, mu2 <span class="sc">~</span> mu0, mu3 <span class="sc">~</span> mu0)</span>
<span id="cb189-19"><a href="congruence-between-independent-and-dependent-sses.html#cb189-19" tabindex="-1"></a>f.lams <span class="ot">&lt;-</span> <span class="fu">c</span>(lam111 <span class="sc">~</span> lam000, lam333 <span class="sc">~</span> lam222)</span>
<span id="cb189-20"><a href="congruence-between-independent-and-dependent-sses.html#cb189-20" tabindex="-1"></a>f.list<span class="ot">&lt;-</span> <span class="fu">c</span>(zero.constr,  f.qs, f.mu, f.lams)</span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="congruence-between-independent-and-dependent-sses.html#cb190-1" tabindex="-1"></a>CID4 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb190-2"><a href="congruence-between-independent-and-dependent-sses.html#cb190-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb190-3"><a href="congruence-between-independent-and-dependent-sses.html#cb190-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSIM){</span>
<span id="cb190-4"><a href="congruence-between-independent-and-dependent-sses.html#cb190-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb190-5"><a href="congruence-between-independent-and-dependent-sses.html#cb190-5" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb190-6"><a href="congruence-between-independent-and-dependent-sses.html#cb190-6" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb190-7"><a href="congruence-between-independent-and-dependent-sses.html#cb190-7" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb190-8"><a href="congruence-between-independent-and-dependent-sses.html#cb190-8" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb190-9"><a href="congruence-between-independent-and-dependent-sses.html#cb190-9" tabindex="-1"></a>  </span>
<span id="cb190-10"><a href="congruence-between-independent-and-dependent-sses.html#cb190-10" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,  <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb190-11"><a href="congruence-between-independent-and-dependent-sses.html#cb190-11" tabindex="-1"></a>  lik.const <span class="ot">&lt;-</span> <span class="fu">constrain</span>(lik.c, <span class="at">formulae =</span> f.list)</span>
<span id="cb190-12"><a href="congruence-between-independent-and-dependent-sses.html#cb190-12" tabindex="-1"></a>  arg.const <span class="ot">&lt;-</span> <span class="fu">argnames</span>(lik.const)</span>
<span id="cb190-13"><a href="congruence-between-independent-and-dependent-sses.html#cb190-13" tabindex="-1"></a>  starting.point <span class="ot">&lt;-</span> pars.hc[arg.const]</span>
<span id="cb190-14"><a href="congruence-between-independent-and-dependent-sses.html#cb190-14" tabindex="-1"></a>  CID4[[i]] <span class="ot">&lt;-</span> <span class="fu">find.mle</span>(lik.const, starting.point, <span class="at">method=</span><span class="st">&quot;subplex&quot;</span>, <span class="at">keep.func=</span>F, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span><span class="cn">TRUE</span>)</span>
<span id="cb190-15"><a href="congruence-between-independent-and-dependent-sses.html#cb190-15" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 00001010&quot;
## [1] &quot;Recoding: 0001 -&gt; 00000101&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 00001010&quot;
## [1] &quot;Recoding: 0001 -&gt; 00000101&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 00001010&quot;
## [1] &quot;Recoding: 0001 -&gt; 00000101&quot;
## [1] &quot;Working on: 4&quot;
## [1] &quot;Recoding: 0010 -&gt; 00001010&quot;
## [1] &quot;Recoding: 0001 -&gt; 00000101&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 00001010&quot;
## [1] &quot;Recoding: 0001 -&gt; 00000101&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 00001010&quot;
## [1] &quot;Recoding: 0001 -&gt; 00000101&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 00001010&quot;
## [1] &quot;Recoding: 0001 -&gt; 00000101&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 00001010&quot;
## [1] &quot;Recoding: 0001 -&gt; 00000101&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 00001010&quot;
## [1] &quot;Recoding: 0001 -&gt; 00000101&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 00001010&quot;
## [1] &quot;Recoding: 0001 -&gt; 00000101&quot;</code></pre>
<p>Some helper functions to assess the inference parameters.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="congruence-between-independent-and-dependent-sses.html#cb192-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="congruence-between-independent-and-dependent-sses.html#cb194-1" tabindex="-1"></a><span class="fu">pars_to_arrays</span>(CID4[[<span class="dv">1</span>]]<span class="sc">$</span>par.full, <span class="dv">4</span>) <span class="sc">%&gt;%</span> <span class="fu">reoder_lambdas</span>(., <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>, <span class="dv">2</span>,<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## $lam.tensor
## $lam.tensor$`1`
##            [,1] [,2] [,3] [,4]
## [1,] 0.05094386    0    0    0
## [2,] 0.00000000    0    0    0
## [3,] 0.00000000    0    0    0
## [4,] 0.00000000    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4]
## [1,]    0 0.00000000    0    0
## [2,]    0 0.05091551    0    0
## [3,]    0 0.00000000    0    0
## [4,]    0 0.00000000    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2]       [,3] [,4]
## [1,]    0    0 0.00000000    0
## [2,]    0    0 0.00000000    0
## [3,]    0    0 0.05094386    0
## [4,]    0    0 0.00000000    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3]       [,4]
## [1,]    0    0    0 0.00000000
## [2,]    0    0    0 0.00000000
## [3,]    0    0    0 0.00000000
## [4,]    0    0    0 0.05091551
## 
## 
## $mu
##          mu0          mu2          mu1          mu3 
## 0.0003102256 0.0003102256 0.0003102256 0.0003102256 
## 
## $Q
##              [,1]         [,2]         [,3]         [,4]
## [1,] -0.015124151  0.007562076  0.007562076  0.000000000
## [2,]  0.007562076 -0.015124151  0.000000000  0.007562076
## [3,]  0.007562076  0.000000000 -0.015124151  0.007562076
## [4,]  0.000000000  0.007562076  0.007562076 -0.015124151</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="congruence-between-independent-and-dependent-sses.html#cb196-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4[<span class="dv">1</span>], <span class="st">&#39;par&#39;</span>)</span></code></pre></div>
<pre><code>##       lam000       lam222          mu0          q01 
## 0.0509438630 0.0509155136 0.0003102256 0.0075620757</code></pre>
</div>
</div>
<div id="inferences-using-parameters-from-cid4" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Inferences using parameters from CID4<a href="congruence-between-independent-and-dependent-sses.html#inferences-using-parameters-from-cid4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="cid8-4-pars" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> CID8 (4 pars)<a href="congruence-between-independent-and-dependent-sses.html#cid8-4-pars" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="congruence-between-independent-and-dependent-sses.html#cb198-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb198-2"><a href="congruence-between-independent-and-dependent-sses.html#cb198-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 8L,</span>
<span id="cb198-3"><a href="congruence-between-independent-and-dependent-sses.html#cb198-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">list</span>(</span>
<span id="cb198-4"><a href="congruence-between-independent-and-dependent-sses.html#cb198-4" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb198-5"><a href="congruence-between-independent-and-dependent-sses.html#cb198-5" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb198-6"><a href="congruence-between-independent-and-dependent-sses.html#cb198-6" tabindex="-1"></a>  ))</span>
<span id="cb198-7"><a href="congruence-between-independent-and-dependent-sses.html#cb198-7" tabindex="-1"></a></span>
<span id="cb198-8"><a href="congruence-between-independent-and-dependent-sses.html#cb198-8" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb198-9"><a href="congruence-between-independent-and-dependent-sses.html#cb198-9" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb198-10"><a href="congruence-between-independent-and-dependent-sses.html#cb198-10" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">8</span>)</span>
<span id="cb198-11"><a href="congruence-between-independent-and-dependent-sses.html#cb198-11" tabindex="-1"></a>args<span class="sc">$</span>arrays</span></code></pre></div>
<pre><code>## $lam.tensor
## $lam.tensor[[1]]
##      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
## [1,] &quot;lam000&quot; &quot;lam001&quot; &quot;lam002&quot; &quot;lam003&quot; &quot;lam004&quot; &quot;lam005&quot; &quot;lam006&quot; &quot;lam007&quot;
## [2,] &quot;0&quot;      &quot;lam011&quot; &quot;lam012&quot; &quot;lam013&quot; &quot;lam014&quot; &quot;lam015&quot; &quot;lam016&quot; &quot;lam017&quot;
## [3,] &quot;0&quot;      &quot;0&quot;      &quot;lam022&quot; &quot;lam023&quot; &quot;lam024&quot; &quot;lam025&quot; &quot;lam026&quot; &quot;lam027&quot;
## [4,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam033&quot; &quot;lam034&quot; &quot;lam035&quot; &quot;lam036&quot; &quot;lam037&quot;
## [5,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam044&quot; &quot;lam045&quot; &quot;lam046&quot; &quot;lam047&quot;
## [6,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam055&quot; &quot;lam056&quot; &quot;lam057&quot;
## [7,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam066&quot; &quot;lam067&quot;
## [8,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam077&quot;
## 
## $lam.tensor[[2]]
##      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
## [1,] &quot;lam100&quot; &quot;lam101&quot; &quot;lam102&quot; &quot;lam103&quot; &quot;lam104&quot; &quot;lam105&quot; &quot;lam106&quot; &quot;lam107&quot;
## [2,] &quot;0&quot;      &quot;lam111&quot; &quot;lam112&quot; &quot;lam113&quot; &quot;lam114&quot; &quot;lam115&quot; &quot;lam116&quot; &quot;lam117&quot;
## [3,] &quot;0&quot;      &quot;0&quot;      &quot;lam122&quot; &quot;lam123&quot; &quot;lam124&quot; &quot;lam125&quot; &quot;lam126&quot; &quot;lam127&quot;
## [4,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam133&quot; &quot;lam134&quot; &quot;lam135&quot; &quot;lam136&quot; &quot;lam137&quot;
## [5,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam144&quot; &quot;lam145&quot; &quot;lam146&quot; &quot;lam147&quot;
## [6,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam155&quot; &quot;lam156&quot; &quot;lam157&quot;
## [7,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam166&quot; &quot;lam167&quot;
## [8,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam177&quot;
## 
## $lam.tensor[[3]]
##      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
## [1,] &quot;lam200&quot; &quot;lam201&quot; &quot;lam202&quot; &quot;lam203&quot; &quot;lam204&quot; &quot;lam205&quot; &quot;lam206&quot; &quot;lam207&quot;
## [2,] &quot;0&quot;      &quot;lam211&quot; &quot;lam212&quot; &quot;lam213&quot; &quot;lam214&quot; &quot;lam215&quot; &quot;lam216&quot; &quot;lam217&quot;
## [3,] &quot;0&quot;      &quot;0&quot;      &quot;lam222&quot; &quot;lam223&quot; &quot;lam224&quot; &quot;lam225&quot; &quot;lam226&quot; &quot;lam227&quot;
## [4,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam233&quot; &quot;lam234&quot; &quot;lam235&quot; &quot;lam236&quot; &quot;lam237&quot;
## [5,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam244&quot; &quot;lam245&quot; &quot;lam246&quot; &quot;lam247&quot;
## [6,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam255&quot; &quot;lam256&quot; &quot;lam257&quot;
## [7,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam266&quot; &quot;lam267&quot;
## [8,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam277&quot;
## 
## $lam.tensor[[4]]
##      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
## [1,] &quot;lam300&quot; &quot;lam301&quot; &quot;lam302&quot; &quot;lam303&quot; &quot;lam304&quot; &quot;lam305&quot; &quot;lam306&quot; &quot;lam307&quot;
## [2,] &quot;0&quot;      &quot;lam311&quot; &quot;lam312&quot; &quot;lam313&quot; &quot;lam314&quot; &quot;lam315&quot; &quot;lam316&quot; &quot;lam317&quot;
## [3,] &quot;0&quot;      &quot;0&quot;      &quot;lam322&quot; &quot;lam323&quot; &quot;lam324&quot; &quot;lam325&quot; &quot;lam326&quot; &quot;lam327&quot;
## [4,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam333&quot; &quot;lam334&quot; &quot;lam335&quot; &quot;lam336&quot; &quot;lam337&quot;
## [5,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam344&quot; &quot;lam345&quot; &quot;lam346&quot; &quot;lam347&quot;
## [6,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam355&quot; &quot;lam356&quot; &quot;lam357&quot;
## [7,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam366&quot; &quot;lam367&quot;
## [8,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam377&quot;
## 
## $lam.tensor[[5]]
##      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
## [1,] &quot;lam400&quot; &quot;lam401&quot; &quot;lam402&quot; &quot;lam403&quot; &quot;lam404&quot; &quot;lam405&quot; &quot;lam406&quot; &quot;lam407&quot;
## [2,] &quot;0&quot;      &quot;lam411&quot; &quot;lam412&quot; &quot;lam413&quot; &quot;lam414&quot; &quot;lam415&quot; &quot;lam416&quot; &quot;lam417&quot;
## [3,] &quot;0&quot;      &quot;0&quot;      &quot;lam422&quot; &quot;lam423&quot; &quot;lam424&quot; &quot;lam425&quot; &quot;lam426&quot; &quot;lam427&quot;
## [4,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam433&quot; &quot;lam434&quot; &quot;lam435&quot; &quot;lam436&quot; &quot;lam437&quot;
## [5,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam444&quot; &quot;lam445&quot; &quot;lam446&quot; &quot;lam447&quot;
## [6,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam455&quot; &quot;lam456&quot; &quot;lam457&quot;
## [7,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam466&quot; &quot;lam467&quot;
## [8,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam477&quot;
## 
## $lam.tensor[[6]]
##      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
## [1,] &quot;lam500&quot; &quot;lam501&quot; &quot;lam502&quot; &quot;lam503&quot; &quot;lam504&quot; &quot;lam505&quot; &quot;lam506&quot; &quot;lam507&quot;
## [2,] &quot;0&quot;      &quot;lam511&quot; &quot;lam512&quot; &quot;lam513&quot; &quot;lam514&quot; &quot;lam515&quot; &quot;lam516&quot; &quot;lam517&quot;
## [3,] &quot;0&quot;      &quot;0&quot;      &quot;lam522&quot; &quot;lam523&quot; &quot;lam524&quot; &quot;lam525&quot; &quot;lam526&quot; &quot;lam527&quot;
## [4,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam533&quot; &quot;lam534&quot; &quot;lam535&quot; &quot;lam536&quot; &quot;lam537&quot;
## [5,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam544&quot; &quot;lam545&quot; &quot;lam546&quot; &quot;lam547&quot;
## [6,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam555&quot; &quot;lam556&quot; &quot;lam557&quot;
## [7,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam566&quot; &quot;lam567&quot;
## [8,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam577&quot;
## 
## $lam.tensor[[7]]
##      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
## [1,] &quot;lam600&quot; &quot;lam601&quot; &quot;lam602&quot; &quot;lam603&quot; &quot;lam604&quot; &quot;lam605&quot; &quot;lam606&quot; &quot;lam607&quot;
## [2,] &quot;0&quot;      &quot;lam611&quot; &quot;lam612&quot; &quot;lam613&quot; &quot;lam614&quot; &quot;lam615&quot; &quot;lam616&quot; &quot;lam617&quot;
## [3,] &quot;0&quot;      &quot;0&quot;      &quot;lam622&quot; &quot;lam623&quot; &quot;lam624&quot; &quot;lam625&quot; &quot;lam626&quot; &quot;lam627&quot;
## [4,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam633&quot; &quot;lam634&quot; &quot;lam635&quot; &quot;lam636&quot; &quot;lam637&quot;
## [5,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam644&quot; &quot;lam645&quot; &quot;lam646&quot; &quot;lam647&quot;
## [6,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam655&quot; &quot;lam656&quot; &quot;lam657&quot;
## [7,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam666&quot; &quot;lam667&quot;
## [8,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam677&quot;
## 
## $lam.tensor[[8]]
##      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
## [1,] &quot;lam700&quot; &quot;lam701&quot; &quot;lam702&quot; &quot;lam703&quot; &quot;lam704&quot; &quot;lam705&quot; &quot;lam706&quot; &quot;lam707&quot;
## [2,] &quot;0&quot;      &quot;lam711&quot; &quot;lam712&quot; &quot;lam713&quot; &quot;lam714&quot; &quot;lam715&quot; &quot;lam716&quot; &quot;lam717&quot;
## [3,] &quot;0&quot;      &quot;0&quot;      &quot;lam722&quot; &quot;lam723&quot; &quot;lam724&quot; &quot;lam725&quot; &quot;lam726&quot; &quot;lam727&quot;
## [4,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam733&quot; &quot;lam734&quot; &quot;lam735&quot; &quot;lam736&quot; &quot;lam737&quot;
## [5,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam744&quot; &quot;lam745&quot; &quot;lam746&quot; &quot;lam747&quot;
## [6,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam755&quot; &quot;lam756&quot; &quot;lam757&quot;
## [7,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam766&quot; &quot;lam767&quot;
## [8,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam777&quot;
## 
## 
## $mu
## [1] &quot;mu0&quot; &quot;mu1&quot; &quot;mu2&quot; &quot;mu3&quot; &quot;mu4&quot; &quot;mu5&quot; &quot;mu6&quot; &quot;mu7&quot;
## 
## $Q
##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8] 
## [1,] &quot;0&quot;   &quot;q01&quot; &quot;q02&quot; &quot;q03&quot; &quot;q04&quot; &quot;q05&quot; &quot;q06&quot; &quot;q07&quot;
## [2,] &quot;q10&quot; &quot;0&quot;   &quot;q12&quot; &quot;q13&quot; &quot;q14&quot; &quot;q15&quot; &quot;q16&quot; &quot;q17&quot;
## [3,] &quot;q20&quot; &quot;q21&quot; &quot;0&quot;   &quot;q23&quot; &quot;q24&quot; &quot;q25&quot; &quot;q26&quot; &quot;q27&quot;
## [4,] &quot;q30&quot; &quot;q31&quot; &quot;q32&quot; &quot;0&quot;   &quot;q34&quot; &quot;q35&quot; &quot;q36&quot; &quot;q37&quot;
## [5,] &quot;q40&quot; &quot;q41&quot; &quot;q42&quot; &quot;q43&quot; &quot;0&quot;   &quot;q45&quot; &quot;q46&quot; &quot;q47&quot;
## [6,] &quot;q50&quot; &quot;q51&quot; &quot;q52&quot; &quot;q53&quot; &quot;q54&quot; &quot;0&quot;   &quot;q56&quot; &quot;q57&quot;
## [7,] &quot;q60&quot; &quot;q61&quot; &quot;q62&quot; &quot;q63&quot; &quot;q64&quot; &quot;q65&quot; &quot;0&quot;   &quot;q67&quot;
## [8,] &quot;q70&quot; &quot;q71&quot; &quot;q72&quot; &quot;q73&quot; &quot;q74&quot; &quot;q75&quot; &quot;q76&quot; &quot;0&quot;</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="congruence-between-independent-and-dependent-sses.html#cb200-1" tabindex="-1"></a><span class="co">#reoder_lambdas(args$arrays, c(1,3,5,7, 2,4,6,8))</span></span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="congruence-between-independent-and-dependent-sses.html#cb201-1" tabindex="-1"></a>CID8.pars <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb201-2"><a href="congruence-between-independent-and-dependent-sses.html#cb201-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb201-3"><a href="congruence-between-independent-and-dependent-sses.html#cb201-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSIM){</span>
<span id="cb201-4"><a href="congruence-between-independent-and-dependent-sses.html#cb201-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb201-5"><a href="congruence-between-independent-and-dependent-sses.html#cb201-5" tabindex="-1"></a>  <span class="co">#-----------</span></span>
<span id="cb201-6"><a href="congruence-between-independent-and-dependent-sses.html#cb201-6" tabindex="-1"></a>  est <span class="ot">&lt;-</span> <span class="fu">get_item</span>(CID4[i], <span class="st">&#39;par&#39;</span>)</span>
<span id="cb201-7"><a href="congruence-between-independent-and-dependent-sses.html#cb201-7" tabindex="-1"></a>  pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb201-8"><a href="congruence-between-independent-and-dependent-sses.html#cb201-8" tabindex="-1"></a>  <span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb201-9"><a href="congruence-between-independent-and-dependent-sses.html#cb201-9" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam000&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb201-10"><a href="congruence-between-independent-and-dependent-sses.html#cb201-10" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam111&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb201-11"><a href="congruence-between-independent-and-dependent-sses.html#cb201-11" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam222&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb201-12"><a href="congruence-between-independent-and-dependent-sses.html#cb201-12" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam333&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb201-13"><a href="congruence-between-independent-and-dependent-sses.html#cb201-13" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam444&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb201-14"><a href="congruence-between-independent-and-dependent-sses.html#cb201-14" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam555&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb201-15"><a href="congruence-between-independent-and-dependent-sses.html#cb201-15" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam666&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb201-16"><a href="congruence-between-independent-and-dependent-sses.html#cb201-16" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam777&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb201-17"><a href="congruence-between-independent-and-dependent-sses.html#cb201-17" tabindex="-1"></a>  pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu4&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu5&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu6&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu7&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;mu0&#39;</span>]</span>
<span id="cb201-18"><a href="congruence-between-independent-and-dependent-sses.html#cb201-18" tabindex="-1"></a>  qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cid8.r)</span>
<span id="cb201-19"><a href="congruence-between-independent-and-dependent-sses.html#cb201-19" tabindex="-1"></a>  qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb201-20"><a href="congruence-between-independent-and-dependent-sses.html#cb201-20" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.1</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q01&#39;</span>]</span>
<span id="cb201-21"><a href="congruence-between-independent-and-dependent-sses.html#cb201-21" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.01</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q02&#39;</span>]<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb201-22"><a href="congruence-between-independent-and-dependent-sses.html#cb201-22" tabindex="-1"></a>  pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb201-23"><a href="congruence-between-independent-and-dependent-sses.html#cb201-23" tabindex="-1"></a>  </span>
<span id="cb201-24"><a href="congruence-between-independent-and-dependent-sses.html#cb201-24" tabindex="-1"></a>  <span class="co">#pars.hc</span></span>
<span id="cb201-25"><a href="congruence-between-independent-and-dependent-sses.html#cb201-25" tabindex="-1"></a>  <span class="co">#pars_to_arrays(pars.hc, 8)</span></span>
<span id="cb201-26"><a href="congruence-between-independent-and-dependent-sses.html#cb201-26" tabindex="-1"></a>  <span class="co">#------</span></span>
<span id="cb201-27"><a href="congruence-between-independent-and-dependent-sses.html#cb201-27" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb201-28"><a href="congruence-between-independent-and-dependent-sses.html#cb201-28" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb201-29"><a href="congruence-between-independent-and-dependent-sses.html#cb201-29" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb201-30"><a href="congruence-between-independent-and-dependent-sses.html#cb201-30" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb201-31"><a href="congruence-between-independent-and-dependent-sses.html#cb201-31" tabindex="-1"></a>  </span>
<span id="cb201-32"><a href="congruence-between-independent-and-dependent-sses.html#cb201-32" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,  <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb201-33"><a href="congruence-between-independent-and-dependent-sses.html#cb201-33" tabindex="-1"></a>  CID8.pars[[i]] <span class="ot">&lt;-</span> <span class="fu">lik.c</span>(pars.hc, <span class="at">intermediates=</span>F, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span>T)</span>
<span id="cb201-34"><a href="congruence-between-independent-and-dependent-sses.html#cb201-34" tabindex="-1"></a>  </span>
<span id="cb201-35"><a href="congruence-between-independent-and-dependent-sses.html#cb201-35" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 4&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;</code></pre>
<p>Compare Ln</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="congruence-between-independent-and-dependent-sses.html#cb203-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="congruence-between-independent-and-dependent-sses.html#cb205-1" tabindex="-1"></a>CID8.pars <span class="sc">%&gt;%</span> unlist</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="congruence-between-independent-and-dependent-sses.html#cb207-1" tabindex="-1"></a><span class="fu">pars_to_arrays</span>(pars.hc, <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">reoder_lambdas</span>(., <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>, <span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>))</span></code></pre></div>
<pre><code>## $lam.tensor
## $lam.tensor$`1`
##            [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,] 0.05942176    0    0    0    0    0    0    0
## [2,] 0.00000000    0    0    0    0    0    0    0
## [3,] 0.00000000    0    0    0    0    0    0    0
## [4,] 0.00000000    0    0    0    0    0    0    0
## [5,] 0.00000000    0    0    0    0    0    0    0
## [6,] 0.00000000    0    0    0    0    0    0    0
## [7,] 0.00000000    0    0    0    0    0    0    0
## [8,] 0.00000000    0    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.05942176    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2]       [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0 0.00000000    0    0    0    0    0
## [2,]    0    0 0.00000000    0    0    0    0    0
## [3,]    0    0 0.08723677    0    0    0    0    0
## [4,]    0    0 0.00000000    0    0    0    0    0
## [5,]    0    0 0.00000000    0    0    0    0    0
## [6,]    0    0 0.00000000    0    0    0    0    0
## [7,]    0    0 0.00000000    0    0    0    0    0
## [8,]    0    0 0.00000000    0    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.08723677    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05942176    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.05942176    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6]       [,7] [,8]
## [1,]    0    0    0    0    0    0 0.00000000    0
## [2,]    0    0    0    0    0    0 0.00000000    0
## [3,]    0    0    0    0    0    0 0.00000000    0
## [4,]    0    0    0    0    0    0 0.00000000    0
## [5,]    0    0    0    0    0    0 0.00000000    0
## [6,]    0    0    0    0    0    0 0.00000000    0
## [7,]    0    0    0    0    0    0 0.08723677    0
## [8,]    0    0    0    0    0    0 0.00000000    0
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.08723677
## 
## 
## $mu
##         mu0         mu2         mu4         mu6         mu1         mu3         mu5         mu7 
## 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 
## 
## $Q
##             [,1]        [,2]        [,3]        [,4]        [,5]        [,6]        [,7]        [,8]
## [1,] -0.03790101  0.01263367  0.01263367  0.00000000  0.01263367  0.00000000  0.00000000  0.00000000
## [2,]  0.01263367 -0.03790101  0.00000000  0.01263367  0.00000000  0.01263367  0.00000000  0.00000000
## [3,]  0.01263367  0.00000000 -0.03790101  0.01263367  0.00000000  0.00000000  0.01263367  0.00000000
## [4,]  0.00000000  0.01263367  0.01263367 -0.03790101  0.00000000  0.00000000  0.00000000  0.01263367
## [5,]  0.01263367  0.00000000  0.00000000  0.00000000 -0.03790101  0.01263367  0.01263367  0.00000000
## [6,]  0.00000000  0.01263367  0.00000000  0.00000000  0.01263367 -0.03790101  0.00000000  0.01263367
## [7,]  0.00000000  0.00000000  0.01263367  0.00000000  0.01263367  0.00000000 -0.03790101  0.01263367
## [8,]  0.00000000  0.00000000  0.00000000  0.01263367  0.00000000  0.01263367  0.01263367 -0.03790101</code></pre>
</div>
<div id="cor8-c-4-pars" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> COR8-C (4 pars)<a href="congruence-between-independent-and-dependent-sses.html#cor8-c-4-pars" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="congruence-between-independent-and-dependent-sses.html#cb209-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb209-2"><a href="congruence-between-independent-and-dependent-sses.html#cb209-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 8L,</span>
<span id="cb209-3"><a href="congruence-between-independent-and-dependent-sses.html#cb209-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">list</span>(</span>
<span id="cb209-4"><a href="congruence-between-independent-and-dependent-sses.html#cb209-4" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb209-5"><a href="congruence-between-independent-and-dependent-sses.html#cb209-5" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb209-6"><a href="congruence-between-independent-and-dependent-sses.html#cb209-6" tabindex="-1"></a>  ))</span>
<span id="cb209-7"><a href="congruence-between-independent-and-dependent-sses.html#cb209-7" tabindex="-1"></a></span>
<span id="cb209-8"><a href="congruence-between-independent-and-dependent-sses.html#cb209-8" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb209-9"><a href="congruence-between-independent-and-dependent-sses.html#cb209-9" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb209-10"><a href="congruence-between-independent-and-dependent-sses.html#cb209-10" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">8</span>)</span>
<span id="cb209-11"><a href="congruence-between-independent-and-dependent-sses.html#cb209-11" tabindex="-1"></a><span class="co">#args</span></span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="congruence-between-independent-and-dependent-sses.html#cb210-1" tabindex="-1"></a>COR8_C.pars <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb210-2"><a href="congruence-between-independent-and-dependent-sses.html#cb210-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb210-3"><a href="congruence-between-independent-and-dependent-sses.html#cb210-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSIM){</span>
<span id="cb210-4"><a href="congruence-between-independent-and-dependent-sses.html#cb210-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb210-5"><a href="congruence-between-independent-and-dependent-sses.html#cb210-5" tabindex="-1"></a>  <span class="co">#-----------</span></span>
<span id="cb210-6"><a href="congruence-between-independent-and-dependent-sses.html#cb210-6" tabindex="-1"></a>  est <span class="ot">&lt;-</span> <span class="fu">get_item</span>(CID4[i], <span class="st">&#39;par&#39;</span>)</span>
<span id="cb210-7"><a href="congruence-between-independent-and-dependent-sses.html#cb210-7" tabindex="-1"></a>  pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb210-8"><a href="congruence-between-independent-and-dependent-sses.html#cb210-8" tabindex="-1"></a>  <span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb210-9"><a href="congruence-between-independent-and-dependent-sses.html#cb210-9" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam000&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb210-10"><a href="congruence-between-independent-and-dependent-sses.html#cb210-10" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam111&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb210-11"><a href="congruence-between-independent-and-dependent-sses.html#cb210-11" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam222&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb210-12"><a href="congruence-between-independent-and-dependent-sses.html#cb210-12" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam333&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb210-13"><a href="congruence-between-independent-and-dependent-sses.html#cb210-13" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam444&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb210-14"><a href="congruence-between-independent-and-dependent-sses.html#cb210-14" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam555&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb210-15"><a href="congruence-between-independent-and-dependent-sses.html#cb210-15" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam666&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb210-16"><a href="congruence-between-independent-and-dependent-sses.html#cb210-16" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam777&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb210-17"><a href="congruence-between-independent-and-dependent-sses.html#cb210-17" tabindex="-1"></a>  pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu4&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu5&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu6&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu7&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;mu0&#39;</span>]</span>
<span id="cb210-18"><a href="congruence-between-independent-and-dependent-sses.html#cb210-18" tabindex="-1"></a>  qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cor8_C.r)</span>
<span id="cb210-19"><a href="congruence-between-independent-and-dependent-sses.html#cb210-19" tabindex="-1"></a>  qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb210-20"><a href="congruence-between-independent-and-dependent-sses.html#cb210-20" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.1</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q01&#39;</span>]</span>
<span id="cb210-21"><a href="congruence-between-independent-and-dependent-sses.html#cb210-21" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.01</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q02&#39;</span>]<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb210-22"><a href="congruence-between-independent-and-dependent-sses.html#cb210-22" tabindex="-1"></a>  pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb210-23"><a href="congruence-between-independent-and-dependent-sses.html#cb210-23" tabindex="-1"></a>  </span>
<span id="cb210-24"><a href="congruence-between-independent-and-dependent-sses.html#cb210-24" tabindex="-1"></a>  <span class="co"># pars.hc</span></span>
<span id="cb210-25"><a href="congruence-between-independent-and-dependent-sses.html#cb210-25" tabindex="-1"></a>  <span class="co"># pars_to_arrays(pars.hc, 8)</span></span>
<span id="cb210-26"><a href="congruence-between-independent-and-dependent-sses.html#cb210-26" tabindex="-1"></a>  <span class="co">#v=c(1,3,5,7, 2,4,6,8)</span></span>
<span id="cb210-27"><a href="congruence-between-independent-and-dependent-sses.html#cb210-27" tabindex="-1"></a>  <span class="co">#pars_to_arrays(pars.hc, 8)$Q[v,v]</span></span>
<span id="cb210-28"><a href="congruence-between-independent-and-dependent-sses.html#cb210-28" tabindex="-1"></a>  </span>
<span id="cb210-29"><a href="congruence-between-independent-and-dependent-sses.html#cb210-29" tabindex="-1"></a>  <span class="co">#------</span></span>
<span id="cb210-30"><a href="congruence-between-independent-and-dependent-sses.html#cb210-30" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb210-31"><a href="congruence-between-independent-and-dependent-sses.html#cb210-31" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb210-32"><a href="congruence-between-independent-and-dependent-sses.html#cb210-32" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb210-33"><a href="congruence-between-independent-and-dependent-sses.html#cb210-33" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb210-34"><a href="congruence-between-independent-and-dependent-sses.html#cb210-34" tabindex="-1"></a>  </span>
<span id="cb210-35"><a href="congruence-between-independent-and-dependent-sses.html#cb210-35" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,  <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb210-36"><a href="congruence-between-independent-and-dependent-sses.html#cb210-36" tabindex="-1"></a>  COR8_C.pars[[i]] <span class="ot">&lt;-</span> <span class="fu">lik.c</span>(pars.hc, <span class="at">intermediates=</span>F, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span>T)</span>
<span id="cb210-37"><a href="congruence-between-independent-and-dependent-sses.html#cb210-37" tabindex="-1"></a>  </span>
<span id="cb210-38"><a href="congruence-between-independent-and-dependent-sses.html#cb210-38" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 4&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;</code></pre>
<p>Compare Ln</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="congruence-between-independent-and-dependent-sses.html#cb212-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="congruence-between-independent-and-dependent-sses.html#cb214-1" tabindex="-1"></a>COR8_C.pars <span class="sc">%&gt;%</span> unlist</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="congruence-between-independent-and-dependent-sses.html#cb216-1" tabindex="-1"></a><span class="fu">pars_to_arrays</span>(pars.hc, <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">reoder_lambdas</span>(., <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>, <span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>))</span></code></pre></div>
<pre><code>## $lam.tensor
## $lam.tensor$`1`
##            [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,] 0.05942176    0    0    0    0    0    0    0
## [2,] 0.00000000    0    0    0    0    0    0    0
## [3,] 0.00000000    0    0    0    0    0    0    0
## [4,] 0.00000000    0    0    0    0    0    0    0
## [5,] 0.00000000    0    0    0    0    0    0    0
## [6,] 0.00000000    0    0    0    0    0    0    0
## [7,] 0.00000000    0    0    0    0    0    0    0
## [8,] 0.00000000    0    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.05942176    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2]       [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0 0.00000000    0    0    0    0    0
## [2,]    0    0 0.00000000    0    0    0    0    0
## [3,]    0    0 0.08723677    0    0    0    0    0
## [4,]    0    0 0.00000000    0    0    0    0    0
## [5,]    0    0 0.00000000    0    0    0    0    0
## [6,]    0    0 0.00000000    0    0    0    0    0
## [7,]    0    0 0.00000000    0    0    0    0    0
## [8,]    0    0 0.00000000    0    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.08723677    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05942176    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.05942176    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6]       [,7] [,8]
## [1,]    0    0    0    0    0    0 0.00000000    0
## [2,]    0    0    0    0    0    0 0.00000000    0
## [3,]    0    0    0    0    0    0 0.00000000    0
## [4,]    0    0    0    0    0    0 0.00000000    0
## [5,]    0    0    0    0    0    0 0.00000000    0
## [6,]    0    0    0    0    0    0 0.00000000    0
## [7,]    0    0    0    0    0    0 0.08723677    0
## [8,]    0    0    0    0    0    0 0.00000000    0
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.08723677
## 
## 
## $mu
##         mu0         mu2         mu4         mu6         mu1         mu3         mu5         mu7 
## 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 
## 
## $Q
##             [,1]        [,2]        [,3]        [,4]        [,5]        [,6]        [,7]        [,8]
## [1,] -0.03790101  0.01263367  0.01263367  0.00000000  0.00000000  0.01263367  0.00000000  0.00000000
## [2,]  0.01263367 -0.03790101  0.00000000  0.01263367  0.01263367  0.00000000  0.00000000  0.00000000
## [3,]  0.01263367  0.00000000 -0.03790101  0.01263367  0.00000000  0.00000000  0.00000000  0.01263367
## [4,]  0.00000000  0.01263367  0.01263367 -0.03790101  0.00000000  0.00000000  0.01263367  0.00000000
## [5,]  0.00000000  0.01263367  0.00000000  0.00000000 -0.03790101  0.01263367  0.01263367  0.00000000
## [6,]  0.01263367  0.00000000  0.00000000  0.00000000  0.01263367 -0.03790101  0.00000000  0.01263367
## [7,]  0.00000000  0.00000000  0.00000000  0.01263367  0.01263367  0.00000000 -0.03790101  0.01263367
## [8,]  0.00000000  0.00000000  0.01263367  0.00000000  0.00000000  0.01263367  0.01263367 -0.03790101</code></pre>
</div>
<div id="cor8-nc-4-pars" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> COR8-NC (4 pars)<a href="congruence-between-independent-and-dependent-sses.html#cor8-nc-4-pars" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="congruence-between-independent-and-dependent-sses.html#cb218-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb218-2"><a href="congruence-between-independent-and-dependent-sses.html#cb218-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 8L,</span>
<span id="cb218-3"><a href="congruence-between-independent-and-dependent-sses.html#cb218-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">list</span>(</span>
<span id="cb218-4"><a href="congruence-between-independent-and-dependent-sses.html#cb218-4" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb218-5"><a href="congruence-between-independent-and-dependent-sses.html#cb218-5" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb218-6"><a href="congruence-between-independent-and-dependent-sses.html#cb218-6" tabindex="-1"></a>  ))</span>
<span id="cb218-7"><a href="congruence-between-independent-and-dependent-sses.html#cb218-7" tabindex="-1"></a></span>
<span id="cb218-8"><a href="congruence-between-independent-and-dependent-sses.html#cb218-8" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb218-9"><a href="congruence-between-independent-and-dependent-sses.html#cb218-9" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb218-10"><a href="congruence-between-independent-and-dependent-sses.html#cb218-10" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">8</span>)</span>
<span id="cb218-11"><a href="congruence-between-independent-and-dependent-sses.html#cb218-11" tabindex="-1"></a><span class="co">#args</span></span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="congruence-between-independent-and-dependent-sses.html#cb219-1" tabindex="-1"></a>COR8_NC.pars <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb219-2"><a href="congruence-between-independent-and-dependent-sses.html#cb219-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb219-3"><a href="congruence-between-independent-and-dependent-sses.html#cb219-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSIM){</span>
<span id="cb219-4"><a href="congruence-between-independent-and-dependent-sses.html#cb219-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb219-5"><a href="congruence-between-independent-and-dependent-sses.html#cb219-5" tabindex="-1"></a>  <span class="co">#-----------</span></span>
<span id="cb219-6"><a href="congruence-between-independent-and-dependent-sses.html#cb219-6" tabindex="-1"></a>  est <span class="ot">&lt;-</span> <span class="fu">get_item</span>(CID4[i], <span class="st">&#39;par&#39;</span>)</span>
<span id="cb219-7"><a href="congruence-between-independent-and-dependent-sses.html#cb219-7" tabindex="-1"></a>  pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb219-8"><a href="congruence-between-independent-and-dependent-sses.html#cb219-8" tabindex="-1"></a>  <span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb219-9"><a href="congruence-between-independent-and-dependent-sses.html#cb219-9" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam000&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb219-10"><a href="congruence-between-independent-and-dependent-sses.html#cb219-10" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam111&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb219-11"><a href="congruence-between-independent-and-dependent-sses.html#cb219-11" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam222&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb219-12"><a href="congruence-between-independent-and-dependent-sses.html#cb219-12" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam333&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb219-13"><a href="congruence-between-independent-and-dependent-sses.html#cb219-13" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam444&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb219-14"><a href="congruence-between-independent-and-dependent-sses.html#cb219-14" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam555&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb219-15"><a href="congruence-between-independent-and-dependent-sses.html#cb219-15" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam666&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb219-16"><a href="congruence-between-independent-and-dependent-sses.html#cb219-16" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam777&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb219-17"><a href="congruence-between-independent-and-dependent-sses.html#cb219-17" tabindex="-1"></a>  pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu4&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu5&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu6&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu7&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;mu0&#39;</span>]</span>
<span id="cb219-18"><a href="congruence-between-independent-and-dependent-sses.html#cb219-18" tabindex="-1"></a>  qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cor8_NC.r)</span>
<span id="cb219-19"><a href="congruence-between-independent-and-dependent-sses.html#cb219-19" tabindex="-1"></a>  qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb219-20"><a href="congruence-between-independent-and-dependent-sses.html#cb219-20" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.1</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q01&#39;</span>]</span>
<span id="cb219-21"><a href="congruence-between-independent-and-dependent-sses.html#cb219-21" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.01</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q02&#39;</span>]<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb219-22"><a href="congruence-between-independent-and-dependent-sses.html#cb219-22" tabindex="-1"></a>  pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb219-23"><a href="congruence-between-independent-and-dependent-sses.html#cb219-23" tabindex="-1"></a>  </span>
<span id="cb219-24"><a href="congruence-between-independent-and-dependent-sses.html#cb219-24" tabindex="-1"></a>  <span class="co"># pars.hc</span></span>
<span id="cb219-25"><a href="congruence-between-independent-and-dependent-sses.html#cb219-25" tabindex="-1"></a>  <span class="co"># pars_to_arrays(pars.hc, 8)</span></span>
<span id="cb219-26"><a href="congruence-between-independent-and-dependent-sses.html#cb219-26" tabindex="-1"></a>  <span class="co"># v=c(1,3,5,7, 2,4,6,8)</span></span>
<span id="cb219-27"><a href="congruence-between-independent-and-dependent-sses.html#cb219-27" tabindex="-1"></a>  <span class="co"># pars_to_arrays(pars.hc, 8)$Q[v,v]</span></span>
<span id="cb219-28"><a href="congruence-between-independent-and-dependent-sses.html#cb219-28" tabindex="-1"></a>  </span>
<span id="cb219-29"><a href="congruence-between-independent-and-dependent-sses.html#cb219-29" tabindex="-1"></a>  <span class="co">#------</span></span>
<span id="cb219-30"><a href="congruence-between-independent-and-dependent-sses.html#cb219-30" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb219-31"><a href="congruence-between-independent-and-dependent-sses.html#cb219-31" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb219-32"><a href="congruence-between-independent-and-dependent-sses.html#cb219-32" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb219-33"><a href="congruence-between-independent-and-dependent-sses.html#cb219-33" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb219-34"><a href="congruence-between-independent-and-dependent-sses.html#cb219-34" tabindex="-1"></a>  </span>
<span id="cb219-35"><a href="congruence-between-independent-and-dependent-sses.html#cb219-35" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,  <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb219-36"><a href="congruence-between-independent-and-dependent-sses.html#cb219-36" tabindex="-1"></a>  COR8_NC.pars[[i]] <span class="ot">&lt;-</span> <span class="fu">lik.c</span>(pars.hc, <span class="at">intermediates=</span>F, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span>T)</span>
<span id="cb219-37"><a href="congruence-between-independent-and-dependent-sses.html#cb219-37" tabindex="-1"></a>  </span>
<span id="cb219-38"><a href="congruence-between-independent-and-dependent-sses.html#cb219-38" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 4&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;</code></pre>
<p>Some helper function to assess the inference parameters</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="congruence-between-independent-and-dependent-sses.html#cb221-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="congruence-between-independent-and-dependent-sses.html#cb223-1" tabindex="-1"></a>COR8_NC.pars <span class="sc">%&gt;%</span> unlist</span></code></pre></div>
<pre><code>##  [1] -442.1584 -432.3652 -414.2528 -425.1997 -424.8447 -420.8153 -438.9214 -432.1182 -426.2918 -399.7270</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="congruence-between-independent-and-dependent-sses.html#cb225-1" tabindex="-1"></a><span class="fu">pars_to_arrays</span>(pars.hc, <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">reoder_lambdas</span>(., <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>, <span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>))</span></code></pre></div>
<pre><code>## $lam.tensor
## $lam.tensor$`1`
##            [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,] 0.05942176    0    0    0    0    0    0    0
## [2,] 0.00000000    0    0    0    0    0    0    0
## [3,] 0.00000000    0    0    0    0    0    0    0
## [4,] 0.00000000    0    0    0    0    0    0    0
## [5,] 0.00000000    0    0    0    0    0    0    0
## [6,] 0.00000000    0    0    0    0    0    0    0
## [7,] 0.00000000    0    0    0    0    0    0    0
## [8,] 0.00000000    0    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.05942176    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2]       [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0 0.00000000    0    0    0    0    0
## [2,]    0    0 0.00000000    0    0    0    0    0
## [3,]    0    0 0.08723677    0    0    0    0    0
## [4,]    0    0 0.00000000    0    0    0    0    0
## [5,]    0    0 0.00000000    0    0    0    0    0
## [6,]    0    0 0.00000000    0    0    0    0    0
## [7,]    0    0 0.00000000    0    0    0    0    0
## [8,]    0    0 0.00000000    0    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.08723677    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05942176    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.05942176    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6]       [,7] [,8]
## [1,]    0    0    0    0    0    0 0.00000000    0
## [2,]    0    0    0    0    0    0 0.00000000    0
## [3,]    0    0    0    0    0    0 0.00000000    0
## [4,]    0    0    0    0    0    0 0.00000000    0
## [5,]    0    0    0    0    0    0 0.00000000    0
## [6,]    0    0    0    0    0    0 0.00000000    0
## [7,]    0    0    0    0    0    0 0.08723677    0
## [8,]    0    0    0    0    0    0 0.00000000    0
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.08723677
## 
## 
## $mu
##         mu0         mu2         mu4         mu6         mu1         mu3         mu5         mu7 
## 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 
## 
## $Q
##             [,1]        [,2]        [,3]        [,4]        [,5]        [,6]        [,7]        [,8]
## [1,] -0.03790101  0.01263367  0.01263367  0.00000000  0.00000000  0.01263367  0.00000000  0.00000000
## [2,]  0.01263367 -0.02526734  0.00000000  0.01263367  0.00000000  0.00000000  0.00000000  0.00000000
## [3,]  0.01263367  0.00000000 -0.03790101  0.01263367  0.00000000  0.00000000  0.00000000  0.01263367
## [4,]  0.00000000  0.01263367  0.01263367 -0.02526734  0.00000000  0.00000000  0.00000000  0.00000000
## [5,]  0.00000000  0.01263367  0.00000000  0.00000000 -0.03790101  0.01263367  0.01263367  0.00000000
## [6,]  0.00000000  0.00000000  0.00000000  0.00000000  0.01263367 -0.02526734  0.00000000  0.01263367
## [7,]  0.00000000  0.00000000  0.00000000  0.01263367  0.01263367  0.00000000 -0.03790101  0.01263367
## [8,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.01263367  0.01263367 -0.02526734</code></pre>
</div>
<div id="cla8-c-4-pars" class="section level3 hasAnchor" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> CLA8-C (4 pars)<a href="congruence-between-independent-and-dependent-sses.html#cla8-c-4-pars" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="congruence-between-independent-and-dependent-sses.html#cb227-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb227-2"><a href="congruence-between-independent-and-dependent-sses.html#cb227-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 8L,</span>
<span id="cb227-3"><a href="congruence-between-independent-and-dependent-sses.html#cb227-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">list</span>(</span>
<span id="cb227-4"><a href="congruence-between-independent-and-dependent-sses.html#cb227-4" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb227-5"><a href="congruence-between-independent-and-dependent-sses.html#cb227-5" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb227-6"><a href="congruence-between-independent-and-dependent-sses.html#cb227-6" tabindex="-1"></a>  ))</span>
<span id="cb227-7"><a href="congruence-between-independent-and-dependent-sses.html#cb227-7" tabindex="-1"></a></span>
<span id="cb227-8"><a href="congruence-between-independent-and-dependent-sses.html#cb227-8" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb227-9"><a href="congruence-between-independent-and-dependent-sses.html#cb227-9" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb227-10"><a href="congruence-between-independent-and-dependent-sses.html#cb227-10" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">8</span>)</span>
<span id="cb227-11"><a href="congruence-between-independent-and-dependent-sses.html#cb227-11" tabindex="-1"></a><span class="co">#args$arrays</span></span>
<span id="cb227-12"><a href="congruence-between-independent-and-dependent-sses.html#cb227-12" tabindex="-1"></a><span class="co"># reoder_lambdas(args$arrays, c(1,3,5,7, 2,4,6,8))</span></span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="congruence-between-independent-and-dependent-sses.html#cb228-1" tabindex="-1"></a>CLA8_C.pars <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb228-2"><a href="congruence-between-independent-and-dependent-sses.html#cb228-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb228-3"><a href="congruence-between-independent-and-dependent-sses.html#cb228-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSIM){</span>
<span id="cb228-4"><a href="congruence-between-independent-and-dependent-sses.html#cb228-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb228-5"><a href="congruence-between-independent-and-dependent-sses.html#cb228-5" tabindex="-1"></a>  <span class="co">#-----------</span></span>
<span id="cb228-6"><a href="congruence-between-independent-and-dependent-sses.html#cb228-6" tabindex="-1"></a>  est <span class="ot">&lt;-</span> <span class="fu">get_item</span>(CID4[i], <span class="st">&#39;par&#39;</span>)</span>
<span id="cb228-7"><a href="congruence-between-independent-and-dependent-sses.html#cb228-7" tabindex="-1"></a>  pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb228-8"><a href="congruence-between-independent-and-dependent-sses.html#cb228-8" tabindex="-1"></a>  <span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb228-9"><a href="congruence-between-independent-and-dependent-sses.html#cb228-9" tabindex="-1"></a>  <span class="co"># pars.hc[&#39;lam000&#39;] &lt;- est[&#39;lam000&#39;]</span></span>
<span id="cb228-10"><a href="congruence-between-independent-and-dependent-sses.html#cb228-10" tabindex="-1"></a>  <span class="co"># pars.hc[&#39;lam111&#39;] &lt;- est[&#39;lam000&#39;]</span></span>
<span id="cb228-11"><a href="congruence-between-independent-and-dependent-sses.html#cb228-11" tabindex="-1"></a>  <span class="co"># pars.hc[&#39;lam222&#39;] &lt;- est[&#39;lam000&#39;]</span></span>
<span id="cb228-12"><a href="congruence-between-independent-and-dependent-sses.html#cb228-12" tabindex="-1"></a>  <span class="co"># pars.hc[&#39;lam333&#39;] &lt;- est[&#39;lam000&#39;]</span></span>
<span id="cb228-13"><a href="congruence-between-independent-and-dependent-sses.html#cb228-13" tabindex="-1"></a>  <span class="co"># pars.hc[&#39;lam444&#39;] &lt;- est[&#39;lam222&#39;]</span></span>
<span id="cb228-14"><a href="congruence-between-independent-and-dependent-sses.html#cb228-14" tabindex="-1"></a>  <span class="co"># pars.hc[&#39;lam555&#39;] &lt;- est[&#39;lam222&#39;]</span></span>
<span id="cb228-15"><a href="congruence-between-independent-and-dependent-sses.html#cb228-15" tabindex="-1"></a>  <span class="co"># pars.hc[&#39;lam666&#39;] &lt;- est[&#39;lam222&#39;]</span></span>
<span id="cb228-16"><a href="congruence-between-independent-and-dependent-sses.html#cb228-16" tabindex="-1"></a>  <span class="co"># pars.hc[&#39;lam777&#39;] &lt;- est[&#39;lam222&#39;]</span></span>
<span id="cb228-17"><a href="congruence-between-independent-and-dependent-sses.html#cb228-17" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam022&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb228-18"><a href="congruence-between-independent-and-dependent-sses.html#cb228-18" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam133&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb228-19"><a href="congruence-between-independent-and-dependent-sses.html#cb228-19" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam202&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb228-20"><a href="congruence-between-independent-and-dependent-sses.html#cb228-20" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam311&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb228-21"><a href="congruence-between-independent-and-dependent-sses.html#cb228-21" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam466&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb228-22"><a href="congruence-between-independent-and-dependent-sses.html#cb228-22" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam577&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb228-23"><a href="congruence-between-independent-and-dependent-sses.html#cb228-23" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam646&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb228-24"><a href="congruence-between-independent-and-dependent-sses.html#cb228-24" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam757&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb228-25"><a href="congruence-between-independent-and-dependent-sses.html#cb228-25" tabindex="-1"></a>  pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu4&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu5&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu6&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu7&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;mu0&#39;</span>]</span>
<span id="cb228-26"><a href="congruence-between-independent-and-dependent-sses.html#cb228-26" tabindex="-1"></a>  qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cor8_C.r)</span>
<span id="cb228-27"><a href="congruence-between-independent-and-dependent-sses.html#cb228-27" tabindex="-1"></a>  qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb228-28"><a href="congruence-between-independent-and-dependent-sses.html#cb228-28" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.1</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q01&#39;</span>]</span>
<span id="cb228-29"><a href="congruence-between-independent-and-dependent-sses.html#cb228-29" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.01</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q02&#39;</span>]<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb228-30"><a href="congruence-between-independent-and-dependent-sses.html#cb228-30" tabindex="-1"></a>  pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb228-31"><a href="congruence-between-independent-and-dependent-sses.html#cb228-31" tabindex="-1"></a>  </span>
<span id="cb228-32"><a href="congruence-between-independent-and-dependent-sses.html#cb228-32" tabindex="-1"></a>  <span class="co"># pars.hc</span></span>
<span id="cb228-33"><a href="congruence-between-independent-and-dependent-sses.html#cb228-33" tabindex="-1"></a>  <span class="co"># pars_to_arrays(pars.hc, 8)</span></span>
<span id="cb228-34"><a href="congruence-between-independent-and-dependent-sses.html#cb228-34" tabindex="-1"></a>  <span class="co"># v=c(1,3,5,7, 2,4,6,8)</span></span>
<span id="cb228-35"><a href="congruence-between-independent-and-dependent-sses.html#cb228-35" tabindex="-1"></a>  <span class="co"># pars_to_arrays(pars.hc, 8)$Q[v,v]</span></span>
<span id="cb228-36"><a href="congruence-between-independent-and-dependent-sses.html#cb228-36" tabindex="-1"></a>  </span>
<span id="cb228-37"><a href="congruence-between-independent-and-dependent-sses.html#cb228-37" tabindex="-1"></a>  <span class="co">#------</span></span>
<span id="cb228-38"><a href="congruence-between-independent-and-dependent-sses.html#cb228-38" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb228-39"><a href="congruence-between-independent-and-dependent-sses.html#cb228-39" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb228-40"><a href="congruence-between-independent-and-dependent-sses.html#cb228-40" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb228-41"><a href="congruence-between-independent-and-dependent-sses.html#cb228-41" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb228-42"><a href="congruence-between-independent-and-dependent-sses.html#cb228-42" tabindex="-1"></a>  </span>
<span id="cb228-43"><a href="congruence-between-independent-and-dependent-sses.html#cb228-43" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,  <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb228-44"><a href="congruence-between-independent-and-dependent-sses.html#cb228-44" tabindex="-1"></a>  CLA8_C.pars[[i]] <span class="ot">&lt;-</span> <span class="fu">lik.c</span>(pars.hc, <span class="at">intermediates=</span>F, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span>T)</span>
<span id="cb228-45"><a href="congruence-between-independent-and-dependent-sses.html#cb228-45" tabindex="-1"></a>  </span>
<span id="cb228-46"><a href="congruence-between-independent-and-dependent-sses.html#cb228-46" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 4&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;</code></pre>
<p>Some helper function to assess the inference parameters</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="congruence-between-independent-and-dependent-sses.html#cb230-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="congruence-between-independent-and-dependent-sses.html#cb232-1" tabindex="-1"></a>CLA8_C.pars <span class="sc">%&gt;%</span> unlist</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="congruence-between-independent-and-dependent-sses.html#cb234-1" tabindex="-1"></a><span class="fu">pars_to_arrays</span>(pars.hc, <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">reoder_lambdas</span>(., <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>, <span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>))</span></code></pre></div>
<pre><code>## $lam.tensor
## $lam.tensor$`1`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.05942176    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.05942176    0    0    0    0    0    0
## [2,]    0 0.00000000    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.08723677    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.08723677    0    0    0    0
## [4,]    0    0    0 0.00000000    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.05942176    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05942176    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.08723677
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.08723677
## [8,]    0    0    0    0    0    0    0 0.00000000
## 
## 
## $mu
##         mu0         mu2         mu4         mu6         mu1         mu3         mu5         mu7 
## 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 
## 
## $Q
##             [,1]        [,2]        [,3]        [,4]        [,5]        [,6]        [,7]        [,8]
## [1,] -0.03790101  0.01263367  0.01263367  0.00000000  0.00000000  0.01263367  0.00000000  0.00000000
## [2,]  0.01263367 -0.03790101  0.00000000  0.01263367  0.01263367  0.00000000  0.00000000  0.00000000
## [3,]  0.01263367  0.00000000 -0.03790101  0.01263367  0.00000000  0.00000000  0.00000000  0.01263367
## [4,]  0.00000000  0.01263367  0.01263367 -0.03790101  0.00000000  0.00000000  0.01263367  0.00000000
## [5,]  0.00000000  0.01263367  0.00000000  0.00000000 -0.03790101  0.01263367  0.01263367  0.00000000
## [6,]  0.01263367  0.00000000  0.00000000  0.00000000  0.01263367 -0.03790101  0.00000000  0.01263367
## [7,]  0.00000000  0.00000000  0.00000000  0.01263367  0.01263367  0.00000000 -0.03790101  0.01263367
## [8,]  0.00000000  0.00000000  0.01263367  0.00000000  0.00000000  0.01263367  0.01263367 -0.03790101</code></pre>
</div>
<div id="cla8-nc-4-pars" class="section level3 hasAnchor" number="4.4.5">
<h3><span class="header-section-number">4.4.5</span> CLA8-NC (4 pars)<a href="congruence-between-independent-and-dependent-sses.html#cla8-nc-4-pars" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="congruence-between-independent-and-dependent-sses.html#cb236-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb236-2"><a href="congruence-between-independent-and-dependent-sses.html#cb236-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 8L,</span>
<span id="cb236-3"><a href="congruence-between-independent-and-dependent-sses.html#cb236-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">list</span>(</span>
<span id="cb236-4"><a href="congruence-between-independent-and-dependent-sses.html#cb236-4" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb236-5"><a href="congruence-between-independent-and-dependent-sses.html#cb236-5" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb236-6"><a href="congruence-between-independent-and-dependent-sses.html#cb236-6" tabindex="-1"></a>  ))</span>
<span id="cb236-7"><a href="congruence-between-independent-and-dependent-sses.html#cb236-7" tabindex="-1"></a></span>
<span id="cb236-8"><a href="congruence-between-independent-and-dependent-sses.html#cb236-8" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb236-9"><a href="congruence-between-independent-and-dependent-sses.html#cb236-9" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb236-10"><a href="congruence-between-independent-and-dependent-sses.html#cb236-10" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">8</span>)</span>
<span id="cb236-11"><a href="congruence-between-independent-and-dependent-sses.html#cb236-11" tabindex="-1"></a><span class="co">#args$arrays</span></span>
<span id="cb236-12"><a href="congruence-between-independent-and-dependent-sses.html#cb236-12" tabindex="-1"></a><span class="co">#v=c(1,3,5,7, 2,4,6,8)</span></span>
<span id="cb236-13"><a href="congruence-between-independent-and-dependent-sses.html#cb236-13" tabindex="-1"></a><span class="co">#reoder_lambdas(args$arrays, c(1,3,5,7, 2,4,6,8))</span></span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="congruence-between-independent-and-dependent-sses.html#cb237-1" tabindex="-1"></a>CLA8_NC.pars <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb237-2"><a href="congruence-between-independent-and-dependent-sses.html#cb237-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb237-3"><a href="congruence-between-independent-and-dependent-sses.html#cb237-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSIM){</span>
<span id="cb237-4"><a href="congruence-between-independent-and-dependent-sses.html#cb237-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb237-5"><a href="congruence-between-independent-and-dependent-sses.html#cb237-5" tabindex="-1"></a>  <span class="co">#-----------</span></span>
<span id="cb237-6"><a href="congruence-between-independent-and-dependent-sses.html#cb237-6" tabindex="-1"></a>  est <span class="ot">&lt;-</span> <span class="fu">get_item</span>(CID4[i], <span class="st">&#39;par&#39;</span>)</span>
<span id="cb237-7"><a href="congruence-between-independent-and-dependent-sses.html#cb237-7" tabindex="-1"></a>  pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb237-8"><a href="congruence-between-independent-and-dependent-sses.html#cb237-8" tabindex="-1"></a>  <span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb237-9"><a href="congruence-between-independent-and-dependent-sses.html#cb237-9" tabindex="-1"></a>  <span class="co"># lam004, lam116, lam422 violate lumpability</span></span>
<span id="cb237-10"><a href="congruence-between-independent-and-dependent-sses.html#cb237-10" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam004&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb237-11"><a href="congruence-between-independent-and-dependent-sses.html#cb237-11" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam116&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb237-12"><a href="congruence-between-independent-and-dependent-sses.html#cb237-12" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam202&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb237-13"><a href="congruence-between-independent-and-dependent-sses.html#cb237-13" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam311&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb237-14"><a href="congruence-between-independent-and-dependent-sses.html#cb237-14" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam422&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb237-15"><a href="congruence-between-independent-and-dependent-sses.html#cb237-15" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam577&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb237-16"><a href="congruence-between-independent-and-dependent-sses.html#cb237-16" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam646&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb237-17"><a href="congruence-between-independent-and-dependent-sses.html#cb237-17" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam757&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb237-18"><a href="congruence-between-independent-and-dependent-sses.html#cb237-18" tabindex="-1"></a>  pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu4&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu5&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu6&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu7&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;mu0&#39;</span>]</span>
<span id="cb237-19"><a href="congruence-between-independent-and-dependent-sses.html#cb237-19" tabindex="-1"></a>  qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cor8_C.r)</span>
<span id="cb237-20"><a href="congruence-between-independent-and-dependent-sses.html#cb237-20" tabindex="-1"></a>  qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb237-21"><a href="congruence-between-independent-and-dependent-sses.html#cb237-21" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.1</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q01&#39;</span>]</span>
<span id="cb237-22"><a href="congruence-between-independent-and-dependent-sses.html#cb237-22" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.01</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q02&#39;</span>]<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb237-23"><a href="congruence-between-independent-and-dependent-sses.html#cb237-23" tabindex="-1"></a>  pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb237-24"><a href="congruence-between-independent-and-dependent-sses.html#cb237-24" tabindex="-1"></a>  </span>
<span id="cb237-25"><a href="congruence-between-independent-and-dependent-sses.html#cb237-25" tabindex="-1"></a>  <span class="co"># pars.hc</span></span>
<span id="cb237-26"><a href="congruence-between-independent-and-dependent-sses.html#cb237-26" tabindex="-1"></a>  <span class="co"># pars_to_arrays(pars.hc, 8)</span></span>
<span id="cb237-27"><a href="congruence-between-independent-and-dependent-sses.html#cb237-27" tabindex="-1"></a>  <span class="co"># v=c(1,3,5,7, 2,4,6,8)</span></span>
<span id="cb237-28"><a href="congruence-between-independent-and-dependent-sses.html#cb237-28" tabindex="-1"></a>  <span class="co"># pars_to_arrays(pars.hc, 8)$Q[v,v]</span></span>
<span id="cb237-29"><a href="congruence-between-independent-and-dependent-sses.html#cb237-29" tabindex="-1"></a>  </span>
<span id="cb237-30"><a href="congruence-between-independent-and-dependent-sses.html#cb237-30" tabindex="-1"></a>  <span class="co">#------</span></span>
<span id="cb237-31"><a href="congruence-between-independent-and-dependent-sses.html#cb237-31" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb237-32"><a href="congruence-between-independent-and-dependent-sses.html#cb237-32" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb237-33"><a href="congruence-between-independent-and-dependent-sses.html#cb237-33" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb237-34"><a href="congruence-between-independent-and-dependent-sses.html#cb237-34" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb237-35"><a href="congruence-between-independent-and-dependent-sses.html#cb237-35" tabindex="-1"></a>  </span>
<span id="cb237-36"><a href="congruence-between-independent-and-dependent-sses.html#cb237-36" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,  <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb237-37"><a href="congruence-between-independent-and-dependent-sses.html#cb237-37" tabindex="-1"></a>  CLA8_NC.pars[[i]] <span class="ot">&lt;-</span> <span class="fu">lik.c</span>(pars.hc, <span class="at">intermediates=</span>F, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span>T)</span>
<span id="cb237-38"><a href="congruence-between-independent-and-dependent-sses.html#cb237-38" tabindex="-1"></a>  </span>
<span id="cb237-39"><a href="congruence-between-independent-and-dependent-sses.html#cb237-39" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 4&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;</code></pre>
<p>Some helper function to assess the inference parameters</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="congruence-between-independent-and-dependent-sses.html#cb239-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="congruence-between-independent-and-dependent-sses.html#cb241-1" tabindex="-1"></a>CLA8_NC.pars <span class="sc">%&gt;%</span> unlist</span></code></pre></div>
<pre><code>##  [1] -432.3801 -423.9786 -407.2375 -416.6835 -427.4961 -411.1675 -428.8506 -435.2936 -416.6131 -396.3307</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="congruence-between-independent-and-dependent-sses.html#cb243-1" tabindex="-1"></a><span class="fu">pars_to_arrays</span>(pars.hc, <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">reoder_lambdas</span>(., <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>, <span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>))</span></code></pre></div>
<pre><code>## $lam.tensor
## $lam.tensor$`1`
##      [,1] [,2]       [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0 0.05942176    0    0    0    0    0
## [2,]    0    0 0.00000000    0    0    0    0    0
## [3,]    0    0 0.00000000    0    0    0    0    0
## [4,]    0    0 0.00000000    0    0    0    0    0
## [5,]    0    0 0.00000000    0    0    0    0    0
## [6,]    0    0 0.00000000    0    0    0    0    0
## [7,]    0    0 0.00000000    0    0    0    0    0
## [8,]    0    0 0.00000000    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.05942176    0    0    0    0    0    0
## [2,]    0 0.00000000    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.08723677    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.08723677    0    0    0    0
## [4,]    0    0    0 0.00000000    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.00000000    0    0    0    0
## [5,]    0    0    0 0.05942176    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05942176    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.08723677
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.08723677
## [8,]    0    0    0    0    0    0    0 0.00000000
## 
## 
## $mu
##         mu0         mu2         mu4         mu6         mu1         mu3         mu5         mu7 
## 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 
## 
## $Q
##             [,1]        [,2]        [,3]        [,4]        [,5]        [,6]        [,7]        [,8]
## [1,] -0.03790101  0.01263367  0.01263367  0.00000000  0.00000000  0.01263367  0.00000000  0.00000000
## [2,]  0.01263367 -0.03790101  0.00000000  0.01263367  0.01263367  0.00000000  0.00000000  0.00000000
## [3,]  0.01263367  0.00000000 -0.03790101  0.01263367  0.00000000  0.00000000  0.00000000  0.01263367
## [4,]  0.00000000  0.01263367  0.01263367 -0.03790101  0.00000000  0.00000000  0.01263367  0.00000000
## [5,]  0.00000000  0.01263367  0.00000000  0.00000000 -0.03790101  0.01263367  0.01263367  0.00000000
## [6,]  0.01263367  0.00000000  0.00000000  0.00000000  0.01263367 -0.03790101  0.00000000  0.01263367
## [7,]  0.00000000  0.00000000  0.00000000  0.01263367  0.01263367  0.00000000 -0.03790101  0.01263367
## [8,]  0.00000000  0.00000000  0.01263367  0.00000000  0.00000000  0.01263367  0.01263367 -0.03790101</code></pre>
</div>
</div>
<div id="maximum-likelihood.-all-models-have-4-pars." class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Maximum Likelihood. All models have 4 pars.<a href="congruence-between-independent-and-dependent-sses.html#maximum-likelihood.-all-models-have-4-pars." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="cid8" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> CID8<a href="congruence-between-independent-and-dependent-sses.html#cid8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="congruence-between-independent-and-dependent-sses.html#cb245-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb245-2"><a href="congruence-between-independent-and-dependent-sses.html#cb245-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 8L,</span>
<span id="cb245-3"><a href="congruence-between-independent-and-dependent-sses.html#cb245-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">list</span>(</span>
<span id="cb245-4"><a href="congruence-between-independent-and-dependent-sses.html#cb245-4" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb245-5"><a href="congruence-between-independent-and-dependent-sses.html#cb245-5" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb245-6"><a href="congruence-between-independent-and-dependent-sses.html#cb245-6" tabindex="-1"></a>  ))</span>
<span id="cb245-7"><a href="congruence-between-independent-and-dependent-sses.html#cb245-7" tabindex="-1"></a></span>
<span id="cb245-8"><a href="congruence-between-independent-and-dependent-sses.html#cb245-8" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb245-9"><a href="congruence-between-independent-and-dependent-sses.html#cb245-9" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb245-10"><a href="congruence-between-independent-and-dependent-sses.html#cb245-10" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">8</span>)</span>
<span id="cb245-11"><a href="congruence-between-independent-and-dependent-sses.html#cb245-11" tabindex="-1"></a><span class="co">#args$arrays</span></span>
<span id="cb245-12"><a href="congruence-between-independent-and-dependent-sses.html#cb245-12" tabindex="-1"></a><span class="co">#args$pars</span></span>
<span id="cb245-13"><a href="congruence-between-independent-and-dependent-sses.html#cb245-13" tabindex="-1"></a><span class="co">#length(args$pars)</span></span>
<span id="cb245-14"><a href="congruence-between-independent-and-dependent-sses.html#cb245-14" tabindex="-1"></a></span>
<span id="cb245-15"><a href="congruence-between-independent-and-dependent-sses.html#cb245-15" tabindex="-1"></a>pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb245-16"><a href="congruence-between-independent-and-dependent-sses.html#cb245-16" tabindex="-1"></a><span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb245-17"><a href="congruence-between-independent-and-dependent-sses.html#cb245-17" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam000&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb245-18"><a href="congruence-between-independent-and-dependent-sses.html#cb245-18" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam111&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb245-19"><a href="congruence-between-independent-and-dependent-sses.html#cb245-19" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam222&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb245-20"><a href="congruence-between-independent-and-dependent-sses.html#cb245-20" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam333&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb245-21"><a href="congruence-between-independent-and-dependent-sses.html#cb245-21" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam444&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb245-22"><a href="congruence-between-independent-and-dependent-sses.html#cb245-22" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam555&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb245-23"><a href="congruence-between-independent-and-dependent-sses.html#cb245-23" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam666&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb245-24"><a href="congruence-between-independent-and-dependent-sses.html#cb245-24" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam777&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb245-25"><a href="congruence-between-independent-and-dependent-sses.html#cb245-25" tabindex="-1"></a>pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu4&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu5&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu6&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu7&#39;</span>] <span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb245-26"><a href="congruence-between-independent-and-dependent-sses.html#cb245-26" tabindex="-1"></a>qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cid8.r)</span>
<span id="cb245-27"><a href="congruence-between-independent-and-dependent-sses.html#cb245-27" tabindex="-1"></a>qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb245-28"><a href="congruence-between-independent-and-dependent-sses.html#cb245-28" tabindex="-1"></a><span class="co">#unique(qs)</span></span>
<span id="cb245-29"><a href="congruence-between-independent-and-dependent-sses.html#cb245-29" tabindex="-1"></a>pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb245-30"><a href="congruence-between-independent-and-dependent-sses.html#cb245-30" tabindex="-1"></a></span>
<span id="cb245-31"><a href="congruence-between-independent-and-dependent-sses.html#cb245-31" tabindex="-1"></a><span class="co">#pars.hc</span></span>
<span id="cb245-32"><a href="congruence-between-independent-and-dependent-sses.html#cb245-32" tabindex="-1"></a><span class="co">#pars_to_arrays(pars.hc,8)</span></span>
<span id="cb245-33"><a href="congruence-between-independent-and-dependent-sses.html#cb245-33" tabindex="-1"></a><span class="co">#args</span></span>
<span id="cb245-34"><a href="congruence-between-independent-and-dependent-sses.html#cb245-34" tabindex="-1"></a></span>
<span id="cb245-35"><a href="congruence-between-independent-and-dependent-sses.html#cb245-35" tabindex="-1"></a>zero.constr <span class="ot">&lt;-</span> <span class="fu">formulas_zero_pars</span>(pars.hc)</span>
<span id="cb245-36"><a href="congruence-between-independent-and-dependent-sses.html#cb245-36" tabindex="-1"></a>f.qs <span class="ot">&lt;-</span> <span class="fu">assign_classes_pairwise</span>(Q_cid8.r, args<span class="sc">$</span>arrays<span class="sc">$</span>Q)</span>
<span id="cb245-37"><a href="congruence-between-independent-and-dependent-sses.html#cb245-37" tabindex="-1"></a>f.mu <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1 <span class="sc">~</span> mu0, mu2 <span class="sc">~</span> mu0, mu3 <span class="sc">~</span> mu0, mu4 <span class="sc">~</span> mu0, mu5 <span class="sc">~</span> mu0, mu6 <span class="sc">~</span> mu0, mu7 <span class="sc">~</span> mu0)</span>
<span id="cb245-38"><a href="congruence-between-independent-and-dependent-sses.html#cb245-38" tabindex="-1"></a>f.lams <span class="ot">&lt;-</span> <span class="fu">c</span>(lam111 <span class="sc">~</span> lam000, lam222 <span class="sc">~</span> lam000, lam333 <span class="sc">~</span> lam000,   </span>
<span id="cb245-39"><a href="congruence-between-independent-and-dependent-sses.html#cb245-39" tabindex="-1"></a>            lam555 <span class="sc">~</span> lam444, lam666 <span class="sc">~</span> lam444, lam777 <span class="sc">~</span> lam444)</span>
<span id="cb245-40"><a href="congruence-between-independent-and-dependent-sses.html#cb245-40" tabindex="-1"></a>f.list<span class="ot">&lt;-</span> <span class="fu">c</span>(zero.constr,  f.qs, f.mu, f.lams)</span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="congruence-between-independent-and-dependent-sses.html#cb246-1" tabindex="-1"></a>CID8 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb246-2"><a href="congruence-between-independent-and-dependent-sses.html#cb246-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb246-3"><a href="congruence-between-independent-and-dependent-sses.html#cb246-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSIM){</span>
<span id="cb246-4"><a href="congruence-between-independent-and-dependent-sses.html#cb246-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb246-5"><a href="congruence-between-independent-and-dependent-sses.html#cb246-5" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb246-6"><a href="congruence-between-independent-and-dependent-sses.html#cb246-6" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb246-7"><a href="congruence-between-independent-and-dependent-sses.html#cb246-7" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb246-8"><a href="congruence-between-independent-and-dependent-sses.html#cb246-8" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb246-9"><a href="congruence-between-independent-and-dependent-sses.html#cb246-9" tabindex="-1"></a>  </span>
<span id="cb246-10"><a href="congruence-between-independent-and-dependent-sses.html#cb246-10" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,  <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb246-11"><a href="congruence-between-independent-and-dependent-sses.html#cb246-11" tabindex="-1"></a>  lik.const <span class="ot">&lt;-</span> <span class="fu">constrain</span>(lik.c, <span class="at">formulae =</span> f.list)</span>
<span id="cb246-12"><a href="congruence-between-independent-and-dependent-sses.html#cb246-12" tabindex="-1"></a>  arg.const <span class="ot">&lt;-</span> <span class="fu">argnames</span>(lik.const)</span>
<span id="cb246-13"><a href="congruence-between-independent-and-dependent-sses.html#cb246-13" tabindex="-1"></a>  starting.point <span class="ot">&lt;-</span> pars.hc[arg.const]</span>
<span id="cb246-14"><a href="congruence-between-independent-and-dependent-sses.html#cb246-14" tabindex="-1"></a>  <span class="co"># starting.point &lt;- get_item(CID4[i], &#39;par&#39;)</span></span>
<span id="cb246-15"><a href="congruence-between-independent-and-dependent-sses.html#cb246-15" tabindex="-1"></a>  <span class="co"># names(starting.point) &lt;- c(&#39;lam444&#39;, &#39;lam000&#39;, &#39;mu0&#39;, &#39;q01&#39;, &#39;q02&#39;)</span></span>
<span id="cb246-16"><a href="congruence-between-independent-and-dependent-sses.html#cb246-16" tabindex="-1"></a>  <span class="co"># starting.point[&#39;q01&#39;] &lt;- starting.point[&#39;q02&#39;]/2</span></span>
<span id="cb246-17"><a href="congruence-between-independent-and-dependent-sses.html#cb246-17" tabindex="-1"></a>  </span>
<span id="cb246-18"><a href="congruence-between-independent-and-dependent-sses.html#cb246-18" tabindex="-1"></a>  CID8[[i]] <span class="ot">&lt;-</span> <span class="fu">find.mle</span>(lik.const, starting.point, <span class="at">method=</span><span class="st">&quot;subplex&quot;</span>, <span class="at">keep.func=</span>F, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span><span class="cn">TRUE</span>)</span>
<span id="cb246-19"><a href="congruence-between-independent-and-dependent-sses.html#cb246-19" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 4&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;</code></pre>
<p>Assessing the inferred parameters</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="congruence-between-independent-and-dependent-sses.html#cb248-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="congruence-between-independent-and-dependent-sses.html#cb250-1" tabindex="-1"></a><span class="fu">get_item</span>(CID8, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="congruence-between-independent-and-dependent-sses.html#cb252-1" tabindex="-1"></a><span class="fu">get_item</span>(CID8[<span class="dv">1</span>], <span class="st">&#39;par&#39;</span>)</span></code></pre></div>
<pre><code>##       lam000       lam444          mu0          q01 
## 0.0509438630 0.0509155136 0.0003102256 0.0075620757</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="congruence-between-independent-and-dependent-sses.html#cb254-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4[<span class="dv">1</span>], <span class="st">&#39;par&#39;</span>)</span></code></pre></div>
<pre><code>##       lam000       lam222          mu0          q01 
## 0.0509438630 0.0509155136 0.0003102256 0.0075620757</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="congruence-between-independent-and-dependent-sses.html#cb256-1" tabindex="-1"></a><span class="co">#pars_to_arrays(CID8[[1]]$par.full, 8)</span></span>
<span id="cb256-2"><a href="congruence-between-independent-and-dependent-sses.html#cb256-2" tabindex="-1"></a><span class="fu">pars_to_arrays</span>(CID8[[<span class="dv">1</span>]]<span class="sc">$</span>par.full, <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">reoder_lambdas</span>(., <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>, <span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>))</span></code></pre></div>
<pre><code>## $lam.tensor
## $lam.tensor$`1`
##            [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,] 0.05094386    0    0    0    0    0    0    0
## [2,] 0.00000000    0    0    0    0    0    0    0
## [3,] 0.00000000    0    0    0    0    0    0    0
## [4,] 0.00000000    0    0    0    0    0    0    0
## [5,] 0.00000000    0    0    0    0    0    0    0
## [6,] 0.00000000    0    0    0    0    0    0    0
## [7,] 0.00000000    0    0    0    0    0    0    0
## [8,] 0.00000000    0    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.05094386    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2]       [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0 0.00000000    0    0    0    0    0
## [2,]    0    0 0.00000000    0    0    0    0    0
## [3,]    0    0 0.05091551    0    0    0    0    0
## [4,]    0    0 0.00000000    0    0    0    0    0
## [5,]    0    0 0.00000000    0    0    0    0    0
## [6,]    0    0 0.00000000    0    0    0    0    0
## [7,]    0    0 0.00000000    0    0    0    0    0
## [8,]    0    0 0.00000000    0    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.05091551    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05094386    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.05094386    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6]       [,7] [,8]
## [1,]    0    0    0    0    0    0 0.00000000    0
## [2,]    0    0    0    0    0    0 0.00000000    0
## [3,]    0    0    0    0    0    0 0.00000000    0
## [4,]    0    0    0    0    0    0 0.00000000    0
## [5,]    0    0    0    0    0    0 0.00000000    0
## [6,]    0    0    0    0    0    0 0.00000000    0
## [7,]    0    0    0    0    0    0 0.05091551    0
## [8,]    0    0    0    0    0    0 0.00000000    0
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.05091551
## 
## 
## $mu
##          mu0          mu2          mu4          mu6          mu1          mu3          mu5          mu7 
## 0.0003102256 0.0003102256 0.0003102256 0.0003102256 0.0003102256 0.0003102256 0.0003102256 0.0003102256 
## 
## $Q
##              [,1]         [,2]         [,3]         [,4]         [,5]         [,6]         [,7]         [,8]
## [1,] -0.022686227  0.007562076  0.007562076  0.000000000  0.007562076  0.000000000  0.000000000  0.000000000
## [2,]  0.007562076 -0.022686227  0.000000000  0.007562076  0.000000000  0.007562076  0.000000000  0.000000000
## [3,]  0.007562076  0.000000000 -0.022686227  0.007562076  0.000000000  0.000000000  0.007562076  0.000000000
## [4,]  0.000000000  0.007562076  0.007562076 -0.022686227  0.000000000  0.000000000  0.000000000  0.007562076
## [5,]  0.007562076  0.000000000  0.000000000  0.000000000 -0.022686227  0.007562076  0.007562076  0.000000000
## [6,]  0.000000000  0.007562076  0.000000000  0.000000000  0.007562076 -0.022686227  0.000000000  0.007562076
## [7,]  0.000000000  0.000000000  0.007562076  0.000000000  0.007562076  0.000000000 -0.022686227  0.007562076
## [8,]  0.000000000  0.000000000  0.000000000  0.007562076  0.000000000  0.007562076  0.007562076 -0.022686227</code></pre>
</div>
<div id="cor8-c" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> COR8-C<a href="congruence-between-independent-and-dependent-sses.html#cor8-c" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="congruence-between-independent-and-dependent-sses.html#cb258-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb258-2"><a href="congruence-between-independent-and-dependent-sses.html#cb258-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 8L,</span>
<span id="cb258-3"><a href="congruence-between-independent-and-dependent-sses.html#cb258-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">list</span>(</span>
<span id="cb258-4"><a href="congruence-between-independent-and-dependent-sses.html#cb258-4" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb258-5"><a href="congruence-between-independent-and-dependent-sses.html#cb258-5" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb258-6"><a href="congruence-between-independent-and-dependent-sses.html#cb258-6" tabindex="-1"></a>  ))</span>
<span id="cb258-7"><a href="congruence-between-independent-and-dependent-sses.html#cb258-7" tabindex="-1"></a></span>
<span id="cb258-8"><a href="congruence-between-independent-and-dependent-sses.html#cb258-8" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb258-9"><a href="congruence-between-independent-and-dependent-sses.html#cb258-9" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb258-10"><a href="congruence-between-independent-and-dependent-sses.html#cb258-10" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">8</span>)</span>
<span id="cb258-11"><a href="congruence-between-independent-and-dependent-sses.html#cb258-11" tabindex="-1"></a><span class="co">#args</span></span>
<span id="cb258-12"><a href="congruence-between-independent-and-dependent-sses.html#cb258-12" tabindex="-1"></a><span class="co">#args$pars</span></span>
<span id="cb258-13"><a href="congruence-between-independent-and-dependent-sses.html#cb258-13" tabindex="-1"></a><span class="co">#length(args$pars)</span></span>
<span id="cb258-14"><a href="congruence-between-independent-and-dependent-sses.html#cb258-14" tabindex="-1"></a></span>
<span id="cb258-15"><a href="congruence-between-independent-and-dependent-sses.html#cb258-15" tabindex="-1"></a>pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb258-16"><a href="congruence-between-independent-and-dependent-sses.html#cb258-16" tabindex="-1"></a><span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb258-17"><a href="congruence-between-independent-and-dependent-sses.html#cb258-17" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam000&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb258-18"><a href="congruence-between-independent-and-dependent-sses.html#cb258-18" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam111&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb258-19"><a href="congruence-between-independent-and-dependent-sses.html#cb258-19" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam222&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb258-20"><a href="congruence-between-independent-and-dependent-sses.html#cb258-20" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam333&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb258-21"><a href="congruence-between-independent-and-dependent-sses.html#cb258-21" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam444&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb258-22"><a href="congruence-between-independent-and-dependent-sses.html#cb258-22" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam555&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb258-23"><a href="congruence-between-independent-and-dependent-sses.html#cb258-23" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam666&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb258-24"><a href="congruence-between-independent-and-dependent-sses.html#cb258-24" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam777&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb258-25"><a href="congruence-between-independent-and-dependent-sses.html#cb258-25" tabindex="-1"></a>pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu4&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu5&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu6&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu7&#39;</span>] <span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb258-26"><a href="congruence-between-independent-and-dependent-sses.html#cb258-26" tabindex="-1"></a>qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cor8_C.r)</span>
<span id="cb258-27"><a href="congruence-between-independent-and-dependent-sses.html#cb258-27" tabindex="-1"></a>qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb258-28"><a href="congruence-between-independent-and-dependent-sses.html#cb258-28" tabindex="-1"></a>pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb258-29"><a href="congruence-between-independent-and-dependent-sses.html#cb258-29" tabindex="-1"></a></span>
<span id="cb258-30"><a href="congruence-between-independent-and-dependent-sses.html#cb258-30" tabindex="-1"></a><span class="co">#pars.hc</span></span>
<span id="cb258-31"><a href="congruence-between-independent-and-dependent-sses.html#cb258-31" tabindex="-1"></a><span class="co">#pars_to_arrays(pars.hc,8)</span></span>
<span id="cb258-32"><a href="congruence-between-independent-and-dependent-sses.html#cb258-32" tabindex="-1"></a><span class="co">#args</span></span>
<span id="cb258-33"><a href="congruence-between-independent-and-dependent-sses.html#cb258-33" tabindex="-1"></a></span>
<span id="cb258-34"><a href="congruence-between-independent-and-dependent-sses.html#cb258-34" tabindex="-1"></a>zero.constr <span class="ot">&lt;-</span> <span class="fu">formulas_zero_pars</span>(pars.hc)</span>
<span id="cb258-35"><a href="congruence-between-independent-and-dependent-sses.html#cb258-35" tabindex="-1"></a>f.qs <span class="ot">&lt;-</span> <span class="fu">assign_classes_pairwise</span>(Q_cor8_C.r, args<span class="sc">$</span>arrays<span class="sc">$</span>Q)</span>
<span id="cb258-36"><a href="congruence-between-independent-and-dependent-sses.html#cb258-36" tabindex="-1"></a>f.mu <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1 <span class="sc">~</span> mu0, mu2 <span class="sc">~</span> mu0, mu3 <span class="sc">~</span> mu0, mu4 <span class="sc">~</span> mu0, mu5 <span class="sc">~</span> mu0, mu6 <span class="sc">~</span> mu0, mu7 <span class="sc">~</span> mu0)</span>
<span id="cb258-37"><a href="congruence-between-independent-and-dependent-sses.html#cb258-37" tabindex="-1"></a>f.lams <span class="ot">&lt;-</span> <span class="fu">c</span>(lam111 <span class="sc">~</span> lam000, lam222 <span class="sc">~</span> lam000, lam333 <span class="sc">~</span> lam000,   </span>
<span id="cb258-38"><a href="congruence-between-independent-and-dependent-sses.html#cb258-38" tabindex="-1"></a>            lam555 <span class="sc">~</span> lam444, lam666 <span class="sc">~</span> lam444, lam777 <span class="sc">~</span> lam444)</span>
<span id="cb258-39"><a href="congruence-between-independent-and-dependent-sses.html#cb258-39" tabindex="-1"></a>f.list<span class="ot">&lt;-</span> <span class="fu">c</span>(zero.constr,  f.qs, f.mu, f.lams)</span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="congruence-between-independent-and-dependent-sses.html#cb259-1" tabindex="-1"></a>COR8_C <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb259-2"><a href="congruence-between-independent-and-dependent-sses.html#cb259-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb259-3"><a href="congruence-between-independent-and-dependent-sses.html#cb259-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSIM){</span>
<span id="cb259-4"><a href="congruence-between-independent-and-dependent-sses.html#cb259-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb259-5"><a href="congruence-between-independent-and-dependent-sses.html#cb259-5" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb259-6"><a href="congruence-between-independent-and-dependent-sses.html#cb259-6" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb259-7"><a href="congruence-between-independent-and-dependent-sses.html#cb259-7" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb259-8"><a href="congruence-between-independent-and-dependent-sses.html#cb259-8" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb259-9"><a href="congruence-between-independent-and-dependent-sses.html#cb259-9" tabindex="-1"></a>  </span>
<span id="cb259-10"><a href="congruence-between-independent-and-dependent-sses.html#cb259-10" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,  <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb259-11"><a href="congruence-between-independent-and-dependent-sses.html#cb259-11" tabindex="-1"></a>  lik.const <span class="ot">&lt;-</span> <span class="fu">constrain</span>(lik.c, <span class="at">formulae =</span> f.list)</span>
<span id="cb259-12"><a href="congruence-between-independent-and-dependent-sses.html#cb259-12" tabindex="-1"></a>  arg.const <span class="ot">&lt;-</span> <span class="fu">argnames</span>(lik.const)</span>
<span id="cb259-13"><a href="congruence-between-independent-and-dependent-sses.html#cb259-13" tabindex="-1"></a>  starting.point <span class="ot">&lt;-</span> pars.hc[arg.const]</span>
<span id="cb259-14"><a href="congruence-between-independent-and-dependent-sses.html#cb259-14" tabindex="-1"></a>  <span class="co"># starting.point &lt;- get_item(CID8[i], &#39;par&#39;)</span></span>
<span id="cb259-15"><a href="congruence-between-independent-and-dependent-sses.html#cb259-15" tabindex="-1"></a>  <span class="co"># names(starting.point) &lt;- arg.const</span></span>
<span id="cb259-16"><a href="congruence-between-independent-and-dependent-sses.html#cb259-16" tabindex="-1"></a>  <span class="co"># starting.point[&#39;q02&#39;] &lt;- get_item(CID8[i], &#39;par&#39;)[&#39;q02&#39;]</span></span>
<span id="cb259-17"><a href="congruence-between-independent-and-dependent-sses.html#cb259-17" tabindex="-1"></a>  <span class="co"># starting.point[&#39;q03&#39;] &lt;- get_item(CID8[i], &#39;par&#39;)[&#39;q01&#39;]</span></span>
<span id="cb259-18"><a href="congruence-between-independent-and-dependent-sses.html#cb259-18" tabindex="-1"></a>  COR8_C[[i]] <span class="ot">&lt;-</span> <span class="fu">find.mle</span>(lik.const, starting.point, <span class="at">method=</span><span class="st">&quot;subplex&quot;</span>, <span class="at">keep.func=</span>F, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span><span class="cn">TRUE</span>)</span>
<span id="cb259-19"><a href="congruence-between-independent-and-dependent-sses.html#cb259-19" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 4&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;</code></pre>
<p>Assessing the inferred parameters</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="congruence-between-independent-and-dependent-sses.html#cb261-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="congruence-between-independent-and-dependent-sses.html#cb263-1" tabindex="-1"></a><span class="fu">get_item</span>(CID8, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="congruence-between-independent-and-dependent-sses.html#cb265-1" tabindex="-1"></a><span class="fu">get_item</span>(COR8_C, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="congruence-between-independent-and-dependent-sses.html#cb267-1" tabindex="-1"></a><span class="fu">get_item</span>(COR8_C[<span class="dv">1</span>], <span class="st">&#39;par&#39;</span>)</span></code></pre></div>
<pre><code>##       lam000       lam444          mu0          q02 
## 0.0509438630 0.0509155136 0.0003102256 0.0075620757</code></pre>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="congruence-between-independent-and-dependent-sses.html#cb269-1" tabindex="-1"></a><span class="fu">pars_to_arrays</span>(COR8_C[[<span class="dv">1</span>]]<span class="sc">$</span>par.full, <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">reoder_lambdas</span>(., <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>, <span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>))</span></code></pre></div>
<pre><code>## $lam.tensor
## $lam.tensor$`1`
##            [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,] 0.05094386    0    0    0    0    0    0    0
## [2,] 0.00000000    0    0    0    0    0    0    0
## [3,] 0.00000000    0    0    0    0    0    0    0
## [4,] 0.00000000    0    0    0    0    0    0    0
## [5,] 0.00000000    0    0    0    0    0    0    0
## [6,] 0.00000000    0    0    0    0    0    0    0
## [7,] 0.00000000    0    0    0    0    0    0    0
## [8,] 0.00000000    0    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.05094386    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2]       [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0 0.00000000    0    0    0    0    0
## [2,]    0    0 0.00000000    0    0    0    0    0
## [3,]    0    0 0.05091551    0    0    0    0    0
## [4,]    0    0 0.00000000    0    0    0    0    0
## [5,]    0    0 0.00000000    0    0    0    0    0
## [6,]    0    0 0.00000000    0    0    0    0    0
## [7,]    0    0 0.00000000    0    0    0    0    0
## [8,]    0    0 0.00000000    0    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.05091551    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05094386    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.05094386    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6]       [,7] [,8]
## [1,]    0    0    0    0    0    0 0.00000000    0
## [2,]    0    0    0    0    0    0 0.00000000    0
## [3,]    0    0    0    0    0    0 0.00000000    0
## [4,]    0    0    0    0    0    0 0.00000000    0
## [5,]    0    0    0    0    0    0 0.00000000    0
## [6,]    0    0    0    0    0    0 0.00000000    0
## [7,]    0    0    0    0    0    0 0.05091551    0
## [8,]    0    0    0    0    0    0 0.00000000    0
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.05091551
## 
## 
## $mu
##          mu0          mu2          mu4          mu6          mu1          mu3          mu5          mu7 
## 0.0003102256 0.0003102256 0.0003102256 0.0003102256 0.0003102256 0.0003102256 0.0003102256 0.0003102256 
## 
## $Q
##              [,1]         [,2]         [,3]         [,4]         [,5]         [,6]         [,7]         [,8]
## [1,] -0.022686227  0.007562076  0.007562076  0.000000000  0.000000000  0.007562076  0.000000000  0.000000000
## [2,]  0.007562076 -0.022686227  0.000000000  0.007562076  0.007562076  0.000000000  0.000000000  0.000000000
## [3,]  0.007562076  0.000000000 -0.022686227  0.007562076  0.000000000  0.000000000  0.000000000  0.007562076
## [4,]  0.000000000  0.007562076  0.007562076 -0.022686227  0.000000000  0.000000000  0.007562076  0.000000000
## [5,]  0.000000000  0.007562076  0.000000000  0.000000000 -0.022686227  0.007562076  0.007562076  0.000000000
## [6,]  0.007562076  0.000000000  0.000000000  0.000000000  0.007562076 -0.022686227  0.000000000  0.007562076
## [7,]  0.000000000  0.000000000  0.000000000  0.007562076  0.007562076  0.000000000 -0.022686227  0.007562076
## [8,]  0.000000000  0.000000000  0.007562076  0.000000000  0.000000000  0.007562076  0.007562076 -0.022686227</code></pre>
</div>
<div id="cor8-nc" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> COR8-NC<a href="congruence-between-independent-and-dependent-sses.html#cor8-nc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="congruence-between-independent-and-dependent-sses.html#cb271-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb271-2"><a href="congruence-between-independent-and-dependent-sses.html#cb271-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 8L,</span>
<span id="cb271-3"><a href="congruence-between-independent-and-dependent-sses.html#cb271-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">list</span>(</span>
<span id="cb271-4"><a href="congruence-between-independent-and-dependent-sses.html#cb271-4" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb271-5"><a href="congruence-between-independent-and-dependent-sses.html#cb271-5" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb271-6"><a href="congruence-between-independent-and-dependent-sses.html#cb271-6" tabindex="-1"></a>  ))</span>
<span id="cb271-7"><a href="congruence-between-independent-and-dependent-sses.html#cb271-7" tabindex="-1"></a></span>
<span id="cb271-8"><a href="congruence-between-independent-and-dependent-sses.html#cb271-8" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb271-9"><a href="congruence-between-independent-and-dependent-sses.html#cb271-9" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb271-10"><a href="congruence-between-independent-and-dependent-sses.html#cb271-10" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">8</span>)</span>
<span id="cb271-11"><a href="congruence-between-independent-and-dependent-sses.html#cb271-11" tabindex="-1"></a><span class="co">#args</span></span>
<span id="cb271-12"><a href="congruence-between-independent-and-dependent-sses.html#cb271-12" tabindex="-1"></a><span class="co">#args$pars</span></span>
<span id="cb271-13"><a href="congruence-between-independent-and-dependent-sses.html#cb271-13" tabindex="-1"></a><span class="co">#length(args$pars)</span></span>
<span id="cb271-14"><a href="congruence-between-independent-and-dependent-sses.html#cb271-14" tabindex="-1"></a></span>
<span id="cb271-15"><a href="congruence-between-independent-and-dependent-sses.html#cb271-15" tabindex="-1"></a>pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb271-16"><a href="congruence-between-independent-and-dependent-sses.html#cb271-16" tabindex="-1"></a><span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb271-17"><a href="congruence-between-independent-and-dependent-sses.html#cb271-17" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam000&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb271-18"><a href="congruence-between-independent-and-dependent-sses.html#cb271-18" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam111&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb271-19"><a href="congruence-between-independent-and-dependent-sses.html#cb271-19" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam222&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb271-20"><a href="congruence-between-independent-and-dependent-sses.html#cb271-20" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam333&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb271-21"><a href="congruence-between-independent-and-dependent-sses.html#cb271-21" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam444&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb271-22"><a href="congruence-between-independent-and-dependent-sses.html#cb271-22" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam555&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb271-23"><a href="congruence-between-independent-and-dependent-sses.html#cb271-23" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam666&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb271-24"><a href="congruence-between-independent-and-dependent-sses.html#cb271-24" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam777&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb271-25"><a href="congruence-between-independent-and-dependent-sses.html#cb271-25" tabindex="-1"></a>pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu4&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu5&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu6&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu7&#39;</span>] <span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb271-26"><a href="congruence-between-independent-and-dependent-sses.html#cb271-26" tabindex="-1"></a>qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cor8_NC.r)</span>
<span id="cb271-27"><a href="congruence-between-independent-and-dependent-sses.html#cb271-27" tabindex="-1"></a>qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb271-28"><a href="congruence-between-independent-and-dependent-sses.html#cb271-28" tabindex="-1"></a>pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb271-29"><a href="congruence-between-independent-and-dependent-sses.html#cb271-29" tabindex="-1"></a></span>
<span id="cb271-30"><a href="congruence-between-independent-and-dependent-sses.html#cb271-30" tabindex="-1"></a><span class="co">#pars.hc</span></span>
<span id="cb271-31"><a href="congruence-between-independent-and-dependent-sses.html#cb271-31" tabindex="-1"></a><span class="co">#pars_to_arrays(pars.hc,8)</span></span>
<span id="cb271-32"><a href="congruence-between-independent-and-dependent-sses.html#cb271-32" tabindex="-1"></a><span class="co">#args</span></span>
<span id="cb271-33"><a href="congruence-between-independent-and-dependent-sses.html#cb271-33" tabindex="-1"></a></span>
<span id="cb271-34"><a href="congruence-between-independent-and-dependent-sses.html#cb271-34" tabindex="-1"></a>zero.constr <span class="ot">&lt;-</span> <span class="fu">formulas_zero_pars</span>(pars.hc)</span>
<span id="cb271-35"><a href="congruence-between-independent-and-dependent-sses.html#cb271-35" tabindex="-1"></a>f.qs <span class="ot">&lt;-</span> <span class="fu">assign_classes_pairwise</span>(Q_cor8_NC.r, args<span class="sc">$</span>arrays<span class="sc">$</span>Q)</span>
<span id="cb271-36"><a href="congruence-between-independent-and-dependent-sses.html#cb271-36" tabindex="-1"></a>f.mu <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1 <span class="sc">~</span> mu0, mu2 <span class="sc">~</span> mu0, mu3 <span class="sc">~</span> mu0, mu4 <span class="sc">~</span> mu0, mu5 <span class="sc">~</span> mu0, mu6 <span class="sc">~</span> mu0, mu7 <span class="sc">~</span> mu0)</span>
<span id="cb271-37"><a href="congruence-between-independent-and-dependent-sses.html#cb271-37" tabindex="-1"></a>f.lams <span class="ot">&lt;-</span> <span class="fu">c</span>(lam111 <span class="sc">~</span> lam000, lam222 <span class="sc">~</span> lam000, lam333 <span class="sc">~</span> lam000,   </span>
<span id="cb271-38"><a href="congruence-between-independent-and-dependent-sses.html#cb271-38" tabindex="-1"></a>            lam555 <span class="sc">~</span> lam444, lam666 <span class="sc">~</span> lam444, lam777 <span class="sc">~</span> lam444)</span>
<span id="cb271-39"><a href="congruence-between-independent-and-dependent-sses.html#cb271-39" tabindex="-1"></a>f.list<span class="ot">&lt;-</span> <span class="fu">c</span>(zero.constr,  f.qs, f.mu, f.lams)</span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="congruence-between-independent-and-dependent-sses.html#cb272-1" tabindex="-1"></a>COR8_NC <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb272-2"><a href="congruence-between-independent-and-dependent-sses.html#cb272-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb272-3"><a href="congruence-between-independent-and-dependent-sses.html#cb272-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSIM){</span>
<span id="cb272-4"><a href="congruence-between-independent-and-dependent-sses.html#cb272-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb272-5"><a href="congruence-between-independent-and-dependent-sses.html#cb272-5" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb272-6"><a href="congruence-between-independent-and-dependent-sses.html#cb272-6" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb272-7"><a href="congruence-between-independent-and-dependent-sses.html#cb272-7" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb272-8"><a href="congruence-between-independent-and-dependent-sses.html#cb272-8" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb272-9"><a href="congruence-between-independent-and-dependent-sses.html#cb272-9" tabindex="-1"></a>  </span>
<span id="cb272-10"><a href="congruence-between-independent-and-dependent-sses.html#cb272-10" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,  <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb272-11"><a href="congruence-between-independent-and-dependent-sses.html#cb272-11" tabindex="-1"></a>  lik.const <span class="ot">&lt;-</span> <span class="fu">constrain</span>(lik.c, <span class="at">formulae =</span> f.list)</span>
<span id="cb272-12"><a href="congruence-between-independent-and-dependent-sses.html#cb272-12" tabindex="-1"></a>  arg.const <span class="ot">&lt;-</span> <span class="fu">argnames</span>(lik.const)</span>
<span id="cb272-13"><a href="congruence-between-independent-and-dependent-sses.html#cb272-13" tabindex="-1"></a>  <span class="co"># starting.point &lt;- pars.hc[arg.const]</span></span>
<span id="cb272-14"><a href="congruence-between-independent-and-dependent-sses.html#cb272-14" tabindex="-1"></a>  starting.point <span class="ot">&lt;-</span> <span class="fu">get_item</span>(COR8_C[i], <span class="st">&#39;par&#39;</span>)</span>
<span id="cb272-15"><a href="congruence-between-independent-and-dependent-sses.html#cb272-15" tabindex="-1"></a>  COR8_NC[[i]] <span class="ot">&lt;-</span> <span class="fu">find.mle</span>(lik.const, starting.point, <span class="at">method=</span><span class="st">&quot;subplex&quot;</span>, <span class="at">keep.func=</span>F, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span><span class="cn">TRUE</span>)</span>
<span id="cb272-16"><a href="congruence-between-independent-and-dependent-sses.html#cb272-16" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 4&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;</code></pre>
<p>Assessing the inferred parameters</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="congruence-between-independent-and-dependent-sses.html#cb274-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="congruence-between-independent-and-dependent-sses.html#cb276-1" tabindex="-1"></a><span class="fu">get_item</span>(CID8, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="congruence-between-independent-and-dependent-sses.html#cb278-1" tabindex="-1"></a><span class="fu">get_item</span>(COR8_NC, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -439.3721 -428.0217 -411.3027 -421.3187 -422.2212 -416.0885 -435.6355 -428.1737 -422.4050 -398.2370</code></pre>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="congruence-between-independent-and-dependent-sses.html#cb280-1" tabindex="-1"></a><span class="fu">get_item</span>(CID8[<span class="dv">1</span>], <span class="st">&#39;par&#39;</span>)</span></code></pre></div>
<pre><code>##       lam000       lam444          mu0          q01 
## 0.0509438630 0.0509155136 0.0003102256 0.0075620757</code></pre>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="congruence-between-independent-and-dependent-sses.html#cb282-1" tabindex="-1"></a><span class="fu">pars_to_arrays</span>(COR8_NC[[<span class="dv">1</span>]]<span class="sc">$</span>par.full, <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">reoder_lambdas</span>(., <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>, <span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>))</span></code></pre></div>
<pre><code>## $lam.tensor
## $lam.tensor$`1`
##            [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,] 0.06507655    0    0    0    0    0    0    0
## [2,] 0.00000000    0    0    0    0    0    0    0
## [3,] 0.00000000    0    0    0    0    0    0    0
## [4,] 0.00000000    0    0    0    0    0    0    0
## [5,] 0.00000000    0    0    0    0    0    0    0
## [6,] 0.00000000    0    0    0    0    0    0    0
## [7,] 0.00000000    0    0    0    0    0    0    0
## [8,] 0.00000000    0    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.06507655    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2]         [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0 0.000000e+00    0    0    0    0    0
## [2,]    0    0 0.000000e+00    0    0    0    0    0
## [3,]    0    0 1.009869e-06    0    0    0    0    0
## [4,]    0    0 0.000000e+00    0    0    0    0    0
## [5,]    0    0 0.000000e+00    0    0    0    0    0
## [6,]    0    0 0.000000e+00    0    0    0    0    0
## [7,]    0    0 0.000000e+00    0    0    0    0    0
## [8,]    0    0 0.000000e+00    0    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]         [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.000000e+00    0    0    0    0
## [2,]    0    0    0 0.000000e+00    0    0    0    0
## [3,]    0    0    0 0.000000e+00    0    0    0    0
## [4,]    0    0    0 1.009869e-06    0    0    0    0
## [5,]    0    0    0 0.000000e+00    0    0    0    0
## [6,]    0    0    0 0.000000e+00    0    0    0    0
## [7,]    0    0    0 0.000000e+00    0    0    0    0
## [8,]    0    0    0 0.000000e+00    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.06507655    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.06507655    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6]         [,7] [,8]
## [1,]    0    0    0    0    0    0 0.000000e+00    0
## [2,]    0    0    0    0    0    0 0.000000e+00    0
## [3,]    0    0    0    0    0    0 0.000000e+00    0
## [4,]    0    0    0    0    0    0 0.000000e+00    0
## [5,]    0    0    0    0    0    0 0.000000e+00    0
## [6,]    0    0    0    0    0    0 0.000000e+00    0
## [7,]    0    0    0    0    0    0 1.009869e-06    0
## [8,]    0    0    0    0    0    0 0.000000e+00    0
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]         [,8]
## [1,]    0    0    0    0    0    0    0 0.000000e+00
## [2,]    0    0    0    0    0    0    0 0.000000e+00
## [3,]    0    0    0    0    0    0    0 0.000000e+00
## [4,]    0    0    0    0    0    0    0 0.000000e+00
## [5,]    0    0    0    0    0    0    0 0.000000e+00
## [6,]    0    0    0    0    0    0    0 0.000000e+00
## [7,]    0    0    0    0    0    0    0 0.000000e+00
## [8,]    0    0    0    0    0    0    0 1.009869e-06
## 
## 
## $mu
##         mu0         mu2         mu4         mu6         mu1         mu3         mu5         mu7 
## 0.002305683 0.002305683 0.002305683 0.002305683 0.002305683 0.002305683 0.002305683 0.002305683 
## 
## $Q
##             [,1]        [,2]        [,3]        [,4]        [,5]        [,6]        [,7]        [,8]
## [1,] -0.06100916  0.02033639  0.02033639  0.00000000  0.00000000  0.02033639  0.00000000  0.00000000
## [2,]  0.02033639 -0.04067278  0.00000000  0.02033639  0.00000000  0.00000000  0.00000000  0.00000000
## [3,]  0.02033639  0.00000000 -0.06100916  0.02033639  0.00000000  0.00000000  0.00000000  0.02033639
## [4,]  0.00000000  0.02033639  0.02033639 -0.04067278  0.00000000  0.00000000  0.00000000  0.00000000
## [5,]  0.00000000  0.02033639  0.00000000  0.00000000 -0.06100916  0.02033639  0.02033639  0.00000000
## [6,]  0.00000000  0.00000000  0.00000000  0.00000000  0.02033639 -0.04067278  0.00000000  0.02033639
## [7,]  0.00000000  0.00000000  0.00000000  0.02033639  0.02033639  0.00000000 -0.06100916  0.02033639
## [8,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.02033639  0.02033639 -0.04067278</code></pre>
</div>
<div id="cla8-c" class="section level3 hasAnchor" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> CLA8-C<a href="congruence-between-independent-and-dependent-sses.html#cla8-c" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="congruence-between-independent-and-dependent-sses.html#cb284-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb284-2"><a href="congruence-between-independent-and-dependent-sses.html#cb284-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 8L,</span>
<span id="cb284-3"><a href="congruence-between-independent-and-dependent-sses.html#cb284-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">list</span>(</span>
<span id="cb284-4"><a href="congruence-between-independent-and-dependent-sses.html#cb284-4" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb284-5"><a href="congruence-between-independent-and-dependent-sses.html#cb284-5" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb284-6"><a href="congruence-between-independent-and-dependent-sses.html#cb284-6" tabindex="-1"></a>  ))</span>
<span id="cb284-7"><a href="congruence-between-independent-and-dependent-sses.html#cb284-7" tabindex="-1"></a></span>
<span id="cb284-8"><a href="congruence-between-independent-and-dependent-sses.html#cb284-8" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb284-9"><a href="congruence-between-independent-and-dependent-sses.html#cb284-9" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb284-10"><a href="congruence-between-independent-and-dependent-sses.html#cb284-10" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">8</span>)</span>
<span id="cb284-11"><a href="congruence-between-independent-and-dependent-sses.html#cb284-11" tabindex="-1"></a><span class="co">#args</span></span>
<span id="cb284-12"><a href="congruence-between-independent-and-dependent-sses.html#cb284-12" tabindex="-1"></a><span class="co">#args$pars</span></span>
<span id="cb284-13"><a href="congruence-between-independent-and-dependent-sses.html#cb284-13" tabindex="-1"></a><span class="co">#length(args$pars)</span></span>
<span id="cb284-14"><a href="congruence-between-independent-and-dependent-sses.html#cb284-14" tabindex="-1"></a></span>
<span id="cb284-15"><a href="congruence-between-independent-and-dependent-sses.html#cb284-15" tabindex="-1"></a>pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb284-16"><a href="congruence-between-independent-and-dependent-sses.html#cb284-16" tabindex="-1"></a><span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb284-17"><a href="congruence-between-independent-and-dependent-sses.html#cb284-17" tabindex="-1"></a><span class="co"># pars.hc[&#39;lam000&#39;] &lt;- 0.1</span></span>
<span id="cb284-18"><a href="congruence-between-independent-and-dependent-sses.html#cb284-18" tabindex="-1"></a><span class="co"># pars.hc[&#39;lam111&#39;] &lt;- 0.1</span></span>
<span id="cb284-19"><a href="congruence-between-independent-and-dependent-sses.html#cb284-19" tabindex="-1"></a><span class="co"># pars.hc[&#39;lam222&#39;] &lt;- 0.1</span></span>
<span id="cb284-20"><a href="congruence-between-independent-and-dependent-sses.html#cb284-20" tabindex="-1"></a><span class="co"># pars.hc[&#39;lam333&#39;] &lt;- 0.1</span></span>
<span id="cb284-21"><a href="congruence-between-independent-and-dependent-sses.html#cb284-21" tabindex="-1"></a><span class="co"># pars.hc[&#39;lam444&#39;] &lt;- 0.05</span></span>
<span id="cb284-22"><a href="congruence-between-independent-and-dependent-sses.html#cb284-22" tabindex="-1"></a><span class="co"># pars.hc[&#39;lam555&#39;] &lt;- 0.05</span></span>
<span id="cb284-23"><a href="congruence-between-independent-and-dependent-sses.html#cb284-23" tabindex="-1"></a><span class="co"># pars.hc[&#39;lam666&#39;] &lt;- 0.05</span></span>
<span id="cb284-24"><a href="congruence-between-independent-and-dependent-sses.html#cb284-24" tabindex="-1"></a><span class="co"># pars.hc[&#39;lam777&#39;] &lt;- 0.05</span></span>
<span id="cb284-25"><a href="congruence-between-independent-and-dependent-sses.html#cb284-25" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam022&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb284-26"><a href="congruence-between-independent-and-dependent-sses.html#cb284-26" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam133&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb284-27"><a href="congruence-between-independent-and-dependent-sses.html#cb284-27" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam202&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb284-28"><a href="congruence-between-independent-and-dependent-sses.html#cb284-28" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam311&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb284-29"><a href="congruence-between-independent-and-dependent-sses.html#cb284-29" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam466&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb284-30"><a href="congruence-between-independent-and-dependent-sses.html#cb284-30" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam577&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb284-31"><a href="congruence-between-independent-and-dependent-sses.html#cb284-31" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam646&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb284-32"><a href="congruence-between-independent-and-dependent-sses.html#cb284-32" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam757&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb284-33"><a href="congruence-between-independent-and-dependent-sses.html#cb284-33" tabindex="-1"></a>pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu4&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu5&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu6&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu7&#39;</span>] <span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb284-34"><a href="congruence-between-independent-and-dependent-sses.html#cb284-34" tabindex="-1"></a>qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cor8_C.r)</span>
<span id="cb284-35"><a href="congruence-between-independent-and-dependent-sses.html#cb284-35" tabindex="-1"></a>qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb284-36"><a href="congruence-between-independent-and-dependent-sses.html#cb284-36" tabindex="-1"></a>pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb284-37"><a href="congruence-between-independent-and-dependent-sses.html#cb284-37" tabindex="-1"></a></span>
<span id="cb284-38"><a href="congruence-between-independent-and-dependent-sses.html#cb284-38" tabindex="-1"></a><span class="co">#pars.hc</span></span>
<span id="cb284-39"><a href="congruence-between-independent-and-dependent-sses.html#cb284-39" tabindex="-1"></a><span class="co">#pars_to_arrays(pars.hc,8)</span></span>
<span id="cb284-40"><a href="congruence-between-independent-and-dependent-sses.html#cb284-40" tabindex="-1"></a><span class="co">#args</span></span>
<span id="cb284-41"><a href="congruence-between-independent-and-dependent-sses.html#cb284-41" tabindex="-1"></a></span>
<span id="cb284-42"><a href="congruence-between-independent-and-dependent-sses.html#cb284-42" tabindex="-1"></a>zero.constr <span class="ot">&lt;-</span> <span class="fu">formulas_zero_pars</span>(pars.hc)</span>
<span id="cb284-43"><a href="congruence-between-independent-and-dependent-sses.html#cb284-43" tabindex="-1"></a>f.qs <span class="ot">&lt;-</span> <span class="fu">assign_classes_pairwise</span>(Q_cor8_C.r, args<span class="sc">$</span>arrays<span class="sc">$</span>Q)</span>
<span id="cb284-44"><a href="congruence-between-independent-and-dependent-sses.html#cb284-44" tabindex="-1"></a>f.mu <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1 <span class="sc">~</span> mu0, mu2 <span class="sc">~</span> mu0, mu3 <span class="sc">~</span> mu0, mu4 <span class="sc">~</span> mu0, mu5 <span class="sc">~</span> mu0, mu6 <span class="sc">~</span> mu0, mu7 <span class="sc">~</span> mu0)</span>
<span id="cb284-45"><a href="congruence-between-independent-and-dependent-sses.html#cb284-45" tabindex="-1"></a>f.lams <span class="ot">&lt;-</span> <span class="fu">c</span>(lam133 <span class="sc">~</span> lam022, lam202 <span class="sc">~</span> lam022, lam311 <span class="sc">~</span> lam022,   </span>
<span id="cb284-46"><a href="congruence-between-independent-and-dependent-sses.html#cb284-46" tabindex="-1"></a>            lam577 <span class="sc">~</span> lam466, lam646 <span class="sc">~</span> lam466, lam757 <span class="sc">~</span> lam466)</span>
<span id="cb284-47"><a href="congruence-between-independent-and-dependent-sses.html#cb284-47" tabindex="-1"></a>f.list<span class="ot">&lt;-</span> <span class="fu">c</span>(zero.constr,  f.qs, f.mu, f.lams)</span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="congruence-between-independent-and-dependent-sses.html#cb285-1" tabindex="-1"></a>CLA8_C <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb285-2"><a href="congruence-between-independent-and-dependent-sses.html#cb285-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb285-3"><a href="congruence-between-independent-and-dependent-sses.html#cb285-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSIM){</span>
<span id="cb285-4"><a href="congruence-between-independent-and-dependent-sses.html#cb285-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb285-5"><a href="congruence-between-independent-and-dependent-sses.html#cb285-5" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb285-6"><a href="congruence-between-independent-and-dependent-sses.html#cb285-6" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb285-7"><a href="congruence-between-independent-and-dependent-sses.html#cb285-7" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb285-8"><a href="congruence-between-independent-and-dependent-sses.html#cb285-8" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb285-9"><a href="congruence-between-independent-and-dependent-sses.html#cb285-9" tabindex="-1"></a>  </span>
<span id="cb285-10"><a href="congruence-between-independent-and-dependent-sses.html#cb285-10" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,  <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb285-11"><a href="congruence-between-independent-and-dependent-sses.html#cb285-11" tabindex="-1"></a>  lik.const <span class="ot">&lt;-</span> <span class="fu">constrain</span>(lik.c, <span class="at">formulae =</span> f.list)</span>
<span id="cb285-12"><a href="congruence-between-independent-and-dependent-sses.html#cb285-12" tabindex="-1"></a>  arg.const <span class="ot">&lt;-</span> <span class="fu">argnames</span>(lik.const)</span>
<span id="cb285-13"><a href="congruence-between-independent-and-dependent-sses.html#cb285-13" tabindex="-1"></a>  <span class="co">#starting.point &lt;- pars.hc[arg.const]</span></span>
<span id="cb285-14"><a href="congruence-between-independent-and-dependent-sses.html#cb285-14" tabindex="-1"></a>  starting.point <span class="ot">&lt;-</span> <span class="fu">get_item</span>(COR8_C[i], <span class="st">&#39;par&#39;</span>)</span>
<span id="cb285-15"><a href="congruence-between-independent-and-dependent-sses.html#cb285-15" tabindex="-1"></a>  <span class="fu">names</span>(starting.point) <span class="ot">&lt;-</span> arg.const</span>
<span id="cb285-16"><a href="congruence-between-independent-and-dependent-sses.html#cb285-16" tabindex="-1"></a>  CLA8_C[[i]] <span class="ot">&lt;-</span> <span class="fu">find.mle</span>(lik.const, starting.point, <span class="at">method=</span><span class="st">&quot;subplex&quot;</span>, <span class="at">keep.func=</span>F, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span><span class="cn">TRUE</span>)</span>
<span id="cb285-17"><a href="congruence-between-independent-and-dependent-sses.html#cb285-17" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 4&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;</code></pre>
<p>Assessing the inferred parameters</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="congruence-between-independent-and-dependent-sses.html#cb287-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="congruence-between-independent-and-dependent-sses.html#cb289-1" tabindex="-1"></a><span class="fu">get_item</span>(CLA8_C, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.9548 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7798 -429.2834 -421.0964 -397.1996</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="congruence-between-independent-and-dependent-sses.html#cb291-1" tabindex="-1"></a><span class="fu">get_item</span>(CID8[<span class="dv">1</span>], <span class="st">&#39;par&#39;</span>)</span></code></pre></div>
<pre><code>##       lam000       lam444          mu0          q01 
## 0.0509438630 0.0509155136 0.0003102256 0.0075620757</code></pre>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="congruence-between-independent-and-dependent-sses.html#cb293-1" tabindex="-1"></a><span class="fu">pars_to_arrays</span>(CLA8_C[[<span class="dv">1</span>]]<span class="sc">$</span>par.full, <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">reoder_lambdas</span>(., <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>, <span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>))</span></code></pre></div>
<pre><code>## $lam.tensor
## $lam.tensor$`1`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.05095631    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.05095631    0    0    0    0    0    0
## [2,]    0 0.00000000    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.05097545    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.05097545    0    0    0    0
## [4,]    0    0    0 0.00000000    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.05095631    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05095631    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.05097545
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.05097545
## [8,]    0    0    0    0    0    0    0 0.00000000
## 
## 
## $mu
##          mu0          mu2          mu4          mu6          mu1          mu3          mu5          mu7 
## 0.0003971397 0.0003971397 0.0003971397 0.0003971397 0.0003971397 0.0003971397 0.0003971397 0.0003971397 
## 
## $Q
##              [,1]         [,2]         [,3]         [,4]         [,5]         [,6]         [,7]         [,8]
## [1,] -0.022680368  0.007560123  0.007560123  0.000000000  0.000000000  0.007560123  0.000000000  0.000000000
## [2,]  0.007560123 -0.022680368  0.000000000  0.007560123  0.007560123  0.000000000  0.000000000  0.000000000
## [3,]  0.007560123  0.000000000 -0.022680368  0.007560123  0.000000000  0.000000000  0.000000000  0.007560123
## [4,]  0.000000000  0.007560123  0.007560123 -0.022680368  0.000000000  0.000000000  0.007560123  0.000000000
## [5,]  0.000000000  0.007560123  0.000000000  0.000000000 -0.022680368  0.007560123  0.007560123  0.000000000
## [6,]  0.007560123  0.000000000  0.000000000  0.000000000  0.007560123 -0.022680368  0.000000000  0.007560123
## [7,]  0.000000000  0.000000000  0.000000000  0.007560123  0.007560123  0.000000000 -0.022680368  0.007560123
## [8,]  0.000000000  0.000000000  0.007560123  0.000000000  0.000000000  0.007560123  0.007560123 -0.022680368</code></pre>
</div>
<div id="cla8-nc" class="section level3 hasAnchor" number="4.5.5">
<h3><span class="header-section-number">4.5.5</span> CLA8-NC<a href="congruence-between-independent-and-dependent-sses.html#cla8-nc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="congruence-between-independent-and-dependent-sses.html#cb295-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb295-2"><a href="congruence-between-independent-and-dependent-sses.html#cb295-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 8L,</span>
<span id="cb295-3"><a href="congruence-between-independent-and-dependent-sses.html#cb295-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">list</span>(</span>
<span id="cb295-4"><a href="congruence-between-independent-and-dependent-sses.html#cb295-4" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb295-5"><a href="congruence-between-independent-and-dependent-sses.html#cb295-5" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb295-6"><a href="congruence-between-independent-and-dependent-sses.html#cb295-6" tabindex="-1"></a>  ))</span>
<span id="cb295-7"><a href="congruence-between-independent-and-dependent-sses.html#cb295-7" tabindex="-1"></a></span>
<span id="cb295-8"><a href="congruence-between-independent-and-dependent-sses.html#cb295-8" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb295-9"><a href="congruence-between-independent-and-dependent-sses.html#cb295-9" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb295-10"><a href="congruence-between-independent-and-dependent-sses.html#cb295-10" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">8</span>)</span>
<span id="cb295-11"><a href="congruence-between-independent-and-dependent-sses.html#cb295-11" tabindex="-1"></a><span class="co">#args</span></span>
<span id="cb295-12"><a href="congruence-between-independent-and-dependent-sses.html#cb295-12" tabindex="-1"></a><span class="co">#args$pars</span></span>
<span id="cb295-13"><a href="congruence-between-independent-and-dependent-sses.html#cb295-13" tabindex="-1"></a><span class="co">#length(args$pars)</span></span>
<span id="cb295-14"><a href="congruence-between-independent-and-dependent-sses.html#cb295-14" tabindex="-1"></a></span>
<span id="cb295-15"><a href="congruence-between-independent-and-dependent-sses.html#cb295-15" tabindex="-1"></a>pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb295-16"><a href="congruence-between-independent-and-dependent-sses.html#cb295-16" tabindex="-1"></a><span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb295-17"><a href="congruence-between-independent-and-dependent-sses.html#cb295-17" tabindex="-1"></a><span class="co"># pars.hc[&#39;lam000&#39;] &lt;- 0.1</span></span>
<span id="cb295-18"><a href="congruence-between-independent-and-dependent-sses.html#cb295-18" tabindex="-1"></a><span class="co"># pars.hc[&#39;lam111&#39;] &lt;- 0.1</span></span>
<span id="cb295-19"><a href="congruence-between-independent-and-dependent-sses.html#cb295-19" tabindex="-1"></a><span class="co"># pars.hc[&#39;lam222&#39;] &lt;- 0.1</span></span>
<span id="cb295-20"><a href="congruence-between-independent-and-dependent-sses.html#cb295-20" tabindex="-1"></a><span class="co"># pars.hc[&#39;lam333&#39;] &lt;- 0.1</span></span>
<span id="cb295-21"><a href="congruence-between-independent-and-dependent-sses.html#cb295-21" tabindex="-1"></a><span class="co"># pars.hc[&#39;lam444&#39;] &lt;- 0.05</span></span>
<span id="cb295-22"><a href="congruence-between-independent-and-dependent-sses.html#cb295-22" tabindex="-1"></a><span class="co"># pars.hc[&#39;lam555&#39;] &lt;- 0.05</span></span>
<span id="cb295-23"><a href="congruence-between-independent-and-dependent-sses.html#cb295-23" tabindex="-1"></a><span class="co"># pars.hc[&#39;lam666&#39;] &lt;- 0.05</span></span>
<span id="cb295-24"><a href="congruence-between-independent-and-dependent-sses.html#cb295-24" tabindex="-1"></a><span class="co"># pars.hc[&#39;lam777&#39;] &lt;- 0.05</span></span>
<span id="cb295-25"><a href="congruence-between-independent-and-dependent-sses.html#cb295-25" tabindex="-1"></a><span class="co"># lam004, lam116, lam422 violate lumpability</span></span>
<span id="cb295-26"><a href="congruence-between-independent-and-dependent-sses.html#cb295-26" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam004&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb295-27"><a href="congruence-between-independent-and-dependent-sses.html#cb295-27" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam116&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb295-28"><a href="congruence-between-independent-and-dependent-sses.html#cb295-28" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam202&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb295-29"><a href="congruence-between-independent-and-dependent-sses.html#cb295-29" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam311&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb295-30"><a href="congruence-between-independent-and-dependent-sses.html#cb295-30" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam422&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb295-31"><a href="congruence-between-independent-and-dependent-sses.html#cb295-31" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam577&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb295-32"><a href="congruence-between-independent-and-dependent-sses.html#cb295-32" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam646&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb295-33"><a href="congruence-between-independent-and-dependent-sses.html#cb295-33" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam757&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb295-34"><a href="congruence-between-independent-and-dependent-sses.html#cb295-34" tabindex="-1"></a>pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu4&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu5&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu6&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu7&#39;</span>] <span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb295-35"><a href="congruence-between-independent-and-dependent-sses.html#cb295-35" tabindex="-1"></a>qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cor8_C.r)</span>
<span id="cb295-36"><a href="congruence-between-independent-and-dependent-sses.html#cb295-36" tabindex="-1"></a>qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb295-37"><a href="congruence-between-independent-and-dependent-sses.html#cb295-37" tabindex="-1"></a>pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb295-38"><a href="congruence-between-independent-and-dependent-sses.html#cb295-38" tabindex="-1"></a></span>
<span id="cb295-39"><a href="congruence-between-independent-and-dependent-sses.html#cb295-39" tabindex="-1"></a><span class="co">#pars.hc</span></span>
<span id="cb295-40"><a href="congruence-between-independent-and-dependent-sses.html#cb295-40" tabindex="-1"></a><span class="co">#pars_to_arrays(pars.hc,8)</span></span>
<span id="cb295-41"><a href="congruence-between-independent-and-dependent-sses.html#cb295-41" tabindex="-1"></a><span class="co">#args</span></span>
<span id="cb295-42"><a href="congruence-between-independent-and-dependent-sses.html#cb295-42" tabindex="-1"></a></span>
<span id="cb295-43"><a href="congruence-between-independent-and-dependent-sses.html#cb295-43" tabindex="-1"></a>zero.constr <span class="ot">&lt;-</span> <span class="fu">formulas_zero_pars</span>(pars.hc)</span>
<span id="cb295-44"><a href="congruence-between-independent-and-dependent-sses.html#cb295-44" tabindex="-1"></a>f.qs <span class="ot">&lt;-</span> <span class="fu">assign_classes_pairwise</span>(Q_cor8_C.r, args<span class="sc">$</span>arrays<span class="sc">$</span>Q)</span>
<span id="cb295-45"><a href="congruence-between-independent-and-dependent-sses.html#cb295-45" tabindex="-1"></a>f.mu <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1 <span class="sc">~</span> mu0, mu2 <span class="sc">~</span> mu0, mu3 <span class="sc">~</span> mu0, mu4 <span class="sc">~</span> mu0, mu5 <span class="sc">~</span> mu0, mu6 <span class="sc">~</span> mu0, mu7 <span class="sc">~</span> mu0)</span>
<span id="cb295-46"><a href="congruence-between-independent-and-dependent-sses.html#cb295-46" tabindex="-1"></a>f.lams <span class="ot">&lt;-</span> <span class="fu">c</span>(lam116 <span class="sc">~</span> lam004, lam202 <span class="sc">~</span> lam004, lam311 <span class="sc">~</span> lam004,   </span>
<span id="cb295-47"><a href="congruence-between-independent-and-dependent-sses.html#cb295-47" tabindex="-1"></a>            lam577 <span class="sc">~</span> lam422, lam646 <span class="sc">~</span> lam422, lam757 <span class="sc">~</span> lam422)</span>
<span id="cb295-48"><a href="congruence-between-independent-and-dependent-sses.html#cb295-48" tabindex="-1"></a>f.list<span class="ot">&lt;-</span> <span class="fu">c</span>(zero.constr,  f.qs, f.mu, f.lams)</span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="congruence-between-independent-and-dependent-sses.html#cb296-1" tabindex="-1"></a>CLA8_NC <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb296-2"><a href="congruence-between-independent-and-dependent-sses.html#cb296-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb296-3"><a href="congruence-between-independent-and-dependent-sses.html#cb296-3" tabindex="-1"></a><span class="co"># skip 4 as mle search gets stuck and R crushes</span></span>
<span id="cb296-4"><a href="congruence-between-independent-and-dependent-sses.html#cb296-4" tabindex="-1"></a>seq <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb296-5"><a href="congruence-between-independent-and-dependent-sses.html#cb296-5" tabindex="-1"></a>seq <span class="ot">&lt;-</span>seq[<span class="sc">-</span><span class="dv">4</span>]</span>
<span id="cb296-6"><a href="congruence-between-independent-and-dependent-sses.html#cb296-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> seq){</span>
<span id="cb296-7"><a href="congruence-between-independent-and-dependent-sses.html#cb296-7" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb296-8"><a href="congruence-between-independent-and-dependent-sses.html#cb296-8" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb296-9"><a href="congruence-between-independent-and-dependent-sses.html#cb296-9" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb296-10"><a href="congruence-between-independent-and-dependent-sses.html#cb296-10" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb296-11"><a href="congruence-between-independent-and-dependent-sses.html#cb296-11" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb296-12"><a href="congruence-between-independent-and-dependent-sses.html#cb296-12" tabindex="-1"></a>  </span>
<span id="cb296-13"><a href="congruence-between-independent-and-dependent-sses.html#cb296-13" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,  <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb296-14"><a href="congruence-between-independent-and-dependent-sses.html#cb296-14" tabindex="-1"></a>  lik.const <span class="ot">&lt;-</span> <span class="fu">constrain</span>(lik.c, <span class="at">formulae =</span> f.list)</span>
<span id="cb296-15"><a href="congruence-between-independent-and-dependent-sses.html#cb296-15" tabindex="-1"></a>  arg.const <span class="ot">&lt;-</span> <span class="fu">argnames</span>(lik.const)</span>
<span id="cb296-16"><a href="congruence-between-independent-and-dependent-sses.html#cb296-16" tabindex="-1"></a>  <span class="co">#starting.point &lt;- pars.hc[arg.const]</span></span>
<span id="cb296-17"><a href="congruence-between-independent-and-dependent-sses.html#cb296-17" tabindex="-1"></a>  starting.point <span class="ot">&lt;-</span> <span class="fu">get_item</span>(CLA8_C[i], <span class="st">&#39;par&#39;</span>)</span>
<span id="cb296-18"><a href="congruence-between-independent-and-dependent-sses.html#cb296-18" tabindex="-1"></a>  <span class="fu">names</span>(starting.point) <span class="ot">&lt;-</span> arg.const</span>
<span id="cb296-19"><a href="congruence-between-independent-and-dependent-sses.html#cb296-19" tabindex="-1"></a>  CLA8_NC[[i]] <span class="ot">&lt;-</span> <span class="fu">find.mle</span>(lik.const, starting.point, <span class="at">method=</span><span class="st">&quot;subplex&quot;</span>, <span class="at">keep.func=</span>F, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span><span class="cn">TRUE</span>)</span>
<span id="cb296-20"><a href="congruence-between-independent-and-dependent-sses.html#cb296-20" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 0000000010101010&quot;
## [1] &quot;Recoding: 0001 -&gt; 0000000001010101&quot;</code></pre>
<p>Assessing the inferred parameters</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="congruence-between-independent-and-dependent-sses.html#cb298-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="congruence-between-independent-and-dependent-sses.html#cb300-1" tabindex="-1"></a><span class="fu">get_item</span>(COR8_NC, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -439.3721 -428.0217 -411.3027 -421.3187 -422.2212 -416.0885 -435.6355 -428.1737 -422.4050 -398.2370</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="congruence-between-independent-and-dependent-sses.html#cb302-1" tabindex="-1"></a><span class="fu">get_item</span>(CLA8_NC, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>## [1] -428.8063 -423.3527 -407.0617 -417.3582 -411.1370 -427.4852 -424.7370 -416.0654 -394.4739</code></pre>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="congruence-between-independent-and-dependent-sses.html#cb304-1" tabindex="-1"></a><span class="fu">get_item</span>(CID8[<span class="dv">1</span>], <span class="st">&#39;par&#39;</span>)</span></code></pre></div>
<pre><code>##       lam000       lam444          mu0          q01 
## 0.0509438630 0.0509155136 0.0003102256 0.0075620757</code></pre>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="congruence-between-independent-and-dependent-sses.html#cb306-1" tabindex="-1"></a><span class="fu">pars_to_arrays</span>(CLA8_C[[<span class="dv">1</span>]]<span class="sc">$</span>par.full, <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">reoder_lambdas</span>(., <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>, <span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>))</span></code></pre></div>
<pre><code>## $lam.tensor
## $lam.tensor$`1`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.05095631    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.05095631    0    0    0    0    0    0
## [2,]    0 0.00000000    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.05097545    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.05097545    0    0    0    0
## [4,]    0    0    0 0.00000000    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.05095631    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05095631    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.05097545
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.05097545
## [8,]    0    0    0    0    0    0    0 0.00000000
## 
## 
## $mu
##          mu0          mu2          mu4          mu6          mu1          mu3          mu5          mu7 
## 0.0003971397 0.0003971397 0.0003971397 0.0003971397 0.0003971397 0.0003971397 0.0003971397 0.0003971397 
## 
## $Q
##              [,1]         [,2]         [,3]         [,4]         [,5]         [,6]         [,7]         [,8]
## [1,] -0.022680368  0.007560123  0.007560123  0.000000000  0.000000000  0.007560123  0.000000000  0.000000000
## [2,]  0.007560123 -0.022680368  0.000000000  0.007560123  0.007560123  0.000000000  0.000000000  0.000000000
## [3,]  0.007560123  0.000000000 -0.022680368  0.007560123  0.000000000  0.000000000  0.000000000  0.007560123
## [4,]  0.000000000  0.007560123  0.007560123 -0.022680368  0.000000000  0.000000000  0.007560123  0.000000000
## [5,]  0.000000000  0.007560123  0.000000000  0.000000000 -0.022680368  0.007560123  0.007560123  0.000000000
## [6,]  0.007560123  0.000000000  0.000000000  0.000000000  0.007560123 -0.022680368  0.000000000  0.007560123
## [7,]  0.000000000  0.000000000  0.000000000  0.007560123  0.007560123  0.000000000 -0.022680368  0.007560123
## [8,]  0.000000000  0.000000000  0.007560123  0.000000000  0.000000000  0.007560123  0.007560123 -0.022680368</code></pre>
</div>
</div>
<div id="results-1" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Results<a href="congruence-between-independent-and-dependent-sses.html#results-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="inferences-using-parameters-from-cid4-1" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Inferences using parameters from CID4<a href="congruence-between-independent-and-dependent-sses.html#inferences-using-parameters-from-cid4-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="likelihood-table-1" class="section level4 hasAnchor" number="4.6.1.1">
<h4><span class="header-section-number">4.6.1.1</span> Likelihood table<a href="congruence-between-independent-and-dependent-sses.html#likelihood-table-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="congruence-between-independent-and-dependent-sses.html#cb308-1" tabindex="-1"></a>cid4 <span class="ot">=</span> <span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span>
<span id="cb308-2"><a href="congruence-between-independent-and-dependent-sses.html#cb308-2" tabindex="-1"></a></span>
<span id="cb308-3"><a href="congruence-between-independent-and-dependent-sses.html#cb308-3" tabindex="-1"></a>cor.pars <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb308-4"><a href="congruence-between-independent-and-dependent-sses.html#cb308-4" tabindex="-1"></a><span class="st">&quot;N&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>NSIM),</span>
<span id="cb308-5"><a href="congruence-between-independent-and-dependent-sses.html#cb308-5" tabindex="-1"></a><span class="st">&quot;cid4&quot;</span> <span class="ot">=</span> cid4,</span>
<span id="cb308-6"><a href="congruence-between-independent-and-dependent-sses.html#cb308-6" tabindex="-1"></a><span class="st">&quot;CID8.pars&quot;</span><span class="ot">=</span> CID8.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb308-7"><a href="congruence-between-independent-and-dependent-sses.html#cb308-7" tabindex="-1"></a><span class="st">&quot;COR8-C.pars&quot;</span><span class="ot">=</span> COR8_C.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb308-8"><a href="congruence-between-independent-and-dependent-sses.html#cb308-8" tabindex="-1"></a><span class="st">&quot;CLA8-C.pars&quot;</span> <span class="ot">=</span> CLA8_C.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb308-9"><a href="congruence-between-independent-and-dependent-sses.html#cb308-9" tabindex="-1"></a><span class="st">&quot;COR8-NC.pars&quot;</span> <span class="ot">=</span> COR8_NC.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb308-10"><a href="congruence-between-independent-and-dependent-sses.html#cb308-10" tabindex="-1"></a><span class="st">&quot;CLA8-NC.pars&quot;</span> <span class="ot">=</span> CLA8_NC.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb308-11"><a href="congruence-between-independent-and-dependent-sses.html#cb308-11" tabindex="-1"></a>)</span>
<span id="cb308-12"><a href="congruence-between-independent-and-dependent-sses.html#cb308-12" tabindex="-1"></a></span>
<span id="cb308-13"><a href="congruence-between-independent-and-dependent-sses.html#cb308-13" tabindex="-1"></a><span class="fu">kable</span>(cor.pars, <span class="st">&quot;html&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb308-14"><a href="congruence-between-independent-and-dependent-sses.html#cb308-14" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>))</span></code></pre></div>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
cid4
</th>
<th style="text-align:right;">
CID8.pars
</th>
<th style="text-align:right;">
COR8-C.pars
</th>
<th style="text-align:right;">
CLA8-C.pars
</th>
<th style="text-align:right;">
COR8-NC.pars
</th>
<th style="text-align:right;">
CLA8-NC.pars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-438.9549
</td>
<td style="text-align:right;">
-438.9549
</td>
<td style="text-align:right;">
-438.9549
</td>
<td style="text-align:right;">
-438.9549
</td>
<td style="text-align:right;">
-442.1584
</td>
<td style="text-align:right;">
-432.3801
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-427.5105
</td>
<td style="text-align:right;">
-427.5105
</td>
<td style="text-align:right;">
-427.5105
</td>
<td style="text-align:right;">
-427.5105
</td>
<td style="text-align:right;">
-432.3652
</td>
<td style="text-align:right;">
-423.9786
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-410.6673
</td>
<td style="text-align:right;">
-410.6673
</td>
<td style="text-align:right;">
-410.6673
</td>
<td style="text-align:right;">
-410.6673
</td>
<td style="text-align:right;">
-414.2528
</td>
<td style="text-align:right;">
-407.2375
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-420.5590
</td>
<td style="text-align:right;">
-420.5590
</td>
<td style="text-align:right;">
-420.5590
</td>
<td style="text-align:right;">
-420.5590
</td>
<td style="text-align:right;">
-425.1997
</td>
<td style="text-align:right;">
-416.6835
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-421.6901
</td>
<td style="text-align:right;">
-421.6901
</td>
<td style="text-align:right;">
-421.6901
</td>
<td style="text-align:right;">
-421.6901
</td>
<td style="text-align:right;">
-424.8447
</td>
<td style="text-align:right;">
-427.4961
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-414.8487
</td>
<td style="text-align:right;">
-414.8487
</td>
<td style="text-align:right;">
-414.8487
</td>
<td style="text-align:right;">
-414.8487
</td>
<td style="text-align:right;">
-420.8153
</td>
<td style="text-align:right;">
-411.1675
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
-435.7799
</td>
<td style="text-align:right;">
-435.7799
</td>
<td style="text-align:right;">
-435.7799
</td>
<td style="text-align:right;">
-435.7799
</td>
<td style="text-align:right;">
-438.9214
</td>
<td style="text-align:right;">
-428.8506
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
-429.2834
</td>
<td style="text-align:right;">
-429.2834
</td>
<td style="text-align:right;">
-429.2834
</td>
<td style="text-align:right;">
-429.2834
</td>
<td style="text-align:right;">
-432.1182
</td>
<td style="text-align:right;">
-435.2936
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
-421.0965
</td>
<td style="text-align:right;">
-421.0965
</td>
<td style="text-align:right;">
-421.0965
</td>
<td style="text-align:right;">
-421.0965
</td>
<td style="text-align:right;">
-426.2918
</td>
<td style="text-align:right;">
-416.6131
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
-397.1996
</td>
<td style="text-align:right;">
-397.1996
</td>
<td style="text-align:right;">
-397.1996
</td>
<td style="text-align:right;">
-397.1996
</td>
<td style="text-align:right;">
-399.7270
</td>
<td style="text-align:right;">
-396.3307
</td>
</tr>
</tbody>
</table>
</div>
<div id="mean-absolute-error-1" class="section level4 hasAnchor" number="4.6.1.2">
<h4><span class="header-section-number">4.6.1.2</span> Mean absolute error<a href="congruence-between-independent-and-dependent-sses.html#mean-absolute-error-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="congruence-between-independent-and-dependent-sses.html#cb309-1" tabindex="-1"></a>dcor.pars <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb309-2"><a href="congruence-between-independent-and-dependent-sses.html#cb309-2" tabindex="-1"></a><span class="st">&quot;cid4&quot;</span> <span class="ot">=</span> cid4,</span>
<span id="cb309-3"><a href="congruence-between-independent-and-dependent-sses.html#cb309-3" tabindex="-1"></a><span class="st">&quot;CID8.pars&quot;</span><span class="ot">=</span> CID8.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb309-4"><a href="congruence-between-independent-and-dependent-sses.html#cb309-4" tabindex="-1"></a><span class="st">&quot;COR8-C.pars&quot;</span><span class="ot">=</span> COR8_C.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb309-5"><a href="congruence-between-independent-and-dependent-sses.html#cb309-5" tabindex="-1"></a><span class="st">&quot;CLA8-C.pars&quot;</span> <span class="ot">=</span> CLA8_C.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb309-6"><a href="congruence-between-independent-and-dependent-sses.html#cb309-6" tabindex="-1"></a><span class="st">&quot;COR8-NC.pars&quot;</span> <span class="ot">=</span> COR8_NC.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb309-7"><a href="congruence-between-independent-and-dependent-sses.html#cb309-7" tabindex="-1"></a><span class="st">&quot;CLA8-NC.pars&quot;</span> <span class="ot">=</span> CLA8_NC.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb309-8"><a href="congruence-between-independent-and-dependent-sses.html#cb309-8" tabindex="-1"></a>)</span>
<span id="cb309-9"><a href="congruence-between-independent-and-dependent-sses.html#cb309-9" tabindex="-1"></a>cid4t <span class="ot">&lt;-</span> cid4</span>
<span id="cb309-10"><a href="congruence-between-independent-and-dependent-sses.html#cb309-10" tabindex="-1"></a>dcor.pars <span class="ot">&lt;-</span> dcor.pars <span class="sc">%&gt;%</span></span>
<span id="cb309-11"><a href="congruence-between-independent-and-dependent-sses.html#cb309-11" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="sc">~</span> <span class="fu">abs</span>(cid4t <span class="sc">-</span> .) )</span>
<span id="cb309-12"><a href="congruence-between-independent-and-dependent-sses.html#cb309-12" tabindex="-1"></a></span>
<span id="cb309-13"><a href="congruence-between-independent-and-dependent-sses.html#cb309-13" tabindex="-1"></a>column_means <span class="ot">&lt;-</span> dcor.pars <span class="sc">%&gt;%</span></span>
<span id="cb309-14"><a href="congruence-between-independent-and-dependent-sses.html#cb309-14" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="sc">~</span> <span class="fu">mean</span>(.))</span>
<span id="cb309-15"><a href="congruence-between-independent-and-dependent-sses.html#cb309-15" tabindex="-1"></a></span>
<span id="cb309-16"><a href="congruence-between-independent-and-dependent-sses.html#cb309-16" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb309-17"><a href="congruence-between-independent-and-dependent-sses.html#cb309-17" tabindex="-1"></a>delta_values <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb309-18"><a href="congruence-between-independent-and-dependent-sses.html#cb309-18" tabindex="-1"></a>  <span class="at">Delta =</span> <span class="fu">names</span>(column_means),</span>
<span id="cb309-19"><a href="congruence-between-independent-and-dependent-sses.html#cb309-19" tabindex="-1"></a>  <span class="at">Value =</span> column_means <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb309-20"><a href="congruence-between-independent-and-dependent-sses.html#cb309-20" tabindex="-1"></a>)</span>
<span id="cb309-21"><a href="congruence-between-independent-and-dependent-sses.html#cb309-21" tabindex="-1"></a></span>
<span id="cb309-22"><a href="congruence-between-independent-and-dependent-sses.html#cb309-22" tabindex="-1"></a><span class="fu">kable</span>(column_means, <span class="st">&quot;html&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb309-23"><a href="congruence-between-independent-and-dependent-sses.html#cb309-23" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>))</span></code></pre></div>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cid4
</th>
<th style="text-align:right;">
CID8.pars
</th>
<th style="text-align:right;">
COR8-C.pars
</th>
<th style="text-align:right;">
CLA8-C.pars
</th>
<th style="text-align:right;">
COR8-NC.pars
</th>
<th style="text-align:right;">
CLA8-NC.pars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3.910447
</td>
<td style="text-align:right;">
4.519079
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="congruence-between-independent-and-dependent-sses.html#cb310-1" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb310-2"><a href="congruence-between-independent-and-dependent-sses.html#cb310-2" tabindex="-1"></a><span class="fu">ggplot</span>(delta_values, <span class="fu">aes</span>(<span class="at">x =</span> Delta, <span class="at">y =</span> Value, <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.2e&quot;</span>, Value))) <span class="sc">+</span></span>
<span id="cb310-3"><a href="congruence-between-independent-and-dependent-sses.html#cb310-3" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>,  <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb310-4"><a href="congruence-between-independent-and-dependent-sses.html#cb310-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">angle =</span> <span class="dv">45</span>) <span class="sc">+</span></span>
<span id="cb310-5"><a href="congruence-between-independent-and-dependent-sses.html#cb310-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Comparison of Ln Differences&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Deltas&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Magnitude&quot;</span>) <span class="sc">+</span></span>
<span id="cb310-6"><a href="congruence-between-independent-and-dependent-sses.html#cb310-6" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
</div>
</div>
<div id="maximum-likelihood-estimates" class="section level3 hasAnchor" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Maximum Likelihood estimates<a href="congruence-between-independent-and-dependent-sses.html#maximum-likelihood-estimates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="likelihood-table-2" class="section level4 hasAnchor" number="4.6.2.1">
<h4><span class="header-section-number">4.6.2.1</span> Likelihood table<a href="congruence-between-independent-and-dependent-sses.html#likelihood-table-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="congruence-between-independent-and-dependent-sses.html#cb311-1" tabindex="-1"></a>cor.pars <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb311-2"><a href="congruence-between-independent-and-dependent-sses.html#cb311-2" tabindex="-1"></a><span class="st">&quot;N&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>NSIM),</span>
<span id="cb311-3"><a href="congruence-between-independent-and-dependent-sses.html#cb311-3" tabindex="-1"></a><span class="st">&quot;cid4&quot;</span> <span class="ot">=</span> cid4,</span>
<span id="cb311-4"><a href="congruence-between-independent-and-dependent-sses.html#cb311-4" tabindex="-1"></a><span class="st">&quot;CID8&quot;</span><span class="ot">=</span> <span class="fu">get_item</span>(CID8, <span class="st">&#39;lnLik&#39;</span>),</span>
<span id="cb311-5"><a href="congruence-between-independent-and-dependent-sses.html#cb311-5" tabindex="-1"></a><span class="st">&quot;COR8-C&quot;</span><span class="ot">=</span> <span class="fu">get_item</span>(COR8_C, <span class="st">&#39;lnLik&#39;</span>),</span>
<span id="cb311-6"><a href="congruence-between-independent-and-dependent-sses.html#cb311-6" tabindex="-1"></a><span class="st">&quot;CLA8-C&quot;</span> <span class="ot">=</span> <span class="fu">get_item</span>(CLA8_C, <span class="st">&#39;lnLik&#39;</span>),</span>
<span id="cb311-7"><a href="congruence-between-independent-and-dependent-sses.html#cb311-7" tabindex="-1"></a><span class="st">&quot;COR8-NC&quot;</span> <span class="ot">=</span> <span class="fu">get_item</span>(COR8_NC, <span class="st">&#39;lnLik&#39;</span>),</span>
<span id="cb311-8"><a href="congruence-between-independent-and-dependent-sses.html#cb311-8" tabindex="-1"></a><span class="st">&quot;CLA8-NC&quot;</span> <span class="ot">=</span> <span class="fu">append</span>(<span class="fu">get_item</span>(CLA8_NC, <span class="st">&#39;lnLik&#39;</span>), <span class="cn">NA</span>, <span class="at">after=</span><span class="dv">3</span>),</span>
<span id="cb311-9"><a href="congruence-between-independent-and-dependent-sses.html#cb311-9" tabindex="-1"></a>)</span>
<span id="cb311-10"><a href="congruence-between-independent-and-dependent-sses.html#cb311-10" tabindex="-1"></a></span>
<span id="cb311-11"><a href="congruence-between-independent-and-dependent-sses.html#cb311-11" tabindex="-1"></a><span class="fu">kable</span>(cor.pars, <span class="st">&quot;html&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb311-12"><a href="congruence-between-independent-and-dependent-sses.html#cb311-12" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>))</span></code></pre></div>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
cid4
</th>
<th style="text-align:right;">
CID8
</th>
<th style="text-align:right;">
COR8-C
</th>
<th style="text-align:right;">
CLA8-C
</th>
<th style="text-align:right;">
COR8-NC
</th>
<th style="text-align:right;">
CLA8-NC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-438.9549
</td>
<td style="text-align:right;">
-438.9549
</td>
<td style="text-align:right;">
-438.9549
</td>
<td style="text-align:right;">
-438.9548
</td>
<td style="text-align:right;">
-439.3721
</td>
<td style="text-align:right;">
-428.8063
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-427.5105
</td>
<td style="text-align:right;">
-427.5105
</td>
<td style="text-align:right;">
-427.5105
</td>
<td style="text-align:right;">
-427.5105
</td>
<td style="text-align:right;">
-428.0217
</td>
<td style="text-align:right;">
-423.3527
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-410.6673
</td>
<td style="text-align:right;">
-410.6673
</td>
<td style="text-align:right;">
-410.6673
</td>
<td style="text-align:right;">
-410.6673
</td>
<td style="text-align:right;">
-411.3027
</td>
<td style="text-align:right;">
-407.0617
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-420.5590
</td>
<td style="text-align:right;">
-420.5590
</td>
<td style="text-align:right;">
-420.5590
</td>
<td style="text-align:right;">
-420.5590
</td>
<td style="text-align:right;">
-421.3187
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-421.6901
</td>
<td style="text-align:right;">
-421.6901
</td>
<td style="text-align:right;">
-421.6901
</td>
<td style="text-align:right;">
-421.6901
</td>
<td style="text-align:right;">
-422.2212
</td>
<td style="text-align:right;">
-417.3582
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-414.8487
</td>
<td style="text-align:right;">
-414.8487
</td>
<td style="text-align:right;">
-414.8487
</td>
<td style="text-align:right;">
-414.8487
</td>
<td style="text-align:right;">
-416.0885
</td>
<td style="text-align:right;">
-411.1370
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
-435.7799
</td>
<td style="text-align:right;">
-435.7799
</td>
<td style="text-align:right;">
-435.7799
</td>
<td style="text-align:right;">
-435.7798
</td>
<td style="text-align:right;">
-435.6355
</td>
<td style="text-align:right;">
-427.4852
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
-429.2834
</td>
<td style="text-align:right;">
-429.2834
</td>
<td style="text-align:right;">
-429.2834
</td>
<td style="text-align:right;">
-429.2834
</td>
<td style="text-align:right;">
-428.1737
</td>
<td style="text-align:right;">
-424.7370
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
-421.0965
</td>
<td style="text-align:right;">
-421.0965
</td>
<td style="text-align:right;">
-421.0965
</td>
<td style="text-align:right;">
-421.0964
</td>
<td style="text-align:right;">
-422.4050
</td>
<td style="text-align:right;">
-416.0654
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
-397.1996
</td>
<td style="text-align:right;">
-397.1996
</td>
<td style="text-align:right;">
-397.1996
</td>
<td style="text-align:right;">
-397.1996
</td>
<td style="text-align:right;">
-398.2370
</td>
<td style="text-align:right;">
-394.4739
</td>
</tr>
</tbody>
</table>
</div>
<div id="mean-absolute-error-2" class="section level4 hasAnchor" number="4.6.2.2">
<h4><span class="header-section-number">4.6.2.2</span> Mean absolute error<a href="congruence-between-independent-and-dependent-sses.html#mean-absolute-error-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="congruence-between-independent-and-dependent-sses.html#cb312-1" tabindex="-1"></a>dcor.pars <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb312-2"><a href="congruence-between-independent-and-dependent-sses.html#cb312-2" tabindex="-1"></a><span class="st">&quot;cid4&quot;</span> <span class="ot">=</span> cid4,</span>
<span id="cb312-3"><a href="congruence-between-independent-and-dependent-sses.html#cb312-3" tabindex="-1"></a><span class="st">&quot;CID8&quot;</span><span class="ot">=</span> <span class="fu">get_item</span>(CID8, <span class="st">&#39;lnLik&#39;</span>),</span>
<span id="cb312-4"><a href="congruence-between-independent-and-dependent-sses.html#cb312-4" tabindex="-1"></a><span class="st">&quot;COR8-C&quot;</span><span class="ot">=</span> <span class="fu">get_item</span>(COR8_C, <span class="st">&#39;lnLik&#39;</span>),</span>
<span id="cb312-5"><a href="congruence-between-independent-and-dependent-sses.html#cb312-5" tabindex="-1"></a><span class="st">&quot;CLA8-C&quot;</span> <span class="ot">=</span> <span class="fu">get_item</span>(CLA8_C, <span class="st">&#39;lnLik&#39;</span>),</span>
<span id="cb312-6"><a href="congruence-between-independent-and-dependent-sses.html#cb312-6" tabindex="-1"></a><span class="st">&quot;COR8-NC&quot;</span> <span class="ot">=</span> <span class="fu">get_item</span>(COR8_NC, <span class="st">&#39;lnLik&#39;</span>),</span>
<span id="cb312-7"><a href="congruence-between-independent-and-dependent-sses.html#cb312-7" tabindex="-1"></a><span class="st">&quot;CLA8-NC&quot;</span> <span class="ot">=</span> <span class="fu">append</span>(<span class="fu">get_item</span>(CLA8_NC, <span class="st">&#39;lnLik&#39;</span>), <span class="cn">NA</span>, <span class="at">after=</span><span class="dv">3</span>),</span>
<span id="cb312-8"><a href="congruence-between-independent-and-dependent-sses.html#cb312-8" tabindex="-1"></a>)</span>
<span id="cb312-9"><a href="congruence-between-independent-and-dependent-sses.html#cb312-9" tabindex="-1"></a></span>
<span id="cb312-10"><a href="congruence-between-independent-and-dependent-sses.html#cb312-10" tabindex="-1"></a><span class="co"># dcor.pars &lt;- tibble(</span></span>
<span id="cb312-11"><a href="congruence-between-independent-and-dependent-sses.html#cb312-11" tabindex="-1"></a><span class="co"># &quot;cid4&quot; = cid4,</span></span>
<span id="cb312-12"><a href="congruence-between-independent-and-dependent-sses.html#cb312-12" tabindex="-1"></a><span class="co"># &quot;CID8.pars&quot;= CID8.pars %&gt;% unlist,</span></span>
<span id="cb312-13"><a href="congruence-between-independent-and-dependent-sses.html#cb312-13" tabindex="-1"></a><span class="co"># &quot;COR8-C.pars&quot;= COR8_C.pars %&gt;% unlist,</span></span>
<span id="cb312-14"><a href="congruence-between-independent-and-dependent-sses.html#cb312-14" tabindex="-1"></a><span class="co"># &quot;CLA8-C.pars&quot; = CLA8_C.pars %&gt;% unlist,</span></span>
<span id="cb312-15"><a href="congruence-between-independent-and-dependent-sses.html#cb312-15" tabindex="-1"></a><span class="co"># &quot;COR8-NC.pars&quot; = COR8_NC.pars %&gt;% unlist,</span></span>
<span id="cb312-16"><a href="congruence-between-independent-and-dependent-sses.html#cb312-16" tabindex="-1"></a><span class="co"># &quot;CLA8-NC.pars&quot; = CLA8_NC.pars %&gt;% unlist,</span></span>
<span id="cb312-17"><a href="congruence-between-independent-and-dependent-sses.html#cb312-17" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb312-18"><a href="congruence-between-independent-and-dependent-sses.html#cb312-18" tabindex="-1"></a>cid4t <span class="ot">&lt;-</span> cid4</span>
<span id="cb312-19"><a href="congruence-between-independent-and-dependent-sses.html#cb312-19" tabindex="-1"></a>dcor.pars <span class="ot">&lt;-</span> dcor.pars <span class="sc">%&gt;%</span></span>
<span id="cb312-20"><a href="congruence-between-independent-and-dependent-sses.html#cb312-20" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="sc">~</span> <span class="fu">abs</span>(cid4t <span class="sc">-</span> .) )</span>
<span id="cb312-21"><a href="congruence-between-independent-and-dependent-sses.html#cb312-21" tabindex="-1"></a></span>
<span id="cb312-22"><a href="congruence-between-independent-and-dependent-sses.html#cb312-22" tabindex="-1"></a>column_means <span class="ot">&lt;-</span> dcor.pars <span class="sc">%&gt;%</span></span>
<span id="cb312-23"><a href="congruence-between-independent-and-dependent-sses.html#cb312-23" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="sc">~</span> <span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb312-24"><a href="congruence-between-independent-and-dependent-sses.html#cb312-24" tabindex="-1"></a></span>
<span id="cb312-25"><a href="congruence-between-independent-and-dependent-sses.html#cb312-25" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb312-26"><a href="congruence-between-independent-and-dependent-sses.html#cb312-26" tabindex="-1"></a>delta_values <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb312-27"><a href="congruence-between-independent-and-dependent-sses.html#cb312-27" tabindex="-1"></a>  <span class="at">Delta =</span> <span class="fu">names</span>(column_means),</span>
<span id="cb312-28"><a href="congruence-between-independent-and-dependent-sses.html#cb312-28" tabindex="-1"></a>  <span class="at">Value =</span> column_means <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb312-29"><a href="congruence-between-independent-and-dependent-sses.html#cb312-29" tabindex="-1"></a>)</span>
<span id="cb312-30"><a href="congruence-between-independent-and-dependent-sses.html#cb312-30" tabindex="-1"></a></span>
<span id="cb312-31"><a href="congruence-between-independent-and-dependent-sses.html#cb312-31" tabindex="-1"></a><span class="fu">kable</span>(column_means, <span class="st">&quot;html&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb312-32"><a href="congruence-between-independent-and-dependent-sses.html#cb312-32" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>))</span></code></pre></div>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cid4
</th>
<th style="text-align:right;">
CID8
</th>
<th style="text-align:right;">
COR8-C
</th>
<th style="text-align:right;">
CLA8-C
</th>
<th style="text-align:right;">
COR8-NC
</th>
<th style="text-align:right;">
CLA8-NC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2.19e-05
</td>
<td style="text-align:right;">
0.7694592
</td>
<td style="text-align:right;">
5.172621
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="congruence-between-independent-and-dependent-sses.html#cb313-1" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb313-2"><a href="congruence-between-independent-and-dependent-sses.html#cb313-2" tabindex="-1"></a><span class="fu">ggplot</span>(delta_values, <span class="fu">aes</span>(<span class="at">x =</span> Delta, <span class="at">y =</span> Value, <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.2e&quot;</span>, Value))) <span class="sc">+</span></span>
<span id="cb313-3"><a href="congruence-between-independent-and-dependent-sses.html#cb313-3" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>,  <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb313-4"><a href="congruence-between-independent-and-dependent-sses.html#cb313-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">angle =</span> <span class="dv">45</span>) <span class="sc">+</span></span>
<span id="cb313-5"><a href="congruence-between-independent-and-dependent-sses.html#cb313-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Comparison of Ln Differences&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Deltas&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Magnitude&quot;</span>) <span class="sc">+</span></span>
<span id="cb313-6"><a href="congruence-between-independent-and-dependent-sses.html#cb313-6" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="misse-congruence.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="equal-rate-hidden-expansion-ehe.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
