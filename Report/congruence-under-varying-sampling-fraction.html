<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Congruence under varying Sampling Fraction | Report for Simulations using HiClaSSE model</title>
  <meta name="description" content="7 Congruence under varying Sampling Fraction | Report for Simulations using HiClaSSE model" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Congruence under varying Sampling Fraction | Report for Simulations using HiClaSSE model" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Congruence under varying Sampling Fraction | Report for Simulations using HiClaSSE model" />
  
  
  

<meta name="author" content="Sergei Tarasov" />


<meta name="date" content="2024-02-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="semi-congruent-behavior.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Setting-up HiClaSSE</a></li>
<li class="chapter" data-level="2" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html"><i class="fa fa-check"></i><b>2</b> Validation of HiClaSSE</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#make-data"><i class="fa fa-check"></i><b>2.0.1</b> Make data</a></li>
<li class="chapter" data-level="2.1" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#bisse-ness-and-hiclasse"><i class="fa fa-check"></i><b>2.1</b> BiSSE-ness and HiClaSSE</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#bisse-ness-likelihood"><i class="fa fa-check"></i><b>2.1.1</b> BiSSE-ness Likelihood</a></li>
<li class="chapter" data-level="2.1.2" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#hiclasse2-likelihood"><i class="fa fa-check"></i><b>2.1.2</b> HiClaSSE2 Likelihood</a></li>
<li class="chapter" data-level="2.1.3" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#compare-models"><i class="fa fa-check"></i><b>2.1.3</b> Compare models</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#bisse-and-hiclasse"><i class="fa fa-check"></i><b>2.2</b> BiSSE and HiClaSSE</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#bisse"><i class="fa fa-check"></i><b>2.2.1</b> BiSSE</a></li>
<li class="chapter" data-level="2.2.2" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#hiclasse2"><i class="fa fa-check"></i><b>2.2.2</b> HiClaSSE2</a></li>
<li class="chapter" data-level="2.2.3" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#compare-models-1"><i class="fa fa-check"></i><b>2.2.3</b> Compare models</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#hisse4-and-hiclasse4"><i class="fa fa-check"></i><b>2.3</b> HiSSE4 and HiClaSSE4</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#hiclasse4"><i class="fa fa-check"></i><b>2.3.1</b> HiClaSSE4</a></li>
<li class="chapter" data-level="2.3.2" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#hisse4"><i class="fa fa-check"></i><b>2.3.2</b> HiSSE4</a></li>
<li class="chapter" data-level="2.3.3" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#compare-models-2"><i class="fa fa-check"></i><b>2.3.3</b> Compare models</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#sampling-fraction-bisse-ness-and-hiclasse"><i class="fa fa-check"></i><b>2.4</b> Sampling fraction: BiSSE-ness and HiClaSSE</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#bisse-ness-likelihood-1"><i class="fa fa-check"></i><b>2.4.1</b> BiSSE-ness Likelihood</a></li>
<li class="chapter" data-level="2.4.2" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#hiclasse2-likelihood-1"><i class="fa fa-check"></i><b>2.4.2</b> HiClaSSE2 Likelihood</a></li>
<li class="chapter" data-level="2.4.3" data-path="validation-of-hiclasse.html"><a href="validation-of-hiclasse.html#compare-models-3"><i class="fa fa-check"></i><b>2.4.3</b> Compare models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="misse-congruence.html"><a href="misse-congruence.html"><i class="fa fa-check"></i><b>3</b> MiSSE Congruence</a>
<ul>
<li class="chapter" data-level="3.1" data-path="misse-congruence.html"><a href="misse-congruence.html#set-up-q-matrix-for-inference"><i class="fa fa-check"></i><b>3.1</b> SET-UP Q matrix for inference</a></li>
<li class="chapter" data-level="3.2" data-path="misse-congruence.html"><a href="misse-congruence.html#misse-2"><i class="fa fa-check"></i><b>3.2</b> MiSSE-2</a></li>
<li class="chapter" data-level="3.3" data-path="misse-congruence.html"><a href="misse-congruence.html#misse-3-congruent"><i class="fa fa-check"></i><b>3.3</b> MiSSE-3 Congruent</a></li>
<li class="chapter" data-level="3.4" data-path="misse-congruence.html"><a href="misse-congruence.html#misse-3-congruent-inferred-pars"><i class="fa fa-check"></i><b>3.4</b> MiSSE-3 Congruent, Inferred Pars</a></li>
<li class="chapter" data-level="3.5" data-path="misse-congruence.html"><a href="misse-congruence.html#misse-3-non-congruent"><i class="fa fa-check"></i><b>3.5</b> MiSSE-3 Non-congruent</a></li>
<li class="chapter" data-level="3.6" data-path="misse-congruence.html"><a href="misse-congruence.html#another-non-congruent-models"><i class="fa fa-check"></i><b>3.6</b> Another Non-congruent Models</a></li>
<li class="chapter" data-level="3.7" data-path="misse-congruence.html"><a href="misse-congruence.html#zero-extinction"><i class="fa fa-check"></i><b>3.7</b> Zero Extinction</a></li>
<li class="chapter" data-level="3.8" data-path="misse-congruence.html"><a href="misse-congruence.html#results"><i class="fa fa-check"></i><b>3.8</b> Results</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="misse-congruence.html"><a href="misse-congruence.html#likelihood-table"><i class="fa fa-check"></i><b>3.8.1</b> Likelihood table</a></li>
<li class="chapter" data-level="3.8.2" data-path="misse-congruence.html"><a href="misse-congruence.html#mean-absolute-error"><i class="fa fa-check"></i><b>3.8.2</b> Mean absolute error</a></li>
<li class="chapter" data-level="3.8.3" data-path="misse-congruence.html"><a href="misse-congruence.html#parameter-estimates"><i class="fa fa-check"></i><b>3.8.3</b> Parameter estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html"><i class="fa fa-check"></i><b>4</b> Congruence between independent and dependent SSEs</a>
<ul>
<li class="chapter" data-level="4.1" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#read-in-data"><i class="fa fa-check"></i><b>4.1</b> Read in data</a></li>
<li class="chapter" data-level="4.2" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#setting-up-q-matrices-for-inference"><i class="fa fa-check"></i><b>4.2</b> Setting-up Q matrices for inference</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cid4"><i class="fa fa-check"></i><b>4.2.1</b> CID4</a></li>
<li class="chapter" data-level="4.2.2" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cid8-congruent-to-cid4"><i class="fa fa-check"></i><b>4.2.2</b> CID8 (congruent to CID4)</a></li>
<li class="chapter" data-level="4.2.3" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cor8-c-correlated-evolution-congruent-to-cid4"><i class="fa fa-check"></i><b>4.2.3</b> COR8-C (correlated evolution, congruent to CID4)</a></li>
<li class="chapter" data-level="4.2.4" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cor8-nc-non-correlated-evolution-congruent-to-cid4"><i class="fa fa-check"></i><b>4.2.4</b> COR8-NC (Non-correlated evolution, congruent to CID4)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#irreducible-model"><i class="fa fa-check"></i><b>4.3</b> Irreducible model</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cid4-4-pars"><i class="fa fa-check"></i><b>4.3.1</b> CID4 (4 pars)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#inferences-using-parameters-from-cid4"><i class="fa fa-check"></i><b>4.4</b> Inferences using parameters from CID4</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cid8-4-pars"><i class="fa fa-check"></i><b>4.4.1</b> CID8 (4 pars)</a></li>
<li class="chapter" data-level="4.4.2" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cor8-c-4-pars"><i class="fa fa-check"></i><b>4.4.2</b> COR8-C (4 pars)</a></li>
<li class="chapter" data-level="4.4.3" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cor8-nc-4-pars"><i class="fa fa-check"></i><b>4.4.3</b> COR8-NC (4 pars)</a></li>
<li class="chapter" data-level="4.4.4" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cla8-c-4-pars"><i class="fa fa-check"></i><b>4.4.4</b> CLA8-C (4 pars)</a></li>
<li class="chapter" data-level="4.4.5" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cla8-nc-4-pars"><i class="fa fa-check"></i><b>4.4.5</b> CLA8-NC (4 pars)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#maximum-likelihood.-all-models-have-4-pars."><i class="fa fa-check"></i><b>4.5</b> Maximum Likelihood. All models have 4 pars.</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cid8"><i class="fa fa-check"></i><b>4.5.1</b> CID8</a></li>
<li class="chapter" data-level="4.5.2" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cor8-c"><i class="fa fa-check"></i><b>4.5.2</b> COR8-C</a></li>
<li class="chapter" data-level="4.5.3" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cor8-nc"><i class="fa fa-check"></i><b>4.5.3</b> COR8-NC</a></li>
<li class="chapter" data-level="4.5.4" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cla8-c"><i class="fa fa-check"></i><b>4.5.4</b> CLA8-C</a></li>
<li class="chapter" data-level="4.5.5" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#cla8-nc"><i class="fa fa-check"></i><b>4.5.5</b> CLA8-NC</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#results-1"><i class="fa fa-check"></i><b>4.6</b> Results</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#inferences-using-parameters-from-cid4-1"><i class="fa fa-check"></i><b>4.6.1</b> Inferences using parameters from CID4</a></li>
<li class="chapter" data-level="4.6.2" data-path="congruence-between-independent-and-dependent-sses.html"><a href="congruence-between-independent-and-dependent-sses.html#maximum-likelihood-estimates"><i class="fa fa-check"></i><b>4.6.2</b> Maximum Likelihood estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html"><i class="fa fa-check"></i><b>5</b> Equal Rate Hidden Expansion (EHE)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#read-in-data-1"><i class="fa fa-check"></i><b>5.1</b> Read in data</a></li>
<li class="chapter" data-level="5.2" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#setting-up-q-matrices-for-inference-1"><i class="fa fa-check"></i><b>5.2</b> Setting-up Q matrices for inference</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#cid4-1"><i class="fa fa-check"></i><b>5.2.1</b> CID4</a></li>
<li class="chapter" data-level="5.2.2" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#cid8-congruent-to-cid4-1"><i class="fa fa-check"></i><b>5.2.2</b> CID8 (congruent to CID4)</a></li>
<li class="chapter" data-level="5.2.3" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#ehe8-c-correlated-evolution-congruent-to-cid4"><i class="fa fa-check"></i><b>5.2.3</b> EHE8-C (correlated evolution, congruent to CID4)</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#inferences-using-parameters-from-cid4-2"><i class="fa fa-check"></i><b>5.3</b> Inferences using parameters from CID4</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#cid4-4-pars-1"><i class="fa fa-check"></i><b>5.3.1</b> CID4 (4 pars)</a></li>
<li class="chapter" data-level="5.3.2" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#ehe8-c-2-pars"><i class="fa fa-check"></i><b>5.3.2</b> EHE8-C (2 pars)</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="equal-rate-hidden-expansion-ehe.html"><a href="equal-rate-hidden-expansion-ehe.html#compare-ln-estimates"><i class="fa fa-check"></i><b>5.4</b> Compare Ln estimates</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html"><i class="fa fa-check"></i><b>6</b> Semi-congruent Behavior</a>
<ul>
<li class="chapter" data-level="6.1" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html#setting-up-q-matrices-for-inference-2"><i class="fa fa-check"></i><b>6.1</b> Setting-up Q matrices for inference</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html#cid4-2"><i class="fa fa-check"></i><b>6.1.1</b> CID4</a></li>
<li class="chapter" data-level="6.1.2" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html#ehe8-c-correlated-evolution-congruent-to-cid4-1"><i class="fa fa-check"></i><b>6.1.2</b> EHE8-C (correlated evolution, congruent to CID4)</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html#read-in-data-2"><i class="fa fa-check"></i><b>6.2</b> Read in data</a></li>
<li class="chapter" data-level="6.3" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html#maximum-likelihood"><i class="fa fa-check"></i><b>6.3</b> Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html#cid4-4-pars-2"><i class="fa fa-check"></i><b>6.3.1</b> CID4 (4 pars)</a></li>
<li class="chapter" data-level="6.3.2" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html#ehe8-c"><i class="fa fa-check"></i><b>6.3.2</b> EHE8-C</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="semi-congruent-behavior.html"><a href="semi-congruent-behavior.html#results-2"><i class="fa fa-check"></i><b>6.4</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html"><i class="fa fa-check"></i><b>7</b> Congruence under varying Sampling Fraction</a>
<ul>
<li class="chapter" data-level="7.1" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#read-in-data-3"><i class="fa fa-check"></i><b>7.1</b> Read in data</a></li>
<li class="chapter" data-level="7.2" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#setup-sampling-fraction"><i class="fa fa-check"></i><b>7.2</b> Setup Sampling Fraction</a></li>
<li class="chapter" data-level="7.3" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#setting-up-q-matrices-for-inference-3"><i class="fa fa-check"></i><b>7.3</b> Setting-up Q matrices for inference</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cid4-3"><i class="fa fa-check"></i><b>7.3.1</b> CID4</a></li>
<li class="chapter" data-level="7.3.2" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cid8-congruent-to-cid4-2"><i class="fa fa-check"></i><b>7.3.2</b> CID8 (congruent to CID4)</a></li>
<li class="chapter" data-level="7.3.3" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cor8-c-correlated-evolution-congruent-to-cid4-1"><i class="fa fa-check"></i><b>7.3.3</b> COR8-C (correlated evolution, congruent to CID4)</a></li>
<li class="chapter" data-level="7.3.4" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cor8-nc-non-correlated-evolution-congruent-to-cid4-1"><i class="fa fa-check"></i><b>7.3.4</b> COR8-NC (Non-correlated evolution, congruent to CID4)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#irreducible-model-1"><i class="fa fa-check"></i><b>7.4</b> Irreducible model</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cid4-4-pars-3"><i class="fa fa-check"></i><b>7.4.1</b> CID4 (4 pars)</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#inferences-using-parameters-from-cid4-3"><i class="fa fa-check"></i><b>7.5</b> Inferences using parameters from CID4</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cid8-4-pars-1"><i class="fa fa-check"></i><b>7.5.1</b> CID8 (4 pars)</a></li>
<li class="chapter" data-level="7.5.2" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cor8-c-4-pars-1"><i class="fa fa-check"></i><b>7.5.2</b> COR8-C (4 pars)</a></li>
<li class="chapter" data-level="7.5.3" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cor8-nc-4-pars-1"><i class="fa fa-check"></i><b>7.5.3</b> COR8-NC (4 pars)</a></li>
<li class="chapter" data-level="7.5.4" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cla8-c-4-pars-1"><i class="fa fa-check"></i><b>7.5.4</b> CLA8-C (4 pars)</a></li>
<li class="chapter" data-level="7.5.5" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#cla8-nc-4-pars-1"><i class="fa fa-check"></i><b>7.5.5</b> CLA8-NC (4 pars)</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#results-3"><i class="fa fa-check"></i><b>7.6</b> Results</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="congruence-under-varying-sampling-fraction.html"><a href="congruence-under-varying-sampling-fraction.html#inferences-using-parameters-from-cid4-4"><i class="fa fa-check"></i><b>7.6.1</b> Inferences using parameters from CID4</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Report for Simulations using HiClaSSE model</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="congruence-under-varying-sampling-fraction" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> Congruence under varying Sampling Fraction<a href="congruence-under-varying-sampling-fraction.html#congruence-under-varying-sampling-fraction" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Hrein, we show that congruence holds under varying sampling fraction using the previous. This simulation is very close to the CID example from the section “Congruence between independent and dependent SSEs”, except that we use different sampling fraction.</p>
<table>
<colgroup>
<col width="8%" />
<col width="3%" />
<col width="27%" />
<col width="17%" />
<col width="15%" />
<col width="27%" />
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>np</th>
<th>pars</th>
<th>Cong. with CID4</th>
<th>Trait &amp; Div.</th>
<th>Speciation Rates</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CID4</td>
<td>4</td>
<td>2d 1q 1mu</td>
<td>–</td>
<td>independent</td>
<td>decoupled (d)</td>
</tr>
<tr class="even">
<td>CID8</td>
<td>4</td>
<td>2d 1q 1mu</td>
<td>yes</td>
<td>independent</td>
<td>decoupled (d)</td>
</tr>
<tr class="odd">
<td>COR8-C</td>
<td>4</td>
<td>2d 1q 1mu</td>
<td>yes</td>
<td>correlated</td>
<td>decoupled (d)</td>
</tr>
<tr class="even">
<td>CLA8-C</td>
<td>4</td>
<td>2c 1q 1mu</td>
<td>yes</td>
<td>correlated</td>
<td>coupled (c)</td>
</tr>
<tr class="odd">
<td>COR8-NC</td>
<td>4</td>
<td>2d 1q 1mu</td>
<td>no</td>
<td>correlated*</td>
<td>decoupled (d)</td>
</tr>
<tr class="even">
<td>CLA8-NC</td>
<td>4</td>
<td>2c 1q 1mu</td>
<td>no</td>
<td>correlated</td>
<td>coupled* (c)</td>
</tr>
</tbody>
</table>
<p>*indicates non-lumpable transition or speciation rates. See also, Fig. referenced and Table S1.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="congruence-under-varying-sampling-fraction.html#cb391-1" tabindex="-1"></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb391-2"><a href="congruence-under-varying-sampling-fraction.html#cb391-2" tabindex="-1"></a><span class="do">##  ~ installations and dependencies  ----</span></span>
<span id="cb391-3"><a href="congruence-under-varying-sampling-fraction.html#cb391-3" tabindex="-1"></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb391-4"><a href="congruence-under-varying-sampling-fraction.html#cb391-4" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;R/utils/dependencies.R&#39;</span>)</span>
<span id="cb391-5"><a href="congruence-under-varying-sampling-fraction.html#cb391-5" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;R/hiclasse/HiClaSSE-R.R&#39;</span>) <span class="co"># pure R implementation of HiCLaSSE</span></span></code></pre></div>
<pre><code>## [1] &quot;Original matrix:&quot;
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
## [1] &quot;Matrix with right diagonal set to zero:&quot;
##      [,1] [,2] [,3]
## [1,]    1    4    0
## [2,]    2    0    8
## [3,]    0    6    9</code></pre>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="congruence-under-varying-sampling-fraction.html#cb393-1" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;R/hiclasse/HiClaSSE_cpp.R&#39;</span>) <span class="co"># fast implementation</span></span></code></pre></div>
<pre><code>## [1] &quot;Original matrix:&quot;
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
## [1] &quot;Matrix with right diagonal set to zero:&quot;
##      [,1] [,2] [,3]
## [1,]    1    4    0
## [2,]    2    0    8
## [3,]    0    6    9
## [1] TRUE
## [1] TRUE
## [1] TRUE
## [1] TRUE</code></pre>
<div id="read-in-data-3" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Read in data<a href="congruence-under-varying-sampling-fraction.html#read-in-data-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="congruence-under-varying-sampling-fraction.html#cb395-1" tabindex="-1"></a>NSIM <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb395-2"><a href="congruence-under-varying-sampling-fraction.html#cb395-2" tabindex="-1"></a>phy <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file=</span><span class="st">&#39;R/data/phy_CID4.RDS&#39;</span>)</span></code></pre></div>
</div>
<div id="setup-sampling-fraction" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Setup Sampling Fraction<a href="congruence-under-varying-sampling-fraction.html#setup-sampling-fraction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="congruence-under-varying-sampling-fraction.html#cb396-1" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb396-2"><a href="congruence-under-varying-sampling-fraction.html#cb396-2" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb396-3"><a href="congruence-under-varying-sampling-fraction.html#cb396-3" tabindex="-1"></a></span>
<span id="cb396-4"><a href="congruence-under-varying-sampling-fraction.html#cb396-4" tabindex="-1"></a>sam.fr4 <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb396-5"><a href="congruence-under-varying-sampling-fraction.html#cb396-5" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>s1, <span class="dv">1</span><span class="sc">-</span>s2, <span class="dv">1</span><span class="sc">-</span>s1, <span class="dv">1</span><span class="sc">-</span>s2,   s1, <span class="dv">0</span>, s1, <span class="dv">0</span>),</span>
<span id="cb396-6"><a href="congruence-under-varying-sampling-fraction.html#cb396-6" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>s1, <span class="dv">1</span><span class="sc">-</span>s2, <span class="dv">1</span><span class="sc">-</span>s1, <span class="dv">1</span><span class="sc">-</span>s2,   <span class="dv">0</span>, s2, <span class="dv">0</span>, s2)</span>
<span id="cb396-7"><a href="congruence-under-varying-sampling-fraction.html#cb396-7" tabindex="-1"></a>)</span>
<span id="cb396-8"><a href="congruence-under-varying-sampling-fraction.html#cb396-8" tabindex="-1"></a></span>
<span id="cb396-9"><a href="congruence-under-varying-sampling-fraction.html#cb396-9" tabindex="-1"></a>sam.fr8 <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb396-10"><a href="congruence-under-varying-sampling-fraction.html#cb396-10" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>s1, <span class="dv">1</span><span class="sc">-</span>s2, <span class="dv">1</span><span class="sc">-</span>s1, <span class="dv">1</span><span class="sc">-</span>s2, <span class="dv">1</span><span class="sc">-</span>s1, <span class="dv">1</span><span class="sc">-</span>s2, <span class="dv">1</span><span class="sc">-</span>s1, <span class="dv">1</span><span class="sc">-</span>s2,   s1,<span class="dv">0</span>,s1,<span class="dv">0</span>,s1,<span class="dv">0</span>,s1,<span class="dv">0</span>),</span>
<span id="cb396-11"><a href="congruence-under-varying-sampling-fraction.html#cb396-11" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>s1, <span class="dv">1</span><span class="sc">-</span>s2, <span class="dv">1</span><span class="sc">-</span>s1, <span class="dv">1</span><span class="sc">-</span>s2, <span class="dv">1</span><span class="sc">-</span>s1, <span class="dv">1</span><span class="sc">-</span>s2, <span class="dv">1</span><span class="sc">-</span>s1, <span class="dv">1</span><span class="sc">-</span>s2,   <span class="dv">0</span>,s2,<span class="dv">0</span>,s2,<span class="dv">0</span>,s2,<span class="dv">0</span>,s2)</span>
<span id="cb396-12"><a href="congruence-under-varying-sampling-fraction.html#cb396-12" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="setting-up-q-matrices-for-inference-3" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Setting-up Q matrices for inference<a href="congruence-under-varying-sampling-fraction.html#setting-up-q-matrices-for-inference-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="cid4-3" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> CID4<a href="congruence-under-varying-sampling-fraction.html#cid4-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="congruence-under-varying-sampling-fraction.html#cb397-1" tabindex="-1"></a><span class="co"># trait</span></span>
<span id="cb397-2"><a href="congruence-under-varying-sampling-fraction.html#cb397-2" tabindex="-1"></a>Q_t <span class="ot">&lt;-</span> <span class="fu">initQ</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>))</span>
<span id="cb397-3"><a href="congruence-under-varying-sampling-fraction.html#cb397-3" tabindex="-1"></a></span>
<span id="cb397-4"><a href="congruence-under-varying-sampling-fraction.html#cb397-4" tabindex="-1"></a><span class="co"># diversification regime</span></span>
<span id="cb397-5"><a href="congruence-under-varying-sampling-fraction.html#cb397-5" tabindex="-1"></a>Q_r2 <span class="ot">&lt;-</span> <span class="fu">initQ</span>(<span class="fu">c</span>(<span class="st">&#39;A&#39;</span>,<span class="st">&#39;B&#39;</span>), <span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>))</span>
<span id="cb397-6"><a href="congruence-under-varying-sampling-fraction.html#cb397-6" tabindex="-1"></a></span>
<span id="cb397-7"><a href="congruence-under-varying-sampling-fraction.html#cb397-7" tabindex="-1"></a></span>
<span id="cb397-8"><a href="congruence-under-varying-sampling-fraction.html#cb397-8" tabindex="-1"></a><span class="co"># speciation rates for tracking the order</span></span>
<span id="cb397-9"><a href="congruence-under-varying-sampling-fraction.html#cb397-9" tabindex="-1"></a>La4 <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="sc">-</span><span class="fl">0.05</span>),<span class="dv">2</span>)</span>
<span id="cb397-10"><a href="congruence-under-varying-sampling-fraction.html#cb397-10" tabindex="-1"></a>La4 <span class="ot">=</span> La4 <span class="sc">%x%</span> <span class="fu">diag</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb397-11"><a href="congruence-under-varying-sampling-fraction.html#cb397-11" tabindex="-1"></a><span class="co"># order according to regimes</span></span>
<span id="cb397-12"><a href="congruence-under-varying-sampling-fraction.html#cb397-12" tabindex="-1"></a>Q_cid4.r <span class="ot">&lt;-</span> <span class="fu">amaSMM</span>(Q_r2, Q_t)</span>
<span id="cb397-13"><a href="congruence-under-varying-sampling-fraction.html#cb397-13" tabindex="-1"></a></span>
<span id="cb397-14"><a href="congruence-under-varying-sampling-fraction.html#cb397-14" tabindex="-1"></a><span class="co"># order according to trait</span></span>
<span id="cb397-15"><a href="congruence-under-varying-sampling-fraction.html#cb397-15" tabindex="-1"></a>v<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>, <span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb397-16"><a href="congruence-under-varying-sampling-fraction.html#cb397-16" tabindex="-1"></a>Q_cid4.t <span class="ot">&lt;-</span> Q_cid4.r[v,v]</span>
<span id="cb397-17"><a href="congruence-under-varying-sampling-fraction.html#cb397-17" tabindex="-1"></a></span>
<span id="cb397-18"><a href="congruence-under-varying-sampling-fraction.html#cb397-18" tabindex="-1"></a><span class="fu">print</span>(Q_cid4.r)</span></code></pre></div>
<pre><code>##      A0   A1   B0   B1
## A0 -0.2  0.1  0.1  0.0
## A1  0.1 -0.2  0.0  0.1
## B0  0.1  0.0 -0.2  0.1
## B1  0.0  0.1  0.1 -0.2</code></pre>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="congruence-under-varying-sampling-fraction.html#cb399-1" tabindex="-1"></a><span class="fu">print</span>(La4)</span></code></pre></div>
<pre><code>##      [,1] [,2]  [,3]  [,4]
## [1,] -0.1  0.0  0.00  0.00
## [2,]  0.0 -0.1  0.00  0.00
## [3,]  0.0  0.0 -0.05  0.00
## [4,]  0.0  0.0  0.00 -0.05</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="congruence-under-varying-sampling-fraction.html#cb401-1" tabindex="-1"></a><span class="fu">print</span>(Q_cid4.t)</span></code></pre></div>
<pre><code>##      A0   B0   A1   B1
## A0 -0.2  0.1  0.1  0.0
## B0  0.1 -0.2  0.0  0.1
## A1  0.1  0.0 -0.2  0.1
## B1  0.0  0.1  0.1 -0.2</code></pre>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="congruence-under-varying-sampling-fraction.html#cb403-1" tabindex="-1"></a><span class="fu">print</span>(La4[v,v])</span></code></pre></div>
<pre><code>##      [,1]  [,2] [,3]  [,4]
## [1,] -0.1  0.00  0.0  0.00
## [2,]  0.0 -0.05  0.0  0.00
## [3,]  0.0  0.00 -0.1  0.00
## [4,]  0.0  0.00  0.0 -0.05</code></pre>
</div>
<div id="cid8-congruent-to-cid4-2" class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> CID8 (congruent to CID4)<a href="congruence-under-varying-sampling-fraction.html#cid8-congruent-to-cid4-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="congruence-under-varying-sampling-fraction.html#cb405-1" tabindex="-1"></a><span class="co"># diversification regime</span></span>
<span id="cb405-2"><a href="congruence-under-varying-sampling-fraction.html#cb405-2" tabindex="-1"></a><span class="co">#Q_r4 &lt;- initQ(c(&#39;a&#39;,&#39;b&#39;, &#39;c&#39;, &#39;d&#39;), c(.01,.01))</span></span>
<span id="cb405-3"><a href="congruence-under-varying-sampling-fraction.html#cb405-3" tabindex="-1"></a></span>
<span id="cb405-4"><a href="congruence-under-varying-sampling-fraction.html#cb405-4" tabindex="-1"></a>Q_r4 <span class="ot">&lt;-</span><span class="fu">amaSMM</span>(Q_t, Q_t) </span>
<span id="cb405-5"><a href="congruence-under-varying-sampling-fraction.html#cb405-5" tabindex="-1"></a><span class="fu">colnames</span>(Q_r4) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Q_r4) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;d&#39;</span>)</span>
<span id="cb405-6"><a href="congruence-under-varying-sampling-fraction.html#cb405-6" tabindex="-1"></a></span>
<span id="cb405-7"><a href="congruence-under-varying-sampling-fraction.html#cb405-7" tabindex="-1"></a><span class="co"># speciation rates for tracking the order</span></span>
<span id="cb405-8"><a href="congruence-under-varying-sampling-fraction.html#cb405-8" tabindex="-1"></a>La8 <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="sc">-</span><span class="fl">0.05</span>),<span class="dv">2</span>)</span>
<span id="cb405-9"><a href="congruence-under-varying-sampling-fraction.html#cb405-9" tabindex="-1"></a>La8 <span class="ot">=</span> La8 <span class="sc">%x%</span> <span class="fu">diag</span>(<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb405-10"><a href="congruence-under-varying-sampling-fraction.html#cb405-10" tabindex="-1"></a></span>
<span id="cb405-11"><a href="congruence-under-varying-sampling-fraction.html#cb405-11" tabindex="-1"></a><span class="co"># order according to regimes</span></span>
<span id="cb405-12"><a href="congruence-under-varying-sampling-fraction.html#cb405-12" tabindex="-1"></a>Q_cid8.r <span class="ot">&lt;-</span> <span class="fu">amaSMM</span>(Q_r4, Q_t) </span>
<span id="cb405-13"><a href="congruence-under-varying-sampling-fraction.html#cb405-13" tabindex="-1"></a></span>
<span id="cb405-14"><a href="congruence-under-varying-sampling-fraction.html#cb405-14" tabindex="-1"></a><span class="co"># order according to trait</span></span>
<span id="cb405-15"><a href="congruence-under-varying-sampling-fraction.html#cb405-15" tabindex="-1"></a>v<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>, <span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>)</span>
<span id="cb405-16"><a href="congruence-under-varying-sampling-fraction.html#cb405-16" tabindex="-1"></a>Q_cid8.t <span class="ot">&lt;-</span> Q_cid8.r[v,v]</span>
<span id="cb405-17"><a href="congruence-under-varying-sampling-fraction.html#cb405-17" tabindex="-1"></a></span>
<span id="cb405-18"><a href="congruence-under-varying-sampling-fraction.html#cb405-18" tabindex="-1"></a><span class="fu">print</span>(Q_cid8.r)</span></code></pre></div>
<pre><code>##      a0   a1   b0   b1   c0   c1   d0   d1
## a0 -0.3  0.1  0.1  0.0  0.1  0.0  0.0  0.0
## a1  0.1 -0.3  0.0  0.1  0.0  0.1  0.0  0.0
## b0  0.1  0.0 -0.3  0.1  0.0  0.0  0.1  0.0
## b1  0.0  0.1  0.1 -0.3  0.0  0.0  0.0  0.1
## c0  0.1  0.0  0.0  0.0 -0.3  0.1  0.1  0.0
## c1  0.0  0.1  0.0  0.0  0.1 -0.3  0.0  0.1
## d0  0.0  0.0  0.1  0.0  0.1  0.0 -0.3  0.1
## d1  0.0  0.0  0.0  0.1  0.0  0.1  0.1 -0.3</code></pre>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="congruence-under-varying-sampling-fraction.html#cb407-1" tabindex="-1"></a><span class="fu">print</span>(La8)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]  [,5]  [,6]  [,7]  [,8]
## [1,] -0.1  0.0  0.0  0.0  0.00  0.00  0.00  0.00
## [2,]  0.0 -0.1  0.0  0.0  0.00  0.00  0.00  0.00
## [3,]  0.0  0.0 -0.1  0.0  0.00  0.00  0.00  0.00
## [4,]  0.0  0.0  0.0 -0.1  0.00  0.00  0.00  0.00
## [5,]  0.0  0.0  0.0  0.0 -0.05  0.00  0.00  0.00
## [6,]  0.0  0.0  0.0  0.0  0.00 -0.05  0.00  0.00
## [7,]  0.0  0.0  0.0  0.0  0.00  0.00 -0.05  0.00
## [8,]  0.0  0.0  0.0  0.0  0.00  0.00  0.00 -0.05</code></pre>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="congruence-under-varying-sampling-fraction.html#cb409-1" tabindex="-1"></a><span class="fu">print</span>(Q_cid8.t)</span></code></pre></div>
<pre><code>##      a0   b0   c0   d0   a1   b1   c1   d1
## a0 -0.3  0.1  0.1  0.0  0.1  0.0  0.0  0.0
## b0  0.1 -0.3  0.0  0.1  0.0  0.1  0.0  0.0
## c0  0.1  0.0 -0.3  0.1  0.0  0.0  0.1  0.0
## d0  0.0  0.1  0.1 -0.3  0.0  0.0  0.0  0.1
## a1  0.1  0.0  0.0  0.0 -0.3  0.1  0.1  0.0
## b1  0.0  0.1  0.0  0.0  0.1 -0.3  0.0  0.1
## c1  0.0  0.0  0.1  0.0  0.1  0.0 -0.3  0.1
## d1  0.0  0.0  0.0  0.1  0.0  0.1  0.1 -0.3</code></pre>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="congruence-under-varying-sampling-fraction.html#cb411-1" tabindex="-1"></a><span class="fu">print</span>(La8[v,v])</span></code></pre></div>
<pre><code>##      [,1] [,2]  [,3]  [,4] [,5] [,6]  [,7]  [,8]
## [1,] -0.1  0.0  0.00  0.00  0.0  0.0  0.00  0.00
## [2,]  0.0 -0.1  0.00  0.00  0.0  0.0  0.00  0.00
## [3,]  0.0  0.0 -0.05  0.00  0.0  0.0  0.00  0.00
## [4,]  0.0  0.0  0.00 -0.05  0.0  0.0  0.00  0.00
## [5,]  0.0  0.0  0.00  0.00 -0.1  0.0  0.00  0.00
## [6,]  0.0  0.0  0.00  0.00  0.0 -0.1  0.00  0.00
## [7,]  0.0  0.0  0.00  0.00  0.0  0.0 -0.05  0.00
## [8,]  0.0  0.0  0.00  0.00  0.0  0.0  0.00 -0.05</code></pre>
</div>
<div id="cor8-c-correlated-evolution-congruent-to-cid4-1" class="section level3 hasAnchor" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> COR8-C (correlated evolution, congruent to CID4)<a href="congruence-under-varying-sampling-fraction.html#cor8-c-correlated-evolution-congruent-to-cid4-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="congruence-under-varying-sampling-fraction.html#cb413-1" tabindex="-1"></a><span class="co"># like CID8 but with correlation</span></span>
<span id="cb413-2"><a href="congruence-under-varying-sampling-fraction.html#cb413-2" tabindex="-1"></a>Q_cor8_C.t <span class="ot">&lt;-</span> Q_cid8.t</span>
<span id="cb413-3"><a href="congruence-under-varying-sampling-fraction.html#cb413-3" tabindex="-1"></a></span>
<span id="cb413-4"><a href="congruence-under-varying-sampling-fraction.html#cb413-4" tabindex="-1"></a>bl <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">1</span>,.<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb413-5"><a href="congruence-under-varying-sampling-fraction.html#cb413-5" tabindex="-1"></a>Q_cor8_C.t[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> bl</span>
<span id="cb413-6"><a href="congruence-under-varying-sampling-fraction.html#cb413-6" tabindex="-1"></a>Q_cor8_C.t[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> bl</span>
<span id="cb413-7"><a href="congruence-under-varying-sampling-fraction.html#cb413-7" tabindex="-1"></a>Q_cor8_C.t[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="ot">&lt;-</span> bl</span>
<span id="cb413-8"><a href="congruence-under-varying-sampling-fraction.html#cb413-8" tabindex="-1"></a>Q_cor8_C.t[<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> bl</span>
<span id="cb413-9"><a href="congruence-under-varying-sampling-fraction.html#cb413-9" tabindex="-1"></a></span>
<span id="cb413-10"><a href="congruence-under-varying-sampling-fraction.html#cb413-10" tabindex="-1"></a>v<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>, <span class="dv">2</span>,<span class="dv">6</span>, <span class="dv">3</span>,<span class="dv">7</span>, <span class="dv">4</span>,<span class="dv">8</span>)</span>
<span id="cb413-11"><a href="congruence-under-varying-sampling-fraction.html#cb413-11" tabindex="-1"></a>Q_cor8_C.r <span class="ot">&lt;-</span> Q_cor8_C.t[v,v]</span>
<span id="cb413-12"><a href="congruence-under-varying-sampling-fraction.html#cb413-12" tabindex="-1"></a></span>
<span id="cb413-13"><a href="congruence-under-varying-sampling-fraction.html#cb413-13" tabindex="-1"></a><span class="fu">print</span>(Q_cor8_C.r)</span></code></pre></div>
<pre><code>##      a0   a1   b0   b1   c0   c1   d0   d1
## a0 -0.3  0.0  0.1  0.1  0.1  0.0  0.0  0.0
## a1  0.0 -0.3  0.1  0.1  0.0  0.1  0.0  0.0
## b0  0.1  0.1 -0.3  0.0  0.0  0.0  0.1  0.0
## b1  0.1  0.1  0.0 -0.3  0.0  0.0  0.0  0.1
## c0  0.1  0.0  0.0  0.0 -0.3  0.0  0.1  0.1
## c1  0.0  0.1  0.0  0.0  0.0 -0.3  0.1  0.1
## d0  0.0  0.0  0.1  0.0  0.1  0.1 -0.3  0.0
## d1  0.0  0.0  0.0  0.1  0.1  0.1  0.0 -0.3</code></pre>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="congruence-under-varying-sampling-fraction.html#cb415-1" tabindex="-1"></a><span class="co">#print(La8)</span></span>
<span id="cb415-2"><a href="congruence-under-varying-sampling-fraction.html#cb415-2" tabindex="-1"></a><span class="fu">print</span>(Q_cor8_C.t)</span></code></pre></div>
<pre><code>##      a0   b0   c0   d0   a1   b1   c1   d1
## a0 -0.3  0.1  0.1  0.0  0.0  0.1  0.0  0.0
## b0  0.1 -0.3  0.0  0.1  0.1  0.0  0.0  0.0
## c0  0.1  0.0 -0.3  0.1  0.0  0.0  0.0  0.1
## d0  0.0  0.1  0.1 -0.3  0.0  0.0  0.1  0.0
## a1  0.0  0.1  0.0  0.0 -0.3  0.1  0.1  0.0
## b1  0.1  0.0  0.0  0.0  0.1 -0.3  0.0  0.1
## c1  0.0  0.0  0.0  0.1  0.1  0.0 -0.3  0.1
## d1  0.0  0.0  0.1  0.0  0.0  0.1  0.1 -0.3</code></pre>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="congruence-under-varying-sampling-fraction.html#cb417-1" tabindex="-1"></a><span class="co">#print(La8[v,v])</span></span></code></pre></div>
</div>
<div id="cor8-nc-non-correlated-evolution-congruent-to-cid4-1" class="section level3 hasAnchor" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> COR8-NC (Non-correlated evolution, congruent to CID4)<a href="congruence-under-varying-sampling-fraction.html#cor8-nc-non-correlated-evolution-congruent-to-cid4-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="congruence-under-varying-sampling-fraction.html#cb418-1" tabindex="-1"></a><span class="co"># like CID8 but not congruent</span></span>
<span id="cb418-2"><a href="congruence-under-varying-sampling-fraction.html#cb418-2" tabindex="-1"></a>Q_cor8_NC.t <span class="ot">&lt;-</span> Q_cid8.t</span>
<span id="cb418-3"><a href="congruence-under-varying-sampling-fraction.html#cb418-3" tabindex="-1"></a></span>
<span id="cb418-4"><a href="congruence-under-varying-sampling-fraction.html#cb418-4" tabindex="-1"></a>bl <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb418-5"><a href="congruence-under-varying-sampling-fraction.html#cb418-5" tabindex="-1"></a>Q_cor8_NC.t[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> bl</span>
<span id="cb418-6"><a href="congruence-under-varying-sampling-fraction.html#cb418-6" tabindex="-1"></a>Q_cor8_NC.t[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> bl</span>
<span id="cb418-7"><a href="congruence-under-varying-sampling-fraction.html#cb418-7" tabindex="-1"></a>Q_cor8_NC.t[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="ot">&lt;-</span> bl</span>
<span id="cb418-8"><a href="congruence-under-varying-sampling-fraction.html#cb418-8" tabindex="-1"></a>Q_cor8_NC.t[<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> bl</span>
<span id="cb418-9"><a href="congruence-under-varying-sampling-fraction.html#cb418-9" tabindex="-1"></a></span>
<span id="cb418-10"><a href="congruence-under-varying-sampling-fraction.html#cb418-10" tabindex="-1"></a>v<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>, <span class="dv">2</span>,<span class="dv">6</span>, <span class="dv">3</span>,<span class="dv">7</span>, <span class="dv">4</span>,<span class="dv">8</span>)</span>
<span id="cb418-11"><a href="congruence-under-varying-sampling-fraction.html#cb418-11" tabindex="-1"></a>Q_cor8_NC.r <span class="ot">&lt;-</span> Q_cor8_NC.t[v,v]</span>
<span id="cb418-12"><a href="congruence-under-varying-sampling-fraction.html#cb418-12" tabindex="-1"></a></span>
<span id="cb418-13"><a href="congruence-under-varying-sampling-fraction.html#cb418-13" tabindex="-1"></a><span class="fu">print</span>(Q_cor8_NC.r)</span></code></pre></div>
<pre><code>##      a0   a1   b0   b1   c0   c1   d0   d1
## a0 -0.3  0.0  0.1  0.1  0.1  0.0  0.0  0.0
## a1  0.0 -0.3  0.1  0.1  0.0  0.1  0.0  0.0
## b0  0.1  0.0 -0.3  0.0  0.0  0.0  0.1  0.0
## b1  0.0  0.1  0.0 -0.3  0.0  0.0  0.0  0.1
## c0  0.1  0.0  0.0  0.0 -0.3  0.0  0.1  0.1
## c1  0.0  0.1  0.0  0.0  0.0 -0.3  0.1  0.1
## d0  0.0  0.0  0.1  0.0  0.1  0.0 -0.3  0.0
## d1  0.0  0.0  0.0  0.1  0.0  0.1  0.0 -0.3</code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="congruence-under-varying-sampling-fraction.html#cb420-1" tabindex="-1"></a><span class="co">#print(La8)</span></span>
<span id="cb420-2"><a href="congruence-under-varying-sampling-fraction.html#cb420-2" tabindex="-1"></a><span class="fu">print</span>(Q_cor8_NC.t)</span></code></pre></div>
<pre><code>##      a0   b0   c0   d0   a1   b1   c1   d1
## a0 -0.3  0.1  0.1  0.0  0.0  0.1  0.0  0.0
## b0  0.1 -0.3  0.0  0.1  0.0  0.0  0.0  0.0
## c0  0.1  0.0 -0.3  0.1  0.0  0.0  0.0  0.1
## d0  0.0  0.1  0.1 -0.3  0.0  0.0  0.0  0.0
## a1  0.0  0.1  0.0  0.0 -0.3  0.1  0.1  0.0
## b1  0.0  0.0  0.0  0.0  0.1 -0.3  0.0  0.1
## c1  0.0  0.0  0.0  0.1  0.1  0.0 -0.3  0.1
## d1  0.0  0.0  0.0  0.0  0.0  0.1  0.1 -0.3</code></pre>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="congruence-under-varying-sampling-fraction.html#cb422-1" tabindex="-1"></a><span class="co">#print(La8[v,v])</span></span></code></pre></div>
</div>
</div>
<div id="irreducible-model-1" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Irreducible model<a href="congruence-under-varying-sampling-fraction.html#irreducible-model-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="cid4-4-pars-3" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> CID4 (4 pars)<a href="congruence-under-varying-sampling-fraction.html#cid4-4-pars-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="congruence-under-varying-sampling-fraction.html#cb423-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb423-2"><a href="congruence-under-varying-sampling-fraction.html#cb423-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 4L,</span>
<span id="cb423-3"><a href="congruence-under-varying-sampling-fraction.html#cb423-3" tabindex="-1"></a>  <span class="at">y =</span> sam.fr4)</span>
<span id="cb423-4"><a href="congruence-under-varying-sampling-fraction.html#cb423-4" tabindex="-1"></a></span>
<span id="cb423-5"><a href="congruence-under-varying-sampling-fraction.html#cb423-5" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb423-6"><a href="congruence-under-varying-sampling-fraction.html#cb423-6" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb423-7"><a href="congruence-under-varying-sampling-fraction.html#cb423-7" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">4</span>)</span>
<span id="cb423-8"><a href="congruence-under-varying-sampling-fraction.html#cb423-8" tabindex="-1"></a><span class="co">#args$arrays</span></span>
<span id="cb423-9"><a href="congruence-under-varying-sampling-fraction.html#cb423-9" tabindex="-1"></a><span class="co">#args$pars</span></span>
<span id="cb423-10"><a href="congruence-under-varying-sampling-fraction.html#cb423-10" tabindex="-1"></a><span class="co">#length(args$pars)</span></span>
<span id="cb423-11"><a href="congruence-under-varying-sampling-fraction.html#cb423-11" tabindex="-1"></a><span class="fu">reoder_lambdas</span>(args<span class="sc">$</span>arrays, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>, <span class="dv">2</span>,<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## $lam.tensor
## $lam.tensor[[1]]
##      [,1]     [,2]     [,3]     [,4]    
## [1,] &quot;lam000&quot; &quot;lam002&quot; &quot;lam001&quot; &quot;lam003&quot;
## [2,] &quot;0&quot;      &quot;lam022&quot; &quot;0&quot;      &quot;lam023&quot;
## [3,] &quot;0&quot;      &quot;lam012&quot; &quot;lam011&quot; &quot;lam013&quot;
## [4,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam033&quot;
## 
## $lam.tensor[[2]]
##      [,1]     [,2]     [,3]     [,4]    
## [1,] &quot;lam200&quot; &quot;lam202&quot; &quot;lam201&quot; &quot;lam203&quot;
## [2,] &quot;0&quot;      &quot;lam222&quot; &quot;0&quot;      &quot;lam223&quot;
## [3,] &quot;0&quot;      &quot;lam212&quot; &quot;lam211&quot; &quot;lam213&quot;
## [4,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam233&quot;
## 
## $lam.tensor[[3]]
##      [,1]     [,2]     [,3]     [,4]    
## [1,] &quot;lam100&quot; &quot;lam102&quot; &quot;lam101&quot; &quot;lam103&quot;
## [2,] &quot;0&quot;      &quot;lam122&quot; &quot;0&quot;      &quot;lam123&quot;
## [3,] &quot;0&quot;      &quot;lam112&quot; &quot;lam111&quot; &quot;lam113&quot;
## [4,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam133&quot;
## 
## $lam.tensor[[4]]
##      [,1]     [,2]     [,3]     [,4]    
## [1,] &quot;lam300&quot; &quot;lam302&quot; &quot;lam301&quot; &quot;lam303&quot;
## [2,] &quot;0&quot;      &quot;lam322&quot; &quot;0&quot;      &quot;lam323&quot;
## [3,] &quot;0&quot;      &quot;lam312&quot; &quot;lam311&quot; &quot;lam313&quot;
## [4,] &quot;0&quot;      &quot;0&quot;      &quot;0&quot;      &quot;lam333&quot;
## 
## 
## $mu
## [1] &quot;mu0&quot; &quot;mu2&quot; &quot;mu1&quot; &quot;mu3&quot;
## 
## $Q
##      [,1]  [,2]  [,3]  [,4] 
## [1,] &quot;0&quot;   &quot;q02&quot; &quot;q01&quot; &quot;q03&quot;
## [2,] &quot;q20&quot; &quot;0&quot;   &quot;q21&quot; &quot;q23&quot;
## [3,] &quot;q10&quot; &quot;q12&quot; &quot;0&quot;   &quot;q13&quot;
## [4,] &quot;q30&quot; &quot;q32&quot; &quot;q31&quot; &quot;0&quot;</code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="congruence-under-varying-sampling-fraction.html#cb425-1" tabindex="-1"></a>pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb425-2"><a href="congruence-under-varying-sampling-fraction.html#cb425-2" tabindex="-1"></a><span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb425-3"><a href="congruence-under-varying-sampling-fraction.html#cb425-3" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam000&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb425-4"><a href="congruence-under-varying-sampling-fraction.html#cb425-4" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam111&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb425-5"><a href="congruence-under-varying-sampling-fraction.html#cb425-5" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam222&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb425-6"><a href="congruence-under-varying-sampling-fraction.html#cb425-6" tabindex="-1"></a>pars.hc[<span class="st">&#39;lam333&#39;</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb425-7"><a href="congruence-under-varying-sampling-fraction.html#cb425-7" tabindex="-1"></a>pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb425-8"><a href="congruence-under-varying-sampling-fraction.html#cb425-8" tabindex="-1"></a>qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cid4.r)</span>
<span id="cb425-9"><a href="congruence-under-varying-sampling-fraction.html#cb425-9" tabindex="-1"></a>qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb425-10"><a href="congruence-under-varying-sampling-fraction.html#cb425-10" tabindex="-1"></a>pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb425-11"><a href="congruence-under-varying-sampling-fraction.html#cb425-11" tabindex="-1"></a></span>
<span id="cb425-12"><a href="congruence-under-varying-sampling-fraction.html#cb425-12" tabindex="-1"></a></span>
<span id="cb425-13"><a href="congruence-under-varying-sampling-fraction.html#cb425-13" tabindex="-1"></a></span>
<span id="cb425-14"><a href="congruence-under-varying-sampling-fraction.html#cb425-14" tabindex="-1"></a>zero.constr <span class="ot">&lt;-</span> <span class="fu">formulas_zero_pars</span>(pars.hc)</span>
<span id="cb425-15"><a href="congruence-under-varying-sampling-fraction.html#cb425-15" tabindex="-1"></a>f.qs <span class="ot">&lt;-</span> <span class="fu">assign_classes_pairwise</span>(Q_cid4.r, args<span class="sc">$</span>arrays<span class="sc">$</span>Q)</span>
<span id="cb425-16"><a href="congruence-under-varying-sampling-fraction.html#cb425-16" tabindex="-1"></a>f.mu <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1 <span class="sc">~</span> mu0, mu2 <span class="sc">~</span> mu0, mu3 <span class="sc">~</span> mu0)</span>
<span id="cb425-17"><a href="congruence-under-varying-sampling-fraction.html#cb425-17" tabindex="-1"></a>f.lams <span class="ot">&lt;-</span> <span class="fu">c</span>(lam111 <span class="sc">~</span> lam000, lam333 <span class="sc">~</span> lam222)</span>
<span id="cb425-18"><a href="congruence-under-varying-sampling-fraction.html#cb425-18" tabindex="-1"></a>f.list<span class="ot">&lt;-</span> <span class="fu">c</span>(zero.constr,  f.qs, f.mu, f.lams)</span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="congruence-under-varying-sampling-fraction.html#cb426-1" tabindex="-1"></a>CID4 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb426-2"><a href="congruence-under-varying-sampling-fraction.html#cb426-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb426-3"><a href="congruence-under-varying-sampling-fraction.html#cb426-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSIM){</span>
<span id="cb426-4"><a href="congruence-under-varying-sampling-fraction.html#cb426-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb426-5"><a href="congruence-under-varying-sampling-fraction.html#cb426-5" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb426-6"><a href="congruence-under-varying-sampling-fraction.html#cb426-6" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb426-7"><a href="congruence-under-varying-sampling-fraction.html#cb426-7" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb426-8"><a href="congruence-under-varying-sampling-fraction.html#cb426-8" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb426-9"><a href="congruence-under-varying-sampling-fraction.html#cb426-9" tabindex="-1"></a>  </span>
<span id="cb426-10"><a href="congruence-under-varying-sampling-fraction.html#cb426-10" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,   <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb426-11"><a href="congruence-under-varying-sampling-fraction.html#cb426-11" tabindex="-1"></a>  lik.const <span class="ot">&lt;-</span> <span class="fu">constrain</span>(lik.c, <span class="at">formulae =</span> f.list)</span>
<span id="cb426-12"><a href="congruence-under-varying-sampling-fraction.html#cb426-12" tabindex="-1"></a>  arg.const <span class="ot">&lt;-</span> <span class="fu">argnames</span>(lik.const)</span>
<span id="cb426-13"><a href="congruence-under-varying-sampling-fraction.html#cb426-13" tabindex="-1"></a>  starting.point <span class="ot">&lt;-</span> pars.hc[arg.const]</span>
<span id="cb426-14"><a href="congruence-under-varying-sampling-fraction.html#cb426-14" tabindex="-1"></a>  CID4[[i]] <span class="ot">&lt;-</span> <span class="fu">find.mle</span>(lik.const, starting.point, <span class="at">method=</span><span class="st">&quot;subplex&quot;</span>, <span class="at">keep.func=</span>F, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span><span class="cn">TRUE</span>)</span>
<span id="cb426-15"><a href="congruence-under-varying-sampling-fraction.html#cb426-15" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.700.300.3&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.700.300.3&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.700.300.3&quot;
## [1] &quot;Working on: 4&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.700.300.3&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.700.300.3&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.700.300.3&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.700.300.3&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.700.300.3&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.700.300.3&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.700.300.3&quot;</code></pre>
<p>Some helper functions to assess the inference parameters.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="congruence-under-varying-sampling-fraction.html#cb428-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.1492 -423.6706 -406.3133 -415.9856 -423.3954 -411.9496 -428.5559 -423.9597 -417.3035 -396.6808</code></pre>
</div>
</div>
<div id="inferences-using-parameters-from-cid4-3" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Inferences using parameters from CID4<a href="congruence-under-varying-sampling-fraction.html#inferences-using-parameters-from-cid4-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="cid8-4-pars-1" class="section level3 hasAnchor" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> CID8 (4 pars)<a href="congruence-under-varying-sampling-fraction.html#cid8-4-pars-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="congruence-under-varying-sampling-fraction.html#cb430-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb430-2"><a href="congruence-under-varying-sampling-fraction.html#cb430-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 8L,</span>
<span id="cb430-3"><a href="congruence-under-varying-sampling-fraction.html#cb430-3" tabindex="-1"></a>  <span class="at">y =</span> sam.fr8)</span>
<span id="cb430-4"><a href="congruence-under-varying-sampling-fraction.html#cb430-4" tabindex="-1"></a></span>
<span id="cb430-5"><a href="congruence-under-varying-sampling-fraction.html#cb430-5" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb430-6"><a href="congruence-under-varying-sampling-fraction.html#cb430-6" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb430-7"><a href="congruence-under-varying-sampling-fraction.html#cb430-7" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">8</span>)</span>
<span id="cb430-8"><a href="congruence-under-varying-sampling-fraction.html#cb430-8" tabindex="-1"></a><span class="co">#args$arrays</span></span>
<span id="cb430-9"><a href="congruence-under-varying-sampling-fraction.html#cb430-9" tabindex="-1"></a><span class="co">#reoder_lambdas(args$arrays, c(1,3,5,7, 2,4,6,8))</span></span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="congruence-under-varying-sampling-fraction.html#cb431-1" tabindex="-1"></a>CID8.pars <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb431-2"><a href="congruence-under-varying-sampling-fraction.html#cb431-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb431-3"><a href="congruence-under-varying-sampling-fraction.html#cb431-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSIM){</span>
<span id="cb431-4"><a href="congruence-under-varying-sampling-fraction.html#cb431-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb431-5"><a href="congruence-under-varying-sampling-fraction.html#cb431-5" tabindex="-1"></a>  <span class="co">#-----------</span></span>
<span id="cb431-6"><a href="congruence-under-varying-sampling-fraction.html#cb431-6" tabindex="-1"></a>  est <span class="ot">&lt;-</span> <span class="fu">get_item</span>(CID4[i], <span class="st">&#39;par&#39;</span>)</span>
<span id="cb431-7"><a href="congruence-under-varying-sampling-fraction.html#cb431-7" tabindex="-1"></a>  pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb431-8"><a href="congruence-under-varying-sampling-fraction.html#cb431-8" tabindex="-1"></a>  <span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb431-9"><a href="congruence-under-varying-sampling-fraction.html#cb431-9" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam000&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb431-10"><a href="congruence-under-varying-sampling-fraction.html#cb431-10" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam111&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb431-11"><a href="congruence-under-varying-sampling-fraction.html#cb431-11" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam222&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb431-12"><a href="congruence-under-varying-sampling-fraction.html#cb431-12" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam333&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb431-13"><a href="congruence-under-varying-sampling-fraction.html#cb431-13" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam444&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb431-14"><a href="congruence-under-varying-sampling-fraction.html#cb431-14" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam555&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb431-15"><a href="congruence-under-varying-sampling-fraction.html#cb431-15" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam666&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb431-16"><a href="congruence-under-varying-sampling-fraction.html#cb431-16" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam777&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb431-17"><a href="congruence-under-varying-sampling-fraction.html#cb431-17" tabindex="-1"></a>  pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu4&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu5&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu6&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu7&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;mu0&#39;</span>]</span>
<span id="cb431-18"><a href="congruence-under-varying-sampling-fraction.html#cb431-18" tabindex="-1"></a>  qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cid8.r)</span>
<span id="cb431-19"><a href="congruence-under-varying-sampling-fraction.html#cb431-19" tabindex="-1"></a>  qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb431-20"><a href="congruence-under-varying-sampling-fraction.html#cb431-20" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.1</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q01&#39;</span>]</span>
<span id="cb431-21"><a href="congruence-under-varying-sampling-fraction.html#cb431-21" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.01</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q02&#39;</span>]<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb431-22"><a href="congruence-under-varying-sampling-fraction.html#cb431-22" tabindex="-1"></a>  pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb431-23"><a href="congruence-under-varying-sampling-fraction.html#cb431-23" tabindex="-1"></a>  </span>
<span id="cb431-24"><a href="congruence-under-varying-sampling-fraction.html#cb431-24" tabindex="-1"></a>  <span class="co">#pars.hc</span></span>
<span id="cb431-25"><a href="congruence-under-varying-sampling-fraction.html#cb431-25" tabindex="-1"></a>  <span class="co">#pars_to_arrays(pars.hc, 8)</span></span>
<span id="cb431-26"><a href="congruence-under-varying-sampling-fraction.html#cb431-26" tabindex="-1"></a>  <span class="co">#------</span></span>
<span id="cb431-27"><a href="congruence-under-varying-sampling-fraction.html#cb431-27" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb431-28"><a href="congruence-under-varying-sampling-fraction.html#cb431-28" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb431-29"><a href="congruence-under-varying-sampling-fraction.html#cb431-29" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb431-30"><a href="congruence-under-varying-sampling-fraction.html#cb431-30" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb431-31"><a href="congruence-under-varying-sampling-fraction.html#cb431-31" tabindex="-1"></a>  </span>
<span id="cb431-32"><a href="congruence-under-varying-sampling-fraction.html#cb431-32" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,  <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb431-33"><a href="congruence-under-varying-sampling-fraction.html#cb431-33" tabindex="-1"></a>  CID8.pars[[i]] <span class="ot">&lt;-</span> <span class="fu">lik.c</span>(pars.hc, <span class="at">intermediates=</span>T, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span>T)</span>
<span id="cb431-34"><a href="congruence-under-varying-sampling-fraction.html#cb431-34" tabindex="-1"></a>  </span>
<span id="cb431-35"><a href="congruence-under-varying-sampling-fraction.html#cb431-35" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 4&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;</code></pre>
<p>Compare Ln</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="congruence-under-varying-sampling-fraction.html#cb433-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.1492 -423.6706 -406.3133 -415.9856 -423.3954 -411.9496 -428.5559 -423.9597 -417.3035 -396.6808</code></pre>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="congruence-under-varying-sampling-fraction.html#cb435-1" tabindex="-1"></a>CID8.pars <span class="sc">%&gt;%</span> unlist</span></code></pre></div>
<pre><code>##  [1] -438.1492 -423.6706 -406.3133 -415.9856 -423.3954 -411.9496 -428.5559 -423.9597 -417.3035 -396.6808</code></pre>
</div>
<div id="cor8-c-4-pars-1" class="section level3 hasAnchor" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> COR8-C (4 pars)<a href="congruence-under-varying-sampling-fraction.html#cor8-c-4-pars-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="congruence-under-varying-sampling-fraction.html#cb437-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb437-2"><a href="congruence-under-varying-sampling-fraction.html#cb437-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 8L,</span>
<span id="cb437-3"><a href="congruence-under-varying-sampling-fraction.html#cb437-3" tabindex="-1"></a>  <span class="at">y =</span> sam.fr8)</span>
<span id="cb437-4"><a href="congruence-under-varying-sampling-fraction.html#cb437-4" tabindex="-1"></a></span>
<span id="cb437-5"><a href="congruence-under-varying-sampling-fraction.html#cb437-5" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb437-6"><a href="congruence-under-varying-sampling-fraction.html#cb437-6" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb437-7"><a href="congruence-under-varying-sampling-fraction.html#cb437-7" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">8</span>)</span>
<span id="cb437-8"><a href="congruence-under-varying-sampling-fraction.html#cb437-8" tabindex="-1"></a><span class="co">#args</span></span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="congruence-under-varying-sampling-fraction.html#cb438-1" tabindex="-1"></a>COR8_C.pars <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb438-2"><a href="congruence-under-varying-sampling-fraction.html#cb438-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb438-3"><a href="congruence-under-varying-sampling-fraction.html#cb438-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSIM){</span>
<span id="cb438-4"><a href="congruence-under-varying-sampling-fraction.html#cb438-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb438-5"><a href="congruence-under-varying-sampling-fraction.html#cb438-5" tabindex="-1"></a>  <span class="co">#-----------</span></span>
<span id="cb438-6"><a href="congruence-under-varying-sampling-fraction.html#cb438-6" tabindex="-1"></a>  est <span class="ot">&lt;-</span> <span class="fu">get_item</span>(CID4[i], <span class="st">&#39;par&#39;</span>)</span>
<span id="cb438-7"><a href="congruence-under-varying-sampling-fraction.html#cb438-7" tabindex="-1"></a>  pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb438-8"><a href="congruence-under-varying-sampling-fraction.html#cb438-8" tabindex="-1"></a>  <span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb438-9"><a href="congruence-under-varying-sampling-fraction.html#cb438-9" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam000&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb438-10"><a href="congruence-under-varying-sampling-fraction.html#cb438-10" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam111&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb438-11"><a href="congruence-under-varying-sampling-fraction.html#cb438-11" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam222&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb438-12"><a href="congruence-under-varying-sampling-fraction.html#cb438-12" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam333&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb438-13"><a href="congruence-under-varying-sampling-fraction.html#cb438-13" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam444&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb438-14"><a href="congruence-under-varying-sampling-fraction.html#cb438-14" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam555&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb438-15"><a href="congruence-under-varying-sampling-fraction.html#cb438-15" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam666&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb438-16"><a href="congruence-under-varying-sampling-fraction.html#cb438-16" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam777&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb438-17"><a href="congruence-under-varying-sampling-fraction.html#cb438-17" tabindex="-1"></a>  pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu4&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu5&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu6&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu7&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;mu0&#39;</span>]</span>
<span id="cb438-18"><a href="congruence-under-varying-sampling-fraction.html#cb438-18" tabindex="-1"></a>  qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cor8_C.r)</span>
<span id="cb438-19"><a href="congruence-under-varying-sampling-fraction.html#cb438-19" tabindex="-1"></a>  qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb438-20"><a href="congruence-under-varying-sampling-fraction.html#cb438-20" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.1</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q01&#39;</span>]</span>
<span id="cb438-21"><a href="congruence-under-varying-sampling-fraction.html#cb438-21" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.01</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q02&#39;</span>]<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb438-22"><a href="congruence-under-varying-sampling-fraction.html#cb438-22" tabindex="-1"></a>  pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb438-23"><a href="congruence-under-varying-sampling-fraction.html#cb438-23" tabindex="-1"></a>  </span>
<span id="cb438-24"><a href="congruence-under-varying-sampling-fraction.html#cb438-24" tabindex="-1"></a>  <span class="co"># pars.hc</span></span>
<span id="cb438-25"><a href="congruence-under-varying-sampling-fraction.html#cb438-25" tabindex="-1"></a>  <span class="co"># pars_to_arrays(pars.hc, 8)</span></span>
<span id="cb438-26"><a href="congruence-under-varying-sampling-fraction.html#cb438-26" tabindex="-1"></a>  <span class="co">#v=c(1,3,5,7, 2,4,6,8)</span></span>
<span id="cb438-27"><a href="congruence-under-varying-sampling-fraction.html#cb438-27" tabindex="-1"></a>  <span class="co">#pars_to_arrays(pars.hc, 8)$Q[v,v]</span></span>
<span id="cb438-28"><a href="congruence-under-varying-sampling-fraction.html#cb438-28" tabindex="-1"></a>  </span>
<span id="cb438-29"><a href="congruence-under-varying-sampling-fraction.html#cb438-29" tabindex="-1"></a>  <span class="co">#------</span></span>
<span id="cb438-30"><a href="congruence-under-varying-sampling-fraction.html#cb438-30" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb438-31"><a href="congruence-under-varying-sampling-fraction.html#cb438-31" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb438-32"><a href="congruence-under-varying-sampling-fraction.html#cb438-32" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb438-33"><a href="congruence-under-varying-sampling-fraction.html#cb438-33" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb438-34"><a href="congruence-under-varying-sampling-fraction.html#cb438-34" tabindex="-1"></a>  </span>
<span id="cb438-35"><a href="congruence-under-varying-sampling-fraction.html#cb438-35" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,  <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb438-36"><a href="congruence-under-varying-sampling-fraction.html#cb438-36" tabindex="-1"></a>  COR8_C.pars[[i]] <span class="ot">&lt;-</span> <span class="fu">lik.c</span>(pars.hc, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span>T, <span class="at">intermediates=</span>F)</span>
<span id="cb438-37"><a href="congruence-under-varying-sampling-fraction.html#cb438-37" tabindex="-1"></a>  </span>
<span id="cb438-38"><a href="congruence-under-varying-sampling-fraction.html#cb438-38" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 4&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;</code></pre>
<p>Compare Ln</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="congruence-under-varying-sampling-fraction.html#cb440-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.1492 -423.6706 -406.3133 -415.9856 -423.3954 -411.9496 -428.5559 -423.9597 -417.3035 -396.6808</code></pre>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="congruence-under-varying-sampling-fraction.html#cb442-1" tabindex="-1"></a>COR8_C.pars <span class="sc">%&gt;%</span> unlist</span></code></pre></div>
<pre><code>##  [1] -438.1492 -423.6706 -406.3133 -415.9856 -423.3954 -411.9496 -428.5559 -423.9597 -417.3035 -396.6808</code></pre>
</div>
<div id="cor8-nc-4-pars-1" class="section level3 hasAnchor" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> COR8-NC (4 pars)<a href="congruence-under-varying-sampling-fraction.html#cor8-nc-4-pars-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="congruence-under-varying-sampling-fraction.html#cb444-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb444-2"><a href="congruence-under-varying-sampling-fraction.html#cb444-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 8L,</span>
<span id="cb444-3"><a href="congruence-under-varying-sampling-fraction.html#cb444-3" tabindex="-1"></a>  <span class="at">y =</span> sam.fr8)</span>
<span id="cb444-4"><a href="congruence-under-varying-sampling-fraction.html#cb444-4" tabindex="-1"></a></span>
<span id="cb444-5"><a href="congruence-under-varying-sampling-fraction.html#cb444-5" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb444-6"><a href="congruence-under-varying-sampling-fraction.html#cb444-6" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb444-7"><a href="congruence-under-varying-sampling-fraction.html#cb444-7" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">8</span>)</span>
<span id="cb444-8"><a href="congruence-under-varying-sampling-fraction.html#cb444-8" tabindex="-1"></a><span class="co">#args</span></span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="congruence-under-varying-sampling-fraction.html#cb445-1" tabindex="-1"></a>COR8_NC.pars <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb445-2"><a href="congruence-under-varying-sampling-fraction.html#cb445-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb445-3"><a href="congruence-under-varying-sampling-fraction.html#cb445-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSIM){</span>
<span id="cb445-4"><a href="congruence-under-varying-sampling-fraction.html#cb445-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb445-5"><a href="congruence-under-varying-sampling-fraction.html#cb445-5" tabindex="-1"></a>  <span class="co">#-----------</span></span>
<span id="cb445-6"><a href="congruence-under-varying-sampling-fraction.html#cb445-6" tabindex="-1"></a>  est <span class="ot">&lt;-</span> <span class="fu">get_item</span>(CID4[i], <span class="st">&#39;par&#39;</span>)</span>
<span id="cb445-7"><a href="congruence-under-varying-sampling-fraction.html#cb445-7" tabindex="-1"></a>  pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb445-8"><a href="congruence-under-varying-sampling-fraction.html#cb445-8" tabindex="-1"></a>  <span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb445-9"><a href="congruence-under-varying-sampling-fraction.html#cb445-9" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam000&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb445-10"><a href="congruence-under-varying-sampling-fraction.html#cb445-10" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam111&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb445-11"><a href="congruence-under-varying-sampling-fraction.html#cb445-11" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam222&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb445-12"><a href="congruence-under-varying-sampling-fraction.html#cb445-12" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam333&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb445-13"><a href="congruence-under-varying-sampling-fraction.html#cb445-13" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam444&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb445-14"><a href="congruence-under-varying-sampling-fraction.html#cb445-14" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam555&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb445-15"><a href="congruence-under-varying-sampling-fraction.html#cb445-15" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam666&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb445-16"><a href="congruence-under-varying-sampling-fraction.html#cb445-16" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam777&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb445-17"><a href="congruence-under-varying-sampling-fraction.html#cb445-17" tabindex="-1"></a>  pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu4&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu5&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu6&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu7&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;mu0&#39;</span>]</span>
<span id="cb445-18"><a href="congruence-under-varying-sampling-fraction.html#cb445-18" tabindex="-1"></a>  qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cor8_NC.r)</span>
<span id="cb445-19"><a href="congruence-under-varying-sampling-fraction.html#cb445-19" tabindex="-1"></a>  qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb445-20"><a href="congruence-under-varying-sampling-fraction.html#cb445-20" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.1</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q01&#39;</span>]</span>
<span id="cb445-21"><a href="congruence-under-varying-sampling-fraction.html#cb445-21" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.01</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q02&#39;</span>]<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb445-22"><a href="congruence-under-varying-sampling-fraction.html#cb445-22" tabindex="-1"></a>  pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb445-23"><a href="congruence-under-varying-sampling-fraction.html#cb445-23" tabindex="-1"></a>  </span>
<span id="cb445-24"><a href="congruence-under-varying-sampling-fraction.html#cb445-24" tabindex="-1"></a>  <span class="co"># pars.hc</span></span>
<span id="cb445-25"><a href="congruence-under-varying-sampling-fraction.html#cb445-25" tabindex="-1"></a>  <span class="co"># pars_to_arrays(pars.hc, 8)</span></span>
<span id="cb445-26"><a href="congruence-under-varying-sampling-fraction.html#cb445-26" tabindex="-1"></a>  <span class="co"># v=c(1,3,5,7, 2,4,6,8)</span></span>
<span id="cb445-27"><a href="congruence-under-varying-sampling-fraction.html#cb445-27" tabindex="-1"></a>  <span class="co"># pars_to_arrays(pars.hc, 8)$Q[v,v]</span></span>
<span id="cb445-28"><a href="congruence-under-varying-sampling-fraction.html#cb445-28" tabindex="-1"></a>  </span>
<span id="cb445-29"><a href="congruence-under-varying-sampling-fraction.html#cb445-29" tabindex="-1"></a>  <span class="co">#------</span></span>
<span id="cb445-30"><a href="congruence-under-varying-sampling-fraction.html#cb445-30" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb445-31"><a href="congruence-under-varying-sampling-fraction.html#cb445-31" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb445-32"><a href="congruence-under-varying-sampling-fraction.html#cb445-32" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb445-33"><a href="congruence-under-varying-sampling-fraction.html#cb445-33" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb445-34"><a href="congruence-under-varying-sampling-fraction.html#cb445-34" tabindex="-1"></a>  </span>
<span id="cb445-35"><a href="congruence-under-varying-sampling-fraction.html#cb445-35" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,  <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb445-36"><a href="congruence-under-varying-sampling-fraction.html#cb445-36" tabindex="-1"></a>  COR8_NC.pars[[i]] <span class="ot">&lt;-</span> <span class="fu">lik.c</span>(pars.hc, <span class="at">intermediates=</span>F, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span>T)</span>
<span id="cb445-37"><a href="congruence-under-varying-sampling-fraction.html#cb445-37" tabindex="-1"></a>  </span>
<span id="cb445-38"><a href="congruence-under-varying-sampling-fraction.html#cb445-38" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 4&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;</code></pre>
<p>Some helper function to assess the inference parameters</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="congruence-under-varying-sampling-fraction.html#cb447-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.1492 -423.6706 -406.3133 -415.9856 -423.3954 -411.9496 -428.5559 -423.9597 -417.3035 -396.6808</code></pre>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="congruence-under-varying-sampling-fraction.html#cb449-1" tabindex="-1"></a>COR8_NC.pars <span class="sc">%&gt;%</span> unlist</span></code></pre></div>
<pre><code>##  [1] -442.7588 -424.9431 -409.1647 -418.0908 -426.8760 -415.5245 -429.7205 -423.6662 -418.6281 -400.0462</code></pre>
</div>
<div id="cla8-c-4-pars-1" class="section level3 hasAnchor" number="7.5.4">
<h3><span class="header-section-number">7.5.4</span> CLA8-C (4 pars)<a href="congruence-under-varying-sampling-fraction.html#cla8-c-4-pars-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="congruence-under-varying-sampling-fraction.html#cb451-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb451-2"><a href="congruence-under-varying-sampling-fraction.html#cb451-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 8L,</span>
<span id="cb451-3"><a href="congruence-under-varying-sampling-fraction.html#cb451-3" tabindex="-1"></a>  <span class="at">y =</span> sam.fr8)</span>
<span id="cb451-4"><a href="congruence-under-varying-sampling-fraction.html#cb451-4" tabindex="-1"></a></span>
<span id="cb451-5"><a href="congruence-under-varying-sampling-fraction.html#cb451-5" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb451-6"><a href="congruence-under-varying-sampling-fraction.html#cb451-6" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb451-7"><a href="congruence-under-varying-sampling-fraction.html#cb451-7" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">8</span>)</span>
<span id="cb451-8"><a href="congruence-under-varying-sampling-fraction.html#cb451-8" tabindex="-1"></a><span class="co">#args$arrays</span></span>
<span id="cb451-9"><a href="congruence-under-varying-sampling-fraction.html#cb451-9" tabindex="-1"></a><span class="co"># reoder_lambdas(args$arrays, c(1,3,5,7, 2,4,6,8))</span></span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="congruence-under-varying-sampling-fraction.html#cb452-1" tabindex="-1"></a>CLA8_C.pars <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb452-2"><a href="congruence-under-varying-sampling-fraction.html#cb452-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb452-3"><a href="congruence-under-varying-sampling-fraction.html#cb452-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSIM){</span>
<span id="cb452-4"><a href="congruence-under-varying-sampling-fraction.html#cb452-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb452-5"><a href="congruence-under-varying-sampling-fraction.html#cb452-5" tabindex="-1"></a>  <span class="co">#-----------</span></span>
<span id="cb452-6"><a href="congruence-under-varying-sampling-fraction.html#cb452-6" tabindex="-1"></a>  est <span class="ot">&lt;-</span> <span class="fu">get_item</span>(CID4[i], <span class="st">&#39;par&#39;</span>)</span>
<span id="cb452-7"><a href="congruence-under-varying-sampling-fraction.html#cb452-7" tabindex="-1"></a>  pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb452-8"><a href="congruence-under-varying-sampling-fraction.html#cb452-8" tabindex="-1"></a>  <span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb452-9"><a href="congruence-under-varying-sampling-fraction.html#cb452-9" tabindex="-1"></a>  <span class="co"># pars.hc[&#39;lam000&#39;] &lt;- est[&#39;lam000&#39;]</span></span>
<span id="cb452-10"><a href="congruence-under-varying-sampling-fraction.html#cb452-10" tabindex="-1"></a>  <span class="co"># pars.hc[&#39;lam111&#39;] &lt;- est[&#39;lam000&#39;]</span></span>
<span id="cb452-11"><a href="congruence-under-varying-sampling-fraction.html#cb452-11" tabindex="-1"></a>  <span class="co"># pars.hc[&#39;lam222&#39;] &lt;- est[&#39;lam000&#39;]</span></span>
<span id="cb452-12"><a href="congruence-under-varying-sampling-fraction.html#cb452-12" tabindex="-1"></a>  <span class="co"># pars.hc[&#39;lam333&#39;] &lt;- est[&#39;lam000&#39;]</span></span>
<span id="cb452-13"><a href="congruence-under-varying-sampling-fraction.html#cb452-13" tabindex="-1"></a>  <span class="co"># pars.hc[&#39;lam444&#39;] &lt;- est[&#39;lam222&#39;]</span></span>
<span id="cb452-14"><a href="congruence-under-varying-sampling-fraction.html#cb452-14" tabindex="-1"></a>  <span class="co"># pars.hc[&#39;lam555&#39;] &lt;- est[&#39;lam222&#39;]</span></span>
<span id="cb452-15"><a href="congruence-under-varying-sampling-fraction.html#cb452-15" tabindex="-1"></a>  <span class="co"># pars.hc[&#39;lam666&#39;] &lt;- est[&#39;lam222&#39;]</span></span>
<span id="cb452-16"><a href="congruence-under-varying-sampling-fraction.html#cb452-16" tabindex="-1"></a>  <span class="co"># pars.hc[&#39;lam777&#39;] &lt;- est[&#39;lam222&#39;]</span></span>
<span id="cb452-17"><a href="congruence-under-varying-sampling-fraction.html#cb452-17" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam022&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb452-18"><a href="congruence-under-varying-sampling-fraction.html#cb452-18" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam133&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb452-19"><a href="congruence-under-varying-sampling-fraction.html#cb452-19" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam202&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb452-20"><a href="congruence-under-varying-sampling-fraction.html#cb452-20" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam311&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb452-21"><a href="congruence-under-varying-sampling-fraction.html#cb452-21" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam466&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb452-22"><a href="congruence-under-varying-sampling-fraction.html#cb452-22" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam577&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb452-23"><a href="congruence-under-varying-sampling-fraction.html#cb452-23" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam646&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb452-24"><a href="congruence-under-varying-sampling-fraction.html#cb452-24" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam757&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb452-25"><a href="congruence-under-varying-sampling-fraction.html#cb452-25" tabindex="-1"></a>  pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu4&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu5&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu6&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu7&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;mu0&#39;</span>]</span>
<span id="cb452-26"><a href="congruence-under-varying-sampling-fraction.html#cb452-26" tabindex="-1"></a>  qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cor8_C.r)</span>
<span id="cb452-27"><a href="congruence-under-varying-sampling-fraction.html#cb452-27" tabindex="-1"></a>  qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb452-28"><a href="congruence-under-varying-sampling-fraction.html#cb452-28" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.1</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q01&#39;</span>]</span>
<span id="cb452-29"><a href="congruence-under-varying-sampling-fraction.html#cb452-29" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.01</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q02&#39;</span>]<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb452-30"><a href="congruence-under-varying-sampling-fraction.html#cb452-30" tabindex="-1"></a>  pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb452-31"><a href="congruence-under-varying-sampling-fraction.html#cb452-31" tabindex="-1"></a>  </span>
<span id="cb452-32"><a href="congruence-under-varying-sampling-fraction.html#cb452-32" tabindex="-1"></a>  <span class="co"># pars.hc</span></span>
<span id="cb452-33"><a href="congruence-under-varying-sampling-fraction.html#cb452-33" tabindex="-1"></a>  <span class="co"># pars_to_arrays(pars.hc, 8)</span></span>
<span id="cb452-34"><a href="congruence-under-varying-sampling-fraction.html#cb452-34" tabindex="-1"></a>  <span class="co"># v=c(1,3,5,7, 2,4,6,8)</span></span>
<span id="cb452-35"><a href="congruence-under-varying-sampling-fraction.html#cb452-35" tabindex="-1"></a>  <span class="co"># pars_to_arrays(pars.hc, 8)$Q[v,v]</span></span>
<span id="cb452-36"><a href="congruence-under-varying-sampling-fraction.html#cb452-36" tabindex="-1"></a>  </span>
<span id="cb452-37"><a href="congruence-under-varying-sampling-fraction.html#cb452-37" tabindex="-1"></a>  <span class="co">#------</span></span>
<span id="cb452-38"><a href="congruence-under-varying-sampling-fraction.html#cb452-38" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb452-39"><a href="congruence-under-varying-sampling-fraction.html#cb452-39" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb452-40"><a href="congruence-under-varying-sampling-fraction.html#cb452-40" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb452-41"><a href="congruence-under-varying-sampling-fraction.html#cb452-41" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb452-42"><a href="congruence-under-varying-sampling-fraction.html#cb452-42" tabindex="-1"></a>  </span>
<span id="cb452-43"><a href="congruence-under-varying-sampling-fraction.html#cb452-43" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,  <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb452-44"><a href="congruence-under-varying-sampling-fraction.html#cb452-44" tabindex="-1"></a>  CLA8_C.pars[[i]] <span class="ot">&lt;-</span> <span class="fu">lik.c</span>(pars.hc, <span class="at">intermediates=</span>F, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span>T)</span>
<span id="cb452-45"><a href="congruence-under-varying-sampling-fraction.html#cb452-45" tabindex="-1"></a>  </span>
<span id="cb452-46"><a href="congruence-under-varying-sampling-fraction.html#cb452-46" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 4&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;</code></pre>
<p>Some helper function to assess the inference parameters</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="congruence-under-varying-sampling-fraction.html#cb454-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.1492 -423.6706 -406.3133 -415.9856 -423.3954 -411.9496 -428.5559 -423.9597 -417.3035 -396.6808</code></pre>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="congruence-under-varying-sampling-fraction.html#cb456-1" tabindex="-1"></a>CLA8_C.pars <span class="sc">%&gt;%</span> unlist</span></code></pre></div>
<pre><code>##  [1] -438.1492 -423.6706 -406.3133 -415.9856 -423.3954 -411.9496 -428.5559 -423.9597 -417.3035 -396.6808</code></pre>
</div>
<div id="cla8-nc-4-pars-1" class="section level3 hasAnchor" number="7.5.5">
<h3><span class="header-section-number">7.5.5</span> CLA8-NC (4 pars)<a href="congruence-under-varying-sampling-fraction.html#cla8-nc-4-pars-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="congruence-under-varying-sampling-fraction.html#cb458-1" tabindex="-1"></a>Args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb458-2"><a href="congruence-under-varying-sampling-fraction.html#cb458-2" tabindex="-1"></a>  <span class="at">Nstates =</span> 8L,</span>
<span id="cb458-3"><a href="congruence-under-varying-sampling-fraction.html#cb458-3" tabindex="-1"></a>  <span class="at">y =</span> sam.fr8)</span>
<span id="cb458-4"><a href="congruence-under-varying-sampling-fraction.html#cb458-4" tabindex="-1"></a></span>
<span id="cb458-5"><a href="congruence-under-varying-sampling-fraction.html#cb458-5" tabindex="-1"></a>newArgs <span class="ot">&lt;-</span> <span class="fu">makeArgs</span>(Args)</span>
<span id="cb458-6"><a href="congruence-under-varying-sampling-fraction.html#cb458-6" tabindex="-1"></a><span class="co">#printArgsGlobal()</span></span>
<span id="cb458-7"><a href="congruence-under-varying-sampling-fraction.html#cb458-7" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">argnames_HiClaSSE</span>(<span class="dv">8</span>)</span>
<span id="cb458-8"><a href="congruence-under-varying-sampling-fraction.html#cb458-8" tabindex="-1"></a><span class="co">#args$arrays</span></span>
<span id="cb458-9"><a href="congruence-under-varying-sampling-fraction.html#cb458-9" tabindex="-1"></a><span class="co">#v=c(1,3,5,7, 2,4,6,8)</span></span>
<span id="cb458-10"><a href="congruence-under-varying-sampling-fraction.html#cb458-10" tabindex="-1"></a><span class="co">#reoder_lambdas(args$arrays, c(1,3,5,7, 2,4,6,8))</span></span></code></pre></div>
<p>Run inference</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="congruence-under-varying-sampling-fraction.html#cb459-1" tabindex="-1"></a>CLA8_NC.pars <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb459-2"><a href="congruence-under-varying-sampling-fraction.html#cb459-2" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb459-3"><a href="congruence-under-varying-sampling-fraction.html#cb459-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSIM){</span>
<span id="cb459-4"><a href="congruence-under-varying-sampling-fraction.html#cb459-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Working on: &#39;</span>, i))</span>
<span id="cb459-5"><a href="congruence-under-varying-sampling-fraction.html#cb459-5" tabindex="-1"></a>  <span class="co">#-----------</span></span>
<span id="cb459-6"><a href="congruence-under-varying-sampling-fraction.html#cb459-6" tabindex="-1"></a>  est <span class="ot">&lt;-</span> <span class="fu">get_item</span>(CID4[i], <span class="st">&#39;par&#39;</span>)</span>
<span id="cb459-7"><a href="congruence-under-varying-sampling-fraction.html#cb459-7" tabindex="-1"></a>  pars.hc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(args<span class="sc">$</span>pars))</span>
<span id="cb459-8"><a href="congruence-under-varying-sampling-fraction.html#cb459-8" tabindex="-1"></a>  <span class="fu">names</span>(pars.hc) <span class="ot">&lt;-</span> args<span class="sc">$</span>pars</span>
<span id="cb459-9"><a href="congruence-under-varying-sampling-fraction.html#cb459-9" tabindex="-1"></a>  <span class="co"># lam004, lam116, lam422 violate lumpability</span></span>
<span id="cb459-10"><a href="congruence-under-varying-sampling-fraction.html#cb459-10" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam004&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb459-11"><a href="congruence-under-varying-sampling-fraction.html#cb459-11" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam116&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb459-12"><a href="congruence-under-varying-sampling-fraction.html#cb459-12" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam202&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb459-13"><a href="congruence-under-varying-sampling-fraction.html#cb459-13" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam311&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam000&#39;</span>]</span>
<span id="cb459-14"><a href="congruence-under-varying-sampling-fraction.html#cb459-14" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam422&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb459-15"><a href="congruence-under-varying-sampling-fraction.html#cb459-15" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam577&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb459-16"><a href="congruence-under-varying-sampling-fraction.html#cb459-16" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam646&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb459-17"><a href="congruence-under-varying-sampling-fraction.html#cb459-17" tabindex="-1"></a>  pars.hc[<span class="st">&#39;lam757&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;lam222&#39;</span>]</span>
<span id="cb459-18"><a href="congruence-under-varying-sampling-fraction.html#cb459-18" tabindex="-1"></a>  pars.hc[<span class="st">&#39;mu0&#39;</span>] <span class="ot">&lt;-</span>pars.hc[<span class="st">&#39;mu1&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu2&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu3&#39;</span>] <span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu4&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu5&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu6&#39;</span>]<span class="ot">&lt;-</span> pars.hc[<span class="st">&#39;mu7&#39;</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;mu0&#39;</span>]</span>
<span id="cb459-19"><a href="congruence-under-varying-sampling-fraction.html#cb459-19" tabindex="-1"></a>  qs <span class="ot">&lt;-</span> <span class="fu">extract_off_diagonal</span>(Q_cor8_C.r)</span>
<span id="cb459-20"><a href="congruence-under-varying-sampling-fraction.html#cb459-20" tabindex="-1"></a>  qsl<span class="ot">=</span><span class="fu">length</span>(qs)</span>
<span id="cb459-21"><a href="congruence-under-varying-sampling-fraction.html#cb459-21" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.1</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q01&#39;</span>]</span>
<span id="cb459-22"><a href="congruence-under-varying-sampling-fraction.html#cb459-22" tabindex="-1"></a>  qs[qs<span class="sc">==</span><span class="fl">0.01</span>] <span class="ot">&lt;-</span> est[<span class="st">&#39;q02&#39;</span>]<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb459-23"><a href="congruence-under-varying-sampling-fraction.html#cb459-23" tabindex="-1"></a>  pars.hc[<span class="fu">c</span>(<span class="fu">length</span>(pars.hc)<span class="sc">-</span>qsl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(pars.hc)] <span class="ot">&lt;-</span> qs</span>
<span id="cb459-24"><a href="congruence-under-varying-sampling-fraction.html#cb459-24" tabindex="-1"></a>  </span>
<span id="cb459-25"><a href="congruence-under-varying-sampling-fraction.html#cb459-25" tabindex="-1"></a>  <span class="co"># pars.hc</span></span>
<span id="cb459-26"><a href="congruence-under-varying-sampling-fraction.html#cb459-26" tabindex="-1"></a>  <span class="co"># pars_to_arrays(pars.hc, 8)</span></span>
<span id="cb459-27"><a href="congruence-under-varying-sampling-fraction.html#cb459-27" tabindex="-1"></a>  <span class="co"># v=c(1,3,5,7, 2,4,6,8)</span></span>
<span id="cb459-28"><a href="congruence-under-varying-sampling-fraction.html#cb459-28" tabindex="-1"></a>  <span class="co"># pars_to_arrays(pars.hc, 8)$Q[v,v]</span></span>
<span id="cb459-29"><a href="congruence-under-varying-sampling-fraction.html#cb459-29" tabindex="-1"></a>  </span>
<span id="cb459-30"><a href="congruence-under-varying-sampling-fraction.html#cb459-30" tabindex="-1"></a>  <span class="co">#------</span></span>
<span id="cb459-31"><a href="congruence-under-varying-sampling-fraction.html#cb459-31" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> phy[[i]]</span>
<span id="cb459-32"><a href="congruence-under-varying-sampling-fraction.html#cb459-32" tabindex="-1"></a>  states<span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.state</span>
<span id="cb459-33"><a href="congruence-under-varying-sampling-fraction.html#cb459-33" tabindex="-1"></a>  states<span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(states, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) )</span>
<span id="cb459-34"><a href="congruence-under-varying-sampling-fraction.html#cb459-34" tabindex="-1"></a>  root <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb459-35"><a href="congruence-under-varying-sampling-fraction.html#cb459-35" tabindex="-1"></a>  </span>
<span id="cb459-36"><a href="congruence-under-varying-sampling-fraction.html#cb459-36" tabindex="-1"></a>  lik.c <span class="ot">&lt;-</span> <span class="fu">make.HiClasse_cpp</span>(tree, states,  <span class="at">sampling.f=</span><span class="cn">NULL</span>,  <span class="at">strict=</span><span class="cn">TRUE</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">backend =</span> <span class="st">&quot;gslode&quot;</span>), newArgs)</span>
<span id="cb459-37"><a href="congruence-under-varying-sampling-fraction.html#cb459-37" tabindex="-1"></a>  CLA8_NC.pars[[i]] <span class="ot">&lt;-</span> <span class="fu">lik.c</span>(pars.hc, <span class="at">intermediates=</span>F, <span class="at">root=</span>ROOT.GIVEN, <span class="at">root.p=</span>root, <span class="at">condition.surv=</span>T)</span>
<span id="cb459-38"><a href="congruence-under-varying-sampling-fraction.html#cb459-38" tabindex="-1"></a>  </span>
<span id="cb459-39"><a href="congruence-under-varying-sampling-fraction.html#cb459-39" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Working on: 1&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 2&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 3&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 4&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 5&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 6&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 7&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 8&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 9&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;
## [1] &quot;Working on: 10&quot;
## [1] &quot;Recoding: 0010 -&gt; 0.40.70.40.70.40.70.40.70.600.600.600.60&quot;
## [1] &quot;Recoding: 0001 -&gt; 0.40.70.40.70.40.70.40.700.300.300.300.3&quot;</code></pre>
<p>Some helper function to assess the inference parameters</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="congruence-under-varying-sampling-fraction.html#cb461-1" tabindex="-1"></a><span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] -438.1492 -423.6706 -406.3133 -415.9856 -423.3954 -411.9496 -428.5559 -423.9597 -417.3035 -396.6808</code></pre>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="congruence-under-varying-sampling-fraction.html#cb463-1" tabindex="-1"></a>CLA8_NC.pars <span class="sc">%&gt;%</span> unlist</span></code></pre></div>
<pre><code>##  [1] -455.2435 -423.1396 -404.8852 -416.3316 -421.3739 -411.4208 -429.5248 -433.8740 -416.1229 -395.2733</code></pre>
</div>
</div>
<div id="results-3" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Results<a href="congruence-under-varying-sampling-fraction.html#results-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="inferences-using-parameters-from-cid4-4" class="section level3 hasAnchor" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Inferences using parameters from CID4<a href="congruence-under-varying-sampling-fraction.html#inferences-using-parameters-from-cid4-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="likelihood-table-3" class="section level4 hasAnchor" number="7.6.1.1">
<h4><span class="header-section-number">7.6.1.1</span> Likelihood table<a href="congruence-under-varying-sampling-fraction.html#likelihood-table-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="congruence-under-varying-sampling-fraction.html#cb465-1" tabindex="-1"></a>cid4 <span class="ot">=</span> <span class="fu">get_item</span>(CID4, <span class="st">&#39;lnLik&#39;</span>)</span>
<span id="cb465-2"><a href="congruence-under-varying-sampling-fraction.html#cb465-2" tabindex="-1"></a></span>
<span id="cb465-3"><a href="congruence-under-varying-sampling-fraction.html#cb465-3" tabindex="-1"></a>cor.pars <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb465-4"><a href="congruence-under-varying-sampling-fraction.html#cb465-4" tabindex="-1"></a><span class="st">&quot;N&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>NSIM),</span>
<span id="cb465-5"><a href="congruence-under-varying-sampling-fraction.html#cb465-5" tabindex="-1"></a><span class="st">&quot;cid4&quot;</span> <span class="ot">=</span> cid4,</span>
<span id="cb465-6"><a href="congruence-under-varying-sampling-fraction.html#cb465-6" tabindex="-1"></a><span class="st">&quot;CID8.pars&quot;</span><span class="ot">=</span> CID8.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb465-7"><a href="congruence-under-varying-sampling-fraction.html#cb465-7" tabindex="-1"></a><span class="st">&quot;COR8-C.pars&quot;</span><span class="ot">=</span> COR8_C.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb465-8"><a href="congruence-under-varying-sampling-fraction.html#cb465-8" tabindex="-1"></a><span class="st">&quot;CLA8-C.pars&quot;</span> <span class="ot">=</span> CLA8_C.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb465-9"><a href="congruence-under-varying-sampling-fraction.html#cb465-9" tabindex="-1"></a><span class="st">&quot;COR8-NC.pars&quot;</span> <span class="ot">=</span> COR8_NC.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb465-10"><a href="congruence-under-varying-sampling-fraction.html#cb465-10" tabindex="-1"></a><span class="st">&quot;CLA8-NC.pars&quot;</span> <span class="ot">=</span> CLA8_NC.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb465-11"><a href="congruence-under-varying-sampling-fraction.html#cb465-11" tabindex="-1"></a>)</span>
<span id="cb465-12"><a href="congruence-under-varying-sampling-fraction.html#cb465-12" tabindex="-1"></a></span>
<span id="cb465-13"><a href="congruence-under-varying-sampling-fraction.html#cb465-13" tabindex="-1"></a><span class="fu">kable</span>(cor.pars, <span class="st">&quot;html&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb465-14"><a href="congruence-under-varying-sampling-fraction.html#cb465-14" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>))</span></code></pre></div>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
cid4
</th>
<th style="text-align:right;">
CID8.pars
</th>
<th style="text-align:right;">
COR8-C.pars
</th>
<th style="text-align:right;">
CLA8-C.pars
</th>
<th style="text-align:right;">
COR8-NC.pars
</th>
<th style="text-align:right;">
CLA8-NC.pars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-438.1492
</td>
<td style="text-align:right;">
-438.1492
</td>
<td style="text-align:right;">
-438.1492
</td>
<td style="text-align:right;">
-438.1492
</td>
<td style="text-align:right;">
-442.7588
</td>
<td style="text-align:right;">
-455.2435
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-423.6706
</td>
<td style="text-align:right;">
-423.6706
</td>
<td style="text-align:right;">
-423.6706
</td>
<td style="text-align:right;">
-423.6706
</td>
<td style="text-align:right;">
-424.9431
</td>
<td style="text-align:right;">
-423.1396
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-406.3133
</td>
<td style="text-align:right;">
-406.3133
</td>
<td style="text-align:right;">
-406.3133
</td>
<td style="text-align:right;">
-406.3133
</td>
<td style="text-align:right;">
-409.1647
</td>
<td style="text-align:right;">
-404.8852
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-415.9856
</td>
<td style="text-align:right;">
-415.9856
</td>
<td style="text-align:right;">
-415.9856
</td>
<td style="text-align:right;">
-415.9856
</td>
<td style="text-align:right;">
-418.0908
</td>
<td style="text-align:right;">
-416.3316
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-423.3954
</td>
<td style="text-align:right;">
-423.3954
</td>
<td style="text-align:right;">
-423.3954
</td>
<td style="text-align:right;">
-423.3954
</td>
<td style="text-align:right;">
-426.8760
</td>
<td style="text-align:right;">
-421.3739
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-411.9496
</td>
<td style="text-align:right;">
-411.9496
</td>
<td style="text-align:right;">
-411.9496
</td>
<td style="text-align:right;">
-411.9496
</td>
<td style="text-align:right;">
-415.5245
</td>
<td style="text-align:right;">
-411.4208
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
-428.5559
</td>
<td style="text-align:right;">
-428.5559
</td>
<td style="text-align:right;">
-428.5559
</td>
<td style="text-align:right;">
-428.5559
</td>
<td style="text-align:right;">
-429.7205
</td>
<td style="text-align:right;">
-429.5248
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
-423.9597
</td>
<td style="text-align:right;">
-423.9597
</td>
<td style="text-align:right;">
-423.9597
</td>
<td style="text-align:right;">
-423.9597
</td>
<td style="text-align:right;">
-423.6662
</td>
<td style="text-align:right;">
-433.8740
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
-417.3035
</td>
<td style="text-align:right;">
-417.3035
</td>
<td style="text-align:right;">
-417.3035
</td>
<td style="text-align:right;">
-417.3035
</td>
<td style="text-align:right;">
-418.6281
</td>
<td style="text-align:right;">
-416.1229
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
-396.6808
</td>
<td style="text-align:right;">
-396.6808
</td>
<td style="text-align:right;">
-396.6808
</td>
<td style="text-align:right;">
-396.6808
</td>
<td style="text-align:right;">
-400.0462
</td>
<td style="text-align:right;">
-395.2733
</td>
</tr>
</tbody>
</table>
</div>
<div id="mean-absolute-error-3" class="section level4 hasAnchor" number="7.6.1.2">
<h4><span class="header-section-number">7.6.1.2</span> Mean absolute error<a href="congruence-under-varying-sampling-fraction.html#mean-absolute-error-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="congruence-under-varying-sampling-fraction.html#cb466-1" tabindex="-1"></a>dcor.pars <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb466-2"><a href="congruence-under-varying-sampling-fraction.html#cb466-2" tabindex="-1"></a><span class="st">&quot;cid4&quot;</span> <span class="ot">=</span> cid4,</span>
<span id="cb466-3"><a href="congruence-under-varying-sampling-fraction.html#cb466-3" tabindex="-1"></a><span class="st">&quot;CID8.pars&quot;</span><span class="ot">=</span> CID8.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb466-4"><a href="congruence-under-varying-sampling-fraction.html#cb466-4" tabindex="-1"></a><span class="st">&quot;COR8-C.pars&quot;</span><span class="ot">=</span> COR8_C.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb466-5"><a href="congruence-under-varying-sampling-fraction.html#cb466-5" tabindex="-1"></a><span class="st">&quot;CLA8-C.pars&quot;</span> <span class="ot">=</span> CLA8_C.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb466-6"><a href="congruence-under-varying-sampling-fraction.html#cb466-6" tabindex="-1"></a><span class="st">&quot;COR8-NC.pars&quot;</span> <span class="ot">=</span> COR8_NC.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb466-7"><a href="congruence-under-varying-sampling-fraction.html#cb466-7" tabindex="-1"></a><span class="st">&quot;CLA8-NC.pars&quot;</span> <span class="ot">=</span> CLA8_NC.pars <span class="sc">%&gt;%</span> unlist,</span>
<span id="cb466-8"><a href="congruence-under-varying-sampling-fraction.html#cb466-8" tabindex="-1"></a>)</span>
<span id="cb466-9"><a href="congruence-under-varying-sampling-fraction.html#cb466-9" tabindex="-1"></a>cid4t <span class="ot">&lt;-</span> cid4</span>
<span id="cb466-10"><a href="congruence-under-varying-sampling-fraction.html#cb466-10" tabindex="-1"></a>dcor.pars <span class="ot">&lt;-</span> dcor.pars <span class="sc">%&gt;%</span></span>
<span id="cb466-11"><a href="congruence-under-varying-sampling-fraction.html#cb466-11" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="sc">~</span> <span class="fu">abs</span>(cid4t <span class="sc">-</span> .) )</span>
<span id="cb466-12"><a href="congruence-under-varying-sampling-fraction.html#cb466-12" tabindex="-1"></a></span>
<span id="cb466-13"><a href="congruence-under-varying-sampling-fraction.html#cb466-13" tabindex="-1"></a>column_means <span class="ot">&lt;-</span> dcor.pars <span class="sc">%&gt;%</span></span>
<span id="cb466-14"><a href="congruence-under-varying-sampling-fraction.html#cb466-14" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="sc">~</span> <span class="fu">mean</span>(.))</span>
<span id="cb466-15"><a href="congruence-under-varying-sampling-fraction.html#cb466-15" tabindex="-1"></a></span>
<span id="cb466-16"><a href="congruence-under-varying-sampling-fraction.html#cb466-16" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb466-17"><a href="congruence-under-varying-sampling-fraction.html#cb466-17" tabindex="-1"></a>delta_values <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb466-18"><a href="congruence-under-varying-sampling-fraction.html#cb466-18" tabindex="-1"></a>  <span class="at">Delta =</span> <span class="fu">names</span>(column_means),</span>
<span id="cb466-19"><a href="congruence-under-varying-sampling-fraction.html#cb466-19" tabindex="-1"></a>  <span class="at">Value =</span> column_means <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb466-20"><a href="congruence-under-varying-sampling-fraction.html#cb466-20" tabindex="-1"></a>)</span>
<span id="cb466-21"><a href="congruence-under-varying-sampling-fraction.html#cb466-21" tabindex="-1"></a></span>
<span id="cb466-22"><a href="congruence-under-varying-sampling-fraction.html#cb466-22" tabindex="-1"></a><span class="fu">kable</span>(column_means, <span class="st">&quot;html&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb466-23"><a href="congruence-under-varying-sampling-fraction.html#cb466-23" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>))</span></code></pre></div>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cid4
</th>
<th style="text-align:right;">
CID8.pars
</th>
<th style="text-align:right;">
COR8-C.pars
</th>
<th style="text-align:right;">
CLA8-C.pars
</th>
<th style="text-align:right;">
COR8-NC.pars
</th>
<th style="text-align:right;">
CLA8-NC.pars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1e-07
</td>
<td style="text-align:right;">
1e-07
</td>
<td style="text-align:right;">
1e-07
</td>
<td style="text-align:right;">
2.404245
</td>
<td style="text-align:right;">
3.542092
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="congruence-under-varying-sampling-fraction.html#cb467-1" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb467-2"><a href="congruence-under-varying-sampling-fraction.html#cb467-2" tabindex="-1"></a><span class="fu">ggplot</span>(delta_values, <span class="fu">aes</span>(<span class="at">x =</span> Delta, <span class="at">y =</span> Value, <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.2e&quot;</span>, Value))) <span class="sc">+</span></span>
<span id="cb467-3"><a href="congruence-under-varying-sampling-fraction.html#cb467-3" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>,  <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb467-4"><a href="congruence-under-varying-sampling-fraction.html#cb467-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">angle =</span> <span class="dv">45</span>) <span class="sc">+</span></span>
<span id="cb467-5"><a href="congruence-under-varying-sampling-fraction.html#cb467-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Comparison of Ln Differences&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Deltas&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Magnitude&quot;</span>) <span class="sc">+</span></span>
<span id="cb467-6"><a href="congruence-under-varying-sampling-fraction.html#cb467-6" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="semi-congruent-behavior.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
