% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Report for Simulations using HiClaSSE model},
  pdfauthor={Sergei Tarasov},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Report for Simulations using HiClaSSE model}
\author{Sergei Tarasov}
\date{2024-02-29}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{2}
\tableofcontents
}
\hypertarget{setting-up-hiclasse}{%
\section{Setting-up HiClaSSE}\label{setting-up-hiclasse}}

The HiClaSSE model is implemented using the diversitree package framework. To reproduce the examples, you will most likely need to compile the C code for HiClaSSE on your computer yourself. The instruction below works on Mac.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Compile the \texttt{hiclasse\_c.c} file located in the \texttt{R/hiclasse/src} directory by running this command in your terminal: \texttt{R\ CMD\ SHLIB\ hiclasse\_c.c}
\item
  Next, copy the two files \texttt{hiclasse\_c.o} and \texttt{hiclasse\_c.so} to the \texttt{R/hiclasse/} folder. Replace the existing files if necessary.
\end{enumerate}

Now you can execute the provided R examples, and they should work.

\hypertarget{congruence-between-independent-and-dependent-sses}{%
\section{Congruence between independent and dependent SSEs}\label{congruence-between-independent-and-dependent-sses}}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.0855}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.0342}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.2735}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1795}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1538}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.2735}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Model
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
np
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
pars
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Cong. with CID4
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Trait \& Div.
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Speciation Rates
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
CID4 & 4 & 2λd 1q 1μ & -- & independent & decoupled (λd) \\
CID8 & 4 & 2λd 1q 1μ & yes & independent & decoupled (λd) \\
COR8-C & 4 & 2λd 1q 1μ & yes & correlated & decoupled (λd) \\
CLA8-C & 4 & 2λc 1q 1μ & yes & correlated & coupled (λc) \\
COR8-NC & 4 & 2λd 1q 1μ & no & correlated* & decoupled (λd) \\
CLA8-NC & 4 & 2λc 1q 1μ & no & correlated & coupled* (λc) \\
\end{longtable}

*indicates non-lumpable transition or speciation rates. See also, Fig. referenced and Table S1.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}}
\DocumentationTok{\#\#  \textasciitilde{} installations and dependencies  {-}{-}{-}{-}}
\DocumentationTok{\#\#\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}}
\FunctionTok{source}\NormalTok{(}\StringTok{\textquotesingle{}R/utils/dependencies.R\textquotesingle{}}\NormalTok{)}
\FunctionTok{source}\NormalTok{(}\StringTok{\textquotesingle{}R/hiclasse/HiClaSSE{-}R.R\textquotesingle{}}\NormalTok{) }\CommentTok{\# pure R implementation of HiCLaSSE}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Original matrix:"
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
## [1] "Matrix with right diagonal set to zero:"
##      [,1] [,2] [,3]
## [1,]    1    4    0
## [2,]    2    0    8
## [3,]    0    6    9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{source}\NormalTok{(}\StringTok{\textquotesingle{}R/hiclasse/HiClaSSE\_cpp.R\textquotesingle{}}\NormalTok{) }\CommentTok{\# fast implementation}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Original matrix:"
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
## [1] "Matrix with right diagonal set to zero:"
##      [,1] [,2] [,3]
## [1,]    1    4    0
## [2,]    2    0    8
## [3,]    0    6    9
## [1] TRUE
## [1] TRUE
## [1] TRUE
## [1] TRUE
\end{verbatim}

\hypertarget{read-in-data}{%
\subsection{Read in data}\label{read-in-data}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{NSIM }\OtherTok{=} \DecValTok{10}
\NormalTok{phy }\OtherTok{\textless{}{-}} \FunctionTok{readRDS}\NormalTok{(}\AttributeTok{file=}\StringTok{\textquotesingle{}R/data/phy\_CID4.RDS\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{setting-up-q-matrices-for-inference}{%
\subsection{Setting-up Q matrices for inference}\label{setting-up-q-matrices-for-inference}}

\hypertarget{cid4}{%
\subsubsection{CID4}\label{cid4}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# trait}
\NormalTok{Q\_t }\OtherTok{\textless{}{-}} \FunctionTok{initQ}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{), }\FunctionTok{c}\NormalTok{(.}\DecValTok{1}\NormalTok{, .}\DecValTok{1}\NormalTok{))}

\CommentTok{\# diversification regime}
\NormalTok{Q\_r2 }\OtherTok{\textless{}{-}} \FunctionTok{initQ}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}A\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}B\textquotesingle{}}\NormalTok{), }\FunctionTok{c}\NormalTok{(.}\DecValTok{1}\NormalTok{,.}\DecValTok{1}\NormalTok{))}


\CommentTok{\# speciation rates for tracking the order}
\NormalTok{La4 }\OtherTok{\textless{}{-}} \FunctionTok{diag}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.1}\NormalTok{,}\SpecialCharTok{{-}}\FloatTok{0.05}\NormalTok{),}\DecValTok{2}\NormalTok{)}
\NormalTok{La4 }\OtherTok{=}\NormalTok{ La4 }\SpecialCharTok{\%x\%} \FunctionTok{diag}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{)}
\CommentTok{\# order according to regimes}
\NormalTok{Q\_cid4.r }\OtherTok{\textless{}{-}} \FunctionTok{amaSMM}\NormalTok{(Q\_r2, Q\_t)}

\CommentTok{\# order according to trait}
\NormalTok{v}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{)}
\NormalTok{Q\_cid4.t }\OtherTok{\textless{}{-}}\NormalTok{ Q\_cid4.r[v,v]}

\FunctionTok{print}\NormalTok{(Q\_cid4.r)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      A0   A1   B0   B1
## A0 -0.2  0.1  0.1  0.0
## A1  0.1 -0.2  0.0  0.1
## B0  0.1  0.0 -0.2  0.1
## B1  0.0  0.1  0.1 -0.2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(La4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]  [,3]  [,4]
## [1,] -0.1  0.0  0.00  0.00
## [2,]  0.0 -0.1  0.00  0.00
## [3,]  0.0  0.0 -0.05  0.00
## [4,]  0.0  0.0  0.00 -0.05
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(Q\_cid4.t)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      A0   B0   A1   B1
## A0 -0.2  0.1  0.1  0.0
## B0  0.1 -0.2  0.0  0.1
## A1  0.1  0.0 -0.2  0.1
## B1  0.0  0.1  0.1 -0.2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(La4[v,v])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1]  [,2] [,3]  [,4]
## [1,] -0.1  0.00  0.0  0.00
## [2,]  0.0 -0.05  0.0  0.00
## [3,]  0.0  0.00 -0.1  0.00
## [4,]  0.0  0.00  0.0 -0.05
\end{verbatim}

\hypertarget{cid8-congruent-to-cid4}{%
\subsubsection{CID8 (congruent to CID4)}\label{cid8-congruent-to-cid4}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# diversification regime}
\CommentTok{\#Q\_r4 \textless{}{-} initQ(c(\textquotesingle{}a\textquotesingle{},\textquotesingle{}b\textquotesingle{}, \textquotesingle{}c\textquotesingle{}, \textquotesingle{}d\textquotesingle{}), c(.01,.01))}

\NormalTok{Q\_r4 }\OtherTok{\textless{}{-}}\FunctionTok{amaSMM}\NormalTok{(Q\_t, Q\_t) }
\FunctionTok{colnames}\NormalTok{(Q\_r4) }\OtherTok{\textless{}{-}} \FunctionTok{rownames}\NormalTok{(Q\_r4) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}a\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}b\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}c\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}d\textquotesingle{}}\NormalTok{)}

\CommentTok{\# speciation rates for tracking the order}
\NormalTok{La8 }\OtherTok{\textless{}{-}} \FunctionTok{diag}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.1}\NormalTok{,}\SpecialCharTok{{-}}\FloatTok{0.05}\NormalTok{),}\DecValTok{2}\NormalTok{)}
\NormalTok{La8 }\OtherTok{=}\NormalTok{ La8 }\SpecialCharTok{\%x\%} \FunctionTok{diag}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{4}\NormalTok{)}

\CommentTok{\# order according to regimes}
\NormalTok{Q\_cid8.r }\OtherTok{\textless{}{-}} \FunctionTok{amaSMM}\NormalTok{(Q\_r4, Q\_t) }

\CommentTok{\# order according to trait}
\NormalTok{v}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{7}\NormalTok{, }\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{8}\NormalTok{)}
\NormalTok{Q\_cid8.t }\OtherTok{\textless{}{-}}\NormalTok{ Q\_cid8.r[v,v]}

\FunctionTok{print}\NormalTok{(Q\_cid8.r)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      a0   a1   b0   b1   c0   c1   d0   d1
## a0 -0.3  0.1  0.1  0.0  0.1  0.0  0.0  0.0
## a1  0.1 -0.3  0.0  0.1  0.0  0.1  0.0  0.0
## b0  0.1  0.0 -0.3  0.1  0.0  0.0  0.1  0.0
## b1  0.0  0.1  0.1 -0.3  0.0  0.0  0.0  0.1
## c0  0.1  0.0  0.0  0.0 -0.3  0.1  0.1  0.0
## c1  0.0  0.1  0.0  0.0  0.1 -0.3  0.0  0.1
## d0  0.0  0.0  0.1  0.0  0.1  0.0 -0.3  0.1
## d1  0.0  0.0  0.0  0.1  0.0  0.1  0.1 -0.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(La8)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3] [,4]  [,5]  [,6]  [,7]  [,8]
## [1,] -0.1  0.0  0.0  0.0  0.00  0.00  0.00  0.00
## [2,]  0.0 -0.1  0.0  0.0  0.00  0.00  0.00  0.00
## [3,]  0.0  0.0 -0.1  0.0  0.00  0.00  0.00  0.00
## [4,]  0.0  0.0  0.0 -0.1  0.00  0.00  0.00  0.00
## [5,]  0.0  0.0  0.0  0.0 -0.05  0.00  0.00  0.00
## [6,]  0.0  0.0  0.0  0.0  0.00 -0.05  0.00  0.00
## [7,]  0.0  0.0  0.0  0.0  0.00  0.00 -0.05  0.00
## [8,]  0.0  0.0  0.0  0.0  0.00  0.00  0.00 -0.05
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(Q\_cid8.t)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      a0   b0   c0   d0   a1   b1   c1   d1
## a0 -0.3  0.1  0.1  0.0  0.1  0.0  0.0  0.0
## b0  0.1 -0.3  0.0  0.1  0.0  0.1  0.0  0.0
## c0  0.1  0.0 -0.3  0.1  0.0  0.0  0.1  0.0
## d0  0.0  0.1  0.1 -0.3  0.0  0.0  0.0  0.1
## a1  0.1  0.0  0.0  0.0 -0.3  0.1  0.1  0.0
## b1  0.0  0.1  0.0  0.0  0.1 -0.3  0.0  0.1
## c1  0.0  0.0  0.1  0.0  0.1  0.0 -0.3  0.1
## d1  0.0  0.0  0.0  0.1  0.0  0.1  0.1 -0.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(La8[v,v])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]  [,3]  [,4] [,5] [,6]  [,7]  [,8]
## [1,] -0.1  0.0  0.00  0.00  0.0  0.0  0.00  0.00
## [2,]  0.0 -0.1  0.00  0.00  0.0  0.0  0.00  0.00
## [3,]  0.0  0.0 -0.05  0.00  0.0  0.0  0.00  0.00
## [4,]  0.0  0.0  0.00 -0.05  0.0  0.0  0.00  0.00
## [5,]  0.0  0.0  0.00  0.00 -0.1  0.0  0.00  0.00
## [6,]  0.0  0.0  0.00  0.00  0.0 -0.1  0.00  0.00
## [7,]  0.0  0.0  0.00  0.00  0.0  0.0 -0.05  0.00
## [8,]  0.0  0.0  0.00  0.00  0.0  0.0  0.00 -0.05
\end{verbatim}

\hypertarget{cor8-c-correlated-evolution-congruent-to-cid4}{%
\subsubsection{COR8-C (correlated evolution, congruent to CID4)}\label{cor8-c-correlated-evolution-congruent-to-cid4}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# like CID8 but with correlation}
\NormalTok{Q\_cor8\_C.t }\OtherTok{\textless{}{-}}\NormalTok{ Q\_cid8.t}

\NormalTok{bl }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,.}\DecValTok{1}\NormalTok{,.}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{)}
\NormalTok{Q\_cor8\_C.t[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{,}\DecValTok{5}\SpecialCharTok{:}\DecValTok{6}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ bl}
\NormalTok{Q\_cor8\_C.t[}\DecValTok{3}\SpecialCharTok{:}\DecValTok{4}\NormalTok{,}\DecValTok{7}\SpecialCharTok{:}\DecValTok{8}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ bl}
\NormalTok{Q\_cor8\_C.t[}\DecValTok{5}\SpecialCharTok{:}\DecValTok{6}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ bl}
\NormalTok{Q\_cor8\_C.t[}\DecValTok{7}\SpecialCharTok{:}\DecValTok{8}\NormalTok{,}\DecValTok{3}\SpecialCharTok{:}\DecValTok{4}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ bl}

\NormalTok{v}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{5}\NormalTok{, }\DecValTok{2}\NormalTok{,}\DecValTok{6}\NormalTok{, }\DecValTok{3}\NormalTok{,}\DecValTok{7}\NormalTok{, }\DecValTok{4}\NormalTok{,}\DecValTok{8}\NormalTok{)}
\NormalTok{Q\_cor8\_C.r }\OtherTok{\textless{}{-}}\NormalTok{ Q\_cor8\_C.t[v,v]}

\FunctionTok{print}\NormalTok{(Q\_cor8\_C.r)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      a0   a1   b0   b1   c0   c1   d0   d1
## a0 -0.3  0.0  0.1  0.1  0.1  0.0  0.0  0.0
## a1  0.0 -0.3  0.1  0.1  0.0  0.1  0.0  0.0
## b0  0.1  0.1 -0.3  0.0  0.0  0.0  0.1  0.0
## b1  0.1  0.1  0.0 -0.3  0.0  0.0  0.0  0.1
## c0  0.1  0.0  0.0  0.0 -0.3  0.0  0.1  0.1
## c1  0.0  0.1  0.0  0.0  0.0 -0.3  0.1  0.1
## d0  0.0  0.0  0.1  0.0  0.1  0.1 -0.3  0.0
## d1  0.0  0.0  0.0  0.1  0.1  0.1  0.0 -0.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#print(La8)}
\FunctionTok{print}\NormalTok{(Q\_cor8\_C.t)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      a0   b0   c0   d0   a1   b1   c1   d1
## a0 -0.3  0.1  0.1  0.0  0.0  0.1  0.0  0.0
## b0  0.1 -0.3  0.0  0.1  0.1  0.0  0.0  0.0
## c0  0.1  0.0 -0.3  0.1  0.0  0.0  0.0  0.1
## d0  0.0  0.1  0.1 -0.3  0.0  0.0  0.1  0.0
## a1  0.0  0.1  0.0  0.0 -0.3  0.1  0.1  0.0
## b1  0.1  0.0  0.0  0.0  0.1 -0.3  0.0  0.1
## c1  0.0  0.0  0.0  0.1  0.1  0.0 -0.3  0.1
## d1  0.0  0.0  0.1  0.0  0.0  0.1  0.1 -0.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#print(La8[v,v])}
\end{Highlighting}
\end{Shaded}

\hypertarget{cor8-nc-non-correlated-evolution-congruent-to-cid4}{%
\subsubsection{COR8-NC (Non-correlated evolution, congruent to CID4)}\label{cor8-nc-non-correlated-evolution-congruent-to-cid4}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# like CID8 but not congruent}
\NormalTok{Q\_cor8\_NC.t }\OtherTok{\textless{}{-}}\NormalTok{ Q\_cid8.t}

\NormalTok{bl }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,.}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{)}
\NormalTok{Q\_cor8\_NC.t[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{,}\DecValTok{5}\SpecialCharTok{:}\DecValTok{6}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ bl}
\NormalTok{Q\_cor8\_NC.t[}\DecValTok{3}\SpecialCharTok{:}\DecValTok{4}\NormalTok{,}\DecValTok{7}\SpecialCharTok{:}\DecValTok{8}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ bl}
\NormalTok{Q\_cor8\_NC.t[}\DecValTok{5}\SpecialCharTok{:}\DecValTok{6}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ bl}
\NormalTok{Q\_cor8\_NC.t[}\DecValTok{7}\SpecialCharTok{:}\DecValTok{8}\NormalTok{,}\DecValTok{3}\SpecialCharTok{:}\DecValTok{4}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ bl}

\NormalTok{v}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{5}\NormalTok{, }\DecValTok{2}\NormalTok{,}\DecValTok{6}\NormalTok{, }\DecValTok{3}\NormalTok{,}\DecValTok{7}\NormalTok{, }\DecValTok{4}\NormalTok{,}\DecValTok{8}\NormalTok{)}
\NormalTok{Q\_cor8\_NC.r }\OtherTok{\textless{}{-}}\NormalTok{ Q\_cor8\_NC.t[v,v]}

\FunctionTok{print}\NormalTok{(Q\_cor8\_NC.r)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      a0   a1   b0   b1   c0   c1   d0   d1
## a0 -0.3  0.0  0.1  0.1  0.1  0.0  0.0  0.0
## a1  0.0 -0.3  0.1  0.1  0.0  0.1  0.0  0.0
## b0  0.1  0.0 -0.3  0.0  0.0  0.0  0.1  0.0
## b1  0.0  0.1  0.0 -0.3  0.0  0.0  0.0  0.1
## c0  0.1  0.0  0.0  0.0 -0.3  0.0  0.1  0.1
## c1  0.0  0.1  0.0  0.0  0.0 -0.3  0.1  0.1
## d0  0.0  0.0  0.1  0.0  0.1  0.0 -0.3  0.0
## d1  0.0  0.0  0.0  0.1  0.0  0.1  0.0 -0.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#print(La8)}
\FunctionTok{print}\NormalTok{(Q\_cor8\_NC.t)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      a0   b0   c0   d0   a1   b1   c1   d1
## a0 -0.3  0.1  0.1  0.0  0.0  0.1  0.0  0.0
## b0  0.1 -0.3  0.0  0.1  0.0  0.0  0.0  0.0
## c0  0.1  0.0 -0.3  0.1  0.0  0.0  0.0  0.1
## d0  0.0  0.1  0.1 -0.3  0.0  0.0  0.0  0.0
## a1  0.0  0.1  0.0  0.0 -0.3  0.1  0.1  0.0
## b1  0.0  0.0  0.0  0.0  0.1 -0.3  0.0  0.1
## c1  0.0  0.0  0.0  0.1  0.1  0.0 -0.3  0.1
## d1  0.0  0.0  0.0  0.0  0.0  0.1  0.1 -0.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#print(La8[v,v])}
\end{Highlighting}
\end{Shaded}

\hypertarget{irreducible-model}{%
\subsection{Irreducible model}\label{irreducible-model}}

\hypertarget{cid4-4-pars}{%
\subsubsection{CID4 (4 pars)}\label{cid4-4-pars}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Args }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{Nstates =}\NormalTok{ 4L,}
  \AttributeTok{y =} \FunctionTok{list}\NormalTok{(}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{),}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{  ))}

\NormalTok{newArgs }\OtherTok{\textless{}{-}} \FunctionTok{makeArgs}\NormalTok{(Args)}
\CommentTok{\#printArgsGlobal()}
\NormalTok{args }\OtherTok{\textless{}{-}} \FunctionTok{argnames\_HiClaSSE}\NormalTok{(}\DecValTok{4}\NormalTok{)}
\CommentTok{\#args$arrays}
\CommentTok{\#args$pars}
\CommentTok{\#length(args$pars)}
\FunctionTok{reoder\_lambdas}\NormalTok{(args}\SpecialCharTok{$}\NormalTok{arrays, }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $lam.tensor
## $lam.tensor[[1]]
##      [,1]     [,2]     [,3]     [,4]    
## [1,] "lam000" "lam002" "lam001" "lam003"
## [2,] "0"      "lam022" "0"      "lam023"
## [3,] "0"      "lam012" "lam011" "lam013"
## [4,] "0"      "0"      "0"      "lam033"
## 
## $lam.tensor[[2]]
##      [,1]     [,2]     [,3]     [,4]    
## [1,] "lam200" "lam202" "lam201" "lam203"
## [2,] "0"      "lam222" "0"      "lam223"
## [3,] "0"      "lam212" "lam211" "lam213"
## [4,] "0"      "0"      "0"      "lam233"
## 
## $lam.tensor[[3]]
##      [,1]     [,2]     [,3]     [,4]    
## [1,] "lam100" "lam102" "lam101" "lam103"
## [2,] "0"      "lam122" "0"      "lam123"
## [3,] "0"      "lam112" "lam111" "lam113"
## [4,] "0"      "0"      "0"      "lam133"
## 
## $lam.tensor[[4]]
##      [,1]     [,2]     [,3]     [,4]    
## [1,] "lam300" "lam302" "lam301" "lam303"
## [2,] "0"      "lam322" "0"      "lam323"
## [3,] "0"      "lam312" "lam311" "lam313"
## [4,] "0"      "0"      "0"      "lam333"
## 
## 
## $mu
## [1] "mu0" "mu2" "mu1" "mu3"
## 
## $Q
##      [,1]  [,2]  [,3]  [,4] 
## [1,] "0"   "q02" "q01" "q03"
## [2,] "q20" "0"   "q21" "q23"
## [3,] "q10" "q12" "0"   "q13"
## [4,] "q30" "q32" "q31" "0"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pars.hc }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{length}\NormalTok{(args}\SpecialCharTok{$}\NormalTok{pars))}
\FunctionTok{names}\NormalTok{(pars.hc) }\OtherTok{\textless{}{-}}\NormalTok{ args}\SpecialCharTok{$}\NormalTok{pars}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam111\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam333\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu0\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu1\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu2\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu3\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\FloatTok{0.1}
\NormalTok{qs }\OtherTok{\textless{}{-}} \FunctionTok{extract\_off\_diagonal}\NormalTok{(Q\_cid4.r)}
\NormalTok{qsl}\OtherTok{=}\FunctionTok{length}\NormalTok{(qs)}
\NormalTok{pars.hc[}\FunctionTok{c}\NormalTok{(}\FunctionTok{length}\NormalTok{(pars.hc)}\SpecialCharTok{{-}}\NormalTok{qsl}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pars.hc)] }\OtherTok{\textless{}{-}}\NormalTok{ qs}

\CommentTok{\#pars.hc}
\CommentTok{\#pars\_to\_arrays(pars.hc,4)}
\CommentTok{\#args}

\NormalTok{zero.constr }\OtherTok{\textless{}{-}} \FunctionTok{formulas\_zero\_pars}\NormalTok{(pars.hc)}
\NormalTok{f.qs }\OtherTok{\textless{}{-}} \FunctionTok{assign\_classes\_pairwise}\NormalTok{(Q\_cid4.r, args}\SpecialCharTok{$}\NormalTok{arrays}\SpecialCharTok{$}\NormalTok{Q)}
\NormalTok{f.mu }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(mu1 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu2 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu3 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0)}
\NormalTok{f.lams }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(lam111 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam000, lam333 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam222)}
\NormalTok{f.list}\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(zero.constr,  f.qs, f.mu, f.lams)}
\end{Highlighting}
\end{Shaded}

Run inference

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{CID4 }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
\NormalTok{i}\OtherTok{=}\DecValTok{1}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{NSIM)\{}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{\textquotesingle{}Working on: \textquotesingle{}}\NormalTok{, i))}
\NormalTok{  tree }\OtherTok{\textless{}{-}}\NormalTok{ phy[[i]]}
\NormalTok{  states}\OtherTok{\textless{}{-}}\NormalTok{ tree}\SpecialCharTok{$}\NormalTok{tip.state}
\NormalTok{  states}\OtherTok{\textless{}{-}} \FunctionTok{mapvalues}\NormalTok{(states, }\AttributeTok{from =} \FunctionTok{c}\NormalTok{(}\StringTok{"0"}\NormalTok{, }\StringTok{"1"}\NormalTok{, }\StringTok{"2"}\NormalTok{, }\StringTok{"3"}\NormalTok{), }\AttributeTok{to=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{) )}
\NormalTok{  root }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\DecValTok{4}\NormalTok{, }\DecValTok{1}\SpecialCharTok{/}\DecValTok{4}\NormalTok{, }\DecValTok{1}\SpecialCharTok{/}\DecValTok{4}\NormalTok{, }\DecValTok{1}\SpecialCharTok{/}\DecValTok{4}\NormalTok{)}
  
\NormalTok{  lik.c }\OtherTok{\textless{}{-}} \FunctionTok{make.HiClasse\_cpp}\NormalTok{(tree, states,  }\AttributeTok{sampling.f=}\ConstantTok{NULL}\NormalTok{,  }\AttributeTok{strict=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{control=}\FunctionTok{list}\NormalTok{(}\AttributeTok{backend =} \StringTok{"gslode"}\NormalTok{), newArgs)}
\NormalTok{  lik.const }\OtherTok{\textless{}{-}} \FunctionTok{constrain}\NormalTok{(lik.c, }\AttributeTok{formulae =}\NormalTok{ f.list)}
\NormalTok{  arg.const }\OtherTok{\textless{}{-}} \FunctionTok{argnames}\NormalTok{(lik.const)}
\NormalTok{  starting.point }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[arg.const]}
\NormalTok{  CID4[[i]] }\OtherTok{\textless{}{-}} \FunctionTok{find.mle}\NormalTok{(lik.const, starting.point, }\AttributeTok{method=}\StringTok{"subplex"}\NormalTok{, }\AttributeTok{keep.func=}\NormalTok{F, }\AttributeTok{root=}\NormalTok{ROOT.GIVEN, }\AttributeTok{root.p=}\NormalTok{root, }\AttributeTok{condition.surv=}\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Working on: 1"
## [1] "Recoding: 0010 -> 00001010"
## [1] "Recoding: 0001 -> 00000101"
## [1] "Working on: 2"
## [1] "Recoding: 0010 -> 00001010"
## [1] "Recoding: 0001 -> 00000101"
## [1] "Working on: 3"
## [1] "Recoding: 0010 -> 00001010"
## [1] "Recoding: 0001 -> 00000101"
## [1] "Working on: 4"
## [1] "Recoding: 0010 -> 00001010"
## [1] "Recoding: 0001 -> 00000101"
## [1] "Working on: 5"
## [1] "Recoding: 0010 -> 00001010"
## [1] "Recoding: 0001 -> 00000101"
## [1] "Working on: 6"
## [1] "Recoding: 0010 -> 00001010"
## [1] "Recoding: 0001 -> 00000101"
## [1] "Working on: 7"
## [1] "Recoding: 0010 -> 00001010"
## [1] "Recoding: 0001 -> 00000101"
## [1] "Working on: 8"
## [1] "Recoding: 0010 -> 00001010"
## [1] "Recoding: 0001 -> 00000101"
## [1] "Working on: 9"
## [1] "Recoding: 0010 -> 00001010"
## [1] "Recoding: 0001 -> 00000101"
## [1] "Working on: 10"
## [1] "Recoding: 0010 -> 00001010"
## [1] "Recoding: 0001 -> 00000101"
\end{verbatim}

Some helper functions to assess the inference parameters.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID4, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pars\_to\_arrays}\NormalTok{(CID4[[}\DecValTok{1}\NormalTok{]]}\SpecialCharTok{$}\NormalTok{par.full, }\DecValTok{4}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{reoder\_lambdas}\NormalTok{(., }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $lam.tensor
## $lam.tensor$`1`
##            [,1] [,2] [,3] [,4]
## [1,] 0.05094386    0    0    0
## [2,] 0.00000000    0    0    0
## [3,] 0.00000000    0    0    0
## [4,] 0.00000000    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4]
## [1,]    0 0.00000000    0    0
## [2,]    0 0.05091551    0    0
## [3,]    0 0.00000000    0    0
## [4,]    0 0.00000000    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2]       [,3] [,4]
## [1,]    0    0 0.00000000    0
## [2,]    0    0 0.00000000    0
## [3,]    0    0 0.05094386    0
## [4,]    0    0 0.00000000    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3]       [,4]
## [1,]    0    0    0 0.00000000
## [2,]    0    0    0 0.00000000
## [3,]    0    0    0 0.00000000
## [4,]    0    0    0 0.05091551
## 
## 
## $mu
##          mu0          mu2          mu1          mu3 
## 0.0003102256 0.0003102256 0.0003102256 0.0003102256 
## 
## $Q
##              [,1]         [,2]         [,3]         [,4]
## [1,] -0.015124151  0.007562076  0.007562076  0.000000000
## [2,]  0.007562076 -0.015124151  0.000000000  0.007562076
## [3,]  0.007562076  0.000000000 -0.015124151  0.007562076
## [4,]  0.000000000  0.007562076  0.007562076 -0.015124151
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID4[}\DecValTok{1}\NormalTok{], }\StringTok{\textquotesingle{}par\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       lam000       lam222          mu0          q01 
## 0.0509438630 0.0509155136 0.0003102256 0.0075620757
\end{verbatim}

\hypertarget{inferences-using-parameters-from-cid4}{%
\subsection{Inferences using parameters from CID4}\label{inferences-using-parameters-from-cid4}}

\hypertarget{cid8-4-pars}{%
\subsubsection{CID8 (4 pars)}\label{cid8-4-pars}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Args }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{Nstates =}\NormalTok{ 8L,}
  \AttributeTok{y =} \FunctionTok{list}\NormalTok{(}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{),}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{  ))}

\NormalTok{newArgs }\OtherTok{\textless{}{-}} \FunctionTok{makeArgs}\NormalTok{(Args)}
\CommentTok{\#printArgsGlobal()}
\NormalTok{args }\OtherTok{\textless{}{-}} \FunctionTok{argnames\_HiClaSSE}\NormalTok{(}\DecValTok{8}\NormalTok{)}
\NormalTok{args}\SpecialCharTok{$}\NormalTok{arrays}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $lam.tensor
## $lam.tensor[[1]]
##      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
## [1,] "lam000" "lam001" "lam002" "lam003" "lam004" "lam005" "lam006" "lam007"
## [2,] "0"      "lam011" "lam012" "lam013" "lam014" "lam015" "lam016" "lam017"
## [3,] "0"      "0"      "lam022" "lam023" "lam024" "lam025" "lam026" "lam027"
## [4,] "0"      "0"      "0"      "lam033" "lam034" "lam035" "lam036" "lam037"
## [5,] "0"      "0"      "0"      "0"      "lam044" "lam045" "lam046" "lam047"
## [6,] "0"      "0"      "0"      "0"      "0"      "lam055" "lam056" "lam057"
## [7,] "0"      "0"      "0"      "0"      "0"      "0"      "lam066" "lam067"
## [8,] "0"      "0"      "0"      "0"      "0"      "0"      "0"      "lam077"
## 
## $lam.tensor[[2]]
##      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
## [1,] "lam100" "lam101" "lam102" "lam103" "lam104" "lam105" "lam106" "lam107"
## [2,] "0"      "lam111" "lam112" "lam113" "lam114" "lam115" "lam116" "lam117"
## [3,] "0"      "0"      "lam122" "lam123" "lam124" "lam125" "lam126" "lam127"
## [4,] "0"      "0"      "0"      "lam133" "lam134" "lam135" "lam136" "lam137"
## [5,] "0"      "0"      "0"      "0"      "lam144" "lam145" "lam146" "lam147"
## [6,] "0"      "0"      "0"      "0"      "0"      "lam155" "lam156" "lam157"
## [7,] "0"      "0"      "0"      "0"      "0"      "0"      "lam166" "lam167"
## [8,] "0"      "0"      "0"      "0"      "0"      "0"      "0"      "lam177"
## 
## $lam.tensor[[3]]
##      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
## [1,] "lam200" "lam201" "lam202" "lam203" "lam204" "lam205" "lam206" "lam207"
## [2,] "0"      "lam211" "lam212" "lam213" "lam214" "lam215" "lam216" "lam217"
## [3,] "0"      "0"      "lam222" "lam223" "lam224" "lam225" "lam226" "lam227"
## [4,] "0"      "0"      "0"      "lam233" "lam234" "lam235" "lam236" "lam237"
## [5,] "0"      "0"      "0"      "0"      "lam244" "lam245" "lam246" "lam247"
## [6,] "0"      "0"      "0"      "0"      "0"      "lam255" "lam256" "lam257"
## [7,] "0"      "0"      "0"      "0"      "0"      "0"      "lam266" "lam267"
## [8,] "0"      "0"      "0"      "0"      "0"      "0"      "0"      "lam277"
## 
## $lam.tensor[[4]]
##      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
## [1,] "lam300" "lam301" "lam302" "lam303" "lam304" "lam305" "lam306" "lam307"
## [2,] "0"      "lam311" "lam312" "lam313" "lam314" "lam315" "lam316" "lam317"
## [3,] "0"      "0"      "lam322" "lam323" "lam324" "lam325" "lam326" "lam327"
## [4,] "0"      "0"      "0"      "lam333" "lam334" "lam335" "lam336" "lam337"
## [5,] "0"      "0"      "0"      "0"      "lam344" "lam345" "lam346" "lam347"
## [6,] "0"      "0"      "0"      "0"      "0"      "lam355" "lam356" "lam357"
## [7,] "0"      "0"      "0"      "0"      "0"      "0"      "lam366" "lam367"
## [8,] "0"      "0"      "0"      "0"      "0"      "0"      "0"      "lam377"
## 
## $lam.tensor[[5]]
##      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
## [1,] "lam400" "lam401" "lam402" "lam403" "lam404" "lam405" "lam406" "lam407"
## [2,] "0"      "lam411" "lam412" "lam413" "lam414" "lam415" "lam416" "lam417"
## [3,] "0"      "0"      "lam422" "lam423" "lam424" "lam425" "lam426" "lam427"
## [4,] "0"      "0"      "0"      "lam433" "lam434" "lam435" "lam436" "lam437"
## [5,] "0"      "0"      "0"      "0"      "lam444" "lam445" "lam446" "lam447"
## [6,] "0"      "0"      "0"      "0"      "0"      "lam455" "lam456" "lam457"
## [7,] "0"      "0"      "0"      "0"      "0"      "0"      "lam466" "lam467"
## [8,] "0"      "0"      "0"      "0"      "0"      "0"      "0"      "lam477"
## 
## $lam.tensor[[6]]
##      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
## [1,] "lam500" "lam501" "lam502" "lam503" "lam504" "lam505" "lam506" "lam507"
## [2,] "0"      "lam511" "lam512" "lam513" "lam514" "lam515" "lam516" "lam517"
## [3,] "0"      "0"      "lam522" "lam523" "lam524" "lam525" "lam526" "lam527"
## [4,] "0"      "0"      "0"      "lam533" "lam534" "lam535" "lam536" "lam537"
## [5,] "0"      "0"      "0"      "0"      "lam544" "lam545" "lam546" "lam547"
## [6,] "0"      "0"      "0"      "0"      "0"      "lam555" "lam556" "lam557"
## [7,] "0"      "0"      "0"      "0"      "0"      "0"      "lam566" "lam567"
## [8,] "0"      "0"      "0"      "0"      "0"      "0"      "0"      "lam577"
## 
## $lam.tensor[[7]]
##      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
## [1,] "lam600" "lam601" "lam602" "lam603" "lam604" "lam605" "lam606" "lam607"
## [2,] "0"      "lam611" "lam612" "lam613" "lam614" "lam615" "lam616" "lam617"
## [3,] "0"      "0"      "lam622" "lam623" "lam624" "lam625" "lam626" "lam627"
## [4,] "0"      "0"      "0"      "lam633" "lam634" "lam635" "lam636" "lam637"
## [5,] "0"      "0"      "0"      "0"      "lam644" "lam645" "lam646" "lam647"
## [6,] "0"      "0"      "0"      "0"      "0"      "lam655" "lam656" "lam657"
## [7,] "0"      "0"      "0"      "0"      "0"      "0"      "lam666" "lam667"
## [8,] "0"      "0"      "0"      "0"      "0"      "0"      "0"      "lam677"
## 
## $lam.tensor[[8]]
##      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
## [1,] "lam700" "lam701" "lam702" "lam703" "lam704" "lam705" "lam706" "lam707"
## [2,] "0"      "lam711" "lam712" "lam713" "lam714" "lam715" "lam716" "lam717"
## [3,] "0"      "0"      "lam722" "lam723" "lam724" "lam725" "lam726" "lam727"
## [4,] "0"      "0"      "0"      "lam733" "lam734" "lam735" "lam736" "lam737"
## [5,] "0"      "0"      "0"      "0"      "lam744" "lam745" "lam746" "lam747"
## [6,] "0"      "0"      "0"      "0"      "0"      "lam755" "lam756" "lam757"
## [7,] "0"      "0"      "0"      "0"      "0"      "0"      "lam766" "lam767"
## [8,] "0"      "0"      "0"      "0"      "0"      "0"      "0"      "lam777"
## 
## 
## $mu
## [1] "mu0" "mu1" "mu2" "mu3" "mu4" "mu5" "mu6" "mu7"
## 
## $Q
##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8] 
## [1,] "0"   "q01" "q02" "q03" "q04" "q05" "q06" "q07"
## [2,] "q10" "0"   "q12" "q13" "q14" "q15" "q16" "q17"
## [3,] "q20" "q21" "0"   "q23" "q24" "q25" "q26" "q27"
## [4,] "q30" "q31" "q32" "0"   "q34" "q35" "q36" "q37"
## [5,] "q40" "q41" "q42" "q43" "0"   "q45" "q46" "q47"
## [6,] "q50" "q51" "q52" "q53" "q54" "0"   "q56" "q57"
## [7,] "q60" "q61" "q62" "q63" "q64" "q65" "0"   "q67"
## [8,] "q70" "q71" "q72" "q73" "q74" "q75" "q76" "0"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#reoder\_lambdas(args$arrays, c(1,3,5,7, 2,4,6,8))}
\end{Highlighting}
\end{Shaded}

Run inference

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{CID8.pars }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
\NormalTok{i}\OtherTok{=}\DecValTok{1}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{NSIM)\{}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{\textquotesingle{}Working on: \textquotesingle{}}\NormalTok{, i))}
  \CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{  est }\OtherTok{\textless{}{-}} \FunctionTok{get\_item}\NormalTok{(CID4[i], }\StringTok{\textquotesingle{}par\textquotesingle{}}\NormalTok{)}
\NormalTok{  pars.hc }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{length}\NormalTok{(args}\SpecialCharTok{$}\NormalTok{pars))}
  \FunctionTok{names}\NormalTok{(pars.hc) }\OtherTok{\textless{}{-}}\NormalTok{ args}\SpecialCharTok{$}\NormalTok{pars}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam111\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam333\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam444\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam555\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam666\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam777\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}mu0\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu1\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu2\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu3\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu4\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu5\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu6\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu7\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}mu0\textquotesingle{}}\NormalTok{]}
\NormalTok{  qs }\OtherTok{\textless{}{-}} \FunctionTok{extract\_off\_diagonal}\NormalTok{(Q\_cid8.r)}
\NormalTok{  qsl}\OtherTok{=}\FunctionTok{length}\NormalTok{(qs)}
\NormalTok{  qs[qs}\SpecialCharTok{==}\FloatTok{0.1}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}q01\textquotesingle{}}\NormalTok{]}
\NormalTok{  qs[qs}\SpecialCharTok{==}\FloatTok{0.01}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}q02\textquotesingle{}}\NormalTok{]}\SpecialCharTok{/}\DecValTok{2}
\NormalTok{  pars.hc[}\FunctionTok{c}\NormalTok{(}\FunctionTok{length}\NormalTok{(pars.hc)}\SpecialCharTok{{-}}\NormalTok{qsl}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pars.hc)] }\OtherTok{\textless{}{-}}\NormalTok{ qs}
  
  \CommentTok{\#pars.hc}
  \CommentTok{\#pars\_to\_arrays(pars.hc, 8)}
  \CommentTok{\#{-}{-}{-}{-}{-}{-}}
\NormalTok{  tree }\OtherTok{\textless{}{-}}\NormalTok{ phy[[i]]}
\NormalTok{  states}\OtherTok{\textless{}{-}}\NormalTok{ tree}\SpecialCharTok{$}\NormalTok{tip.state}
\NormalTok{  states}\OtherTok{\textless{}{-}} \FunctionTok{mapvalues}\NormalTok{(states, }\AttributeTok{from =} \FunctionTok{c}\NormalTok{(}\StringTok{"0"}\NormalTok{, }\StringTok{"1"}\NormalTok{, }\StringTok{"2"}\NormalTok{, }\StringTok{"3"}\NormalTok{), }\AttributeTok{to=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{) )}
\NormalTok{  root }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\DecValTok{8}\NormalTok{, }\DecValTok{8}\NormalTok{)}
  
\NormalTok{  lik.c }\OtherTok{\textless{}{-}} \FunctionTok{make.HiClasse\_cpp}\NormalTok{(tree, states,  }\AttributeTok{sampling.f=}\ConstantTok{NULL}\NormalTok{,  }\AttributeTok{strict=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{control=}\FunctionTok{list}\NormalTok{(}\AttributeTok{backend =} \StringTok{"gslode"}\NormalTok{), newArgs)}
\NormalTok{  CID8.pars[[i]] }\OtherTok{\textless{}{-}} \FunctionTok{lik.c}\NormalTok{(pars.hc, }\AttributeTok{intermediates=}\NormalTok{F, }\AttributeTok{root=}\NormalTok{ROOT.GIVEN, }\AttributeTok{root.p=}\NormalTok{root, }\AttributeTok{condition.surv=}\NormalTok{T)}
  
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Working on: 1"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 2"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 3"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 4"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 5"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 6"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 7"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 8"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 9"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 10"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
\end{verbatim}

Compare Ln

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID4, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{CID8.pars }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pars\_to\_arrays}\NormalTok{(pars.hc, }\DecValTok{8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{reoder\_lambdas}\NormalTok{(., }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{7}\NormalTok{, }\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{8}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $lam.tensor
## $lam.tensor$`1`
##            [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,] 0.05942176    0    0    0    0    0    0    0
## [2,] 0.00000000    0    0    0    0    0    0    0
## [3,] 0.00000000    0    0    0    0    0    0    0
## [4,] 0.00000000    0    0    0    0    0    0    0
## [5,] 0.00000000    0    0    0    0    0    0    0
## [6,] 0.00000000    0    0    0    0    0    0    0
## [7,] 0.00000000    0    0    0    0    0    0    0
## [8,] 0.00000000    0    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.05942176    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2]       [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0 0.00000000    0    0    0    0    0
## [2,]    0    0 0.00000000    0    0    0    0    0
## [3,]    0    0 0.08723677    0    0    0    0    0
## [4,]    0    0 0.00000000    0    0    0    0    0
## [5,]    0    0 0.00000000    0    0    0    0    0
## [6,]    0    0 0.00000000    0    0    0    0    0
## [7,]    0    0 0.00000000    0    0    0    0    0
## [8,]    0    0 0.00000000    0    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.08723677    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05942176    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.05942176    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6]       [,7] [,8]
## [1,]    0    0    0    0    0    0 0.00000000    0
## [2,]    0    0    0    0    0    0 0.00000000    0
## [3,]    0    0    0    0    0    0 0.00000000    0
## [4,]    0    0    0    0    0    0 0.00000000    0
## [5,]    0    0    0    0    0    0 0.00000000    0
## [6,]    0    0    0    0    0    0 0.00000000    0
## [7,]    0    0    0    0    0    0 0.08723677    0
## [8,]    0    0    0    0    0    0 0.00000000    0
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.08723677
## 
## 
## $mu
##         mu0         mu2         mu4         mu6         mu1         mu3         mu5         mu7 
## 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 
## 
## $Q
##             [,1]        [,2]        [,3]        [,4]        [,5]        [,6]        [,7]        [,8]
## [1,] -0.03790101  0.01263367  0.01263367  0.00000000  0.01263367  0.00000000  0.00000000  0.00000000
## [2,]  0.01263367 -0.03790101  0.00000000  0.01263367  0.00000000  0.01263367  0.00000000  0.00000000
## [3,]  0.01263367  0.00000000 -0.03790101  0.01263367  0.00000000  0.00000000  0.01263367  0.00000000
## [4,]  0.00000000  0.01263367  0.01263367 -0.03790101  0.00000000  0.00000000  0.00000000  0.01263367
## [5,]  0.01263367  0.00000000  0.00000000  0.00000000 -0.03790101  0.01263367  0.01263367  0.00000000
## [6,]  0.00000000  0.01263367  0.00000000  0.00000000  0.01263367 -0.03790101  0.00000000  0.01263367
## [7,]  0.00000000  0.00000000  0.01263367  0.00000000  0.01263367  0.00000000 -0.03790101  0.01263367
## [8,]  0.00000000  0.00000000  0.00000000  0.01263367  0.00000000  0.01263367  0.01263367 -0.03790101
\end{verbatim}

\hypertarget{cor8-c-4-pars}{%
\subsubsection{COR8-C (4 pars)}\label{cor8-c-4-pars}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Args }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{Nstates =}\NormalTok{ 8L,}
  \AttributeTok{y =} \FunctionTok{list}\NormalTok{(}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{),}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{  ))}

\NormalTok{newArgs }\OtherTok{\textless{}{-}} \FunctionTok{makeArgs}\NormalTok{(Args)}
\CommentTok{\#printArgsGlobal()}
\NormalTok{args }\OtherTok{\textless{}{-}} \FunctionTok{argnames\_HiClaSSE}\NormalTok{(}\DecValTok{8}\NormalTok{)}
\CommentTok{\#args}
\end{Highlighting}
\end{Shaded}

Run inference

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{COR8\_C.pars }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
\NormalTok{i}\OtherTok{=}\DecValTok{2}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{NSIM)\{}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{\textquotesingle{}Working on: \textquotesingle{}}\NormalTok{, i))}
  \CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{  est }\OtherTok{\textless{}{-}} \FunctionTok{get\_item}\NormalTok{(CID4[i], }\StringTok{\textquotesingle{}par\textquotesingle{}}\NormalTok{)}
\NormalTok{  pars.hc }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{length}\NormalTok{(args}\SpecialCharTok{$}\NormalTok{pars))}
  \FunctionTok{names}\NormalTok{(pars.hc) }\OtherTok{\textless{}{-}}\NormalTok{ args}\SpecialCharTok{$}\NormalTok{pars}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam111\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam333\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam444\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam555\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam666\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam777\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}mu0\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu1\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu2\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu3\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu4\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu5\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu6\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu7\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}mu0\textquotesingle{}}\NormalTok{]}
\NormalTok{  qs }\OtherTok{\textless{}{-}} \FunctionTok{extract\_off\_diagonal}\NormalTok{(Q\_cor8\_C.r)}
\NormalTok{  qsl}\OtherTok{=}\FunctionTok{length}\NormalTok{(qs)}
\NormalTok{  qs[qs}\SpecialCharTok{==}\FloatTok{0.1}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}q01\textquotesingle{}}\NormalTok{]}
\NormalTok{  qs[qs}\SpecialCharTok{==}\FloatTok{0.01}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}q02\textquotesingle{}}\NormalTok{]}\SpecialCharTok{/}\DecValTok{2}
\NormalTok{  pars.hc[}\FunctionTok{c}\NormalTok{(}\FunctionTok{length}\NormalTok{(pars.hc)}\SpecialCharTok{{-}}\NormalTok{qsl}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pars.hc)] }\OtherTok{\textless{}{-}}\NormalTok{ qs}
  
  \CommentTok{\# pars.hc}
  \CommentTok{\# pars\_to\_arrays(pars.hc, 8)}
  \CommentTok{\#v=c(1,3,5,7, 2,4,6,8)}
  \CommentTok{\#pars\_to\_arrays(pars.hc, 8)$Q[v,v]}
  
  \CommentTok{\#{-}{-}{-}{-}{-}{-}}
\NormalTok{  tree }\OtherTok{\textless{}{-}}\NormalTok{ phy[[i]]}
\NormalTok{  states}\OtherTok{\textless{}{-}}\NormalTok{ tree}\SpecialCharTok{$}\NormalTok{tip.state}
\NormalTok{  states}\OtherTok{\textless{}{-}} \FunctionTok{mapvalues}\NormalTok{(states, }\AttributeTok{from =} \FunctionTok{c}\NormalTok{(}\StringTok{"0"}\NormalTok{, }\StringTok{"1"}\NormalTok{, }\StringTok{"2"}\NormalTok{, }\StringTok{"3"}\NormalTok{), }\AttributeTok{to=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{) )}
\NormalTok{  root }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\DecValTok{8}\NormalTok{, }\DecValTok{8}\NormalTok{)}
  
\NormalTok{  lik.c }\OtherTok{\textless{}{-}} \FunctionTok{make.HiClasse\_cpp}\NormalTok{(tree, states,  }\AttributeTok{sampling.f=}\ConstantTok{NULL}\NormalTok{,  }\AttributeTok{strict=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{control=}\FunctionTok{list}\NormalTok{(}\AttributeTok{backend =} \StringTok{"gslode"}\NormalTok{), newArgs)}
\NormalTok{  COR8\_C.pars[[i]] }\OtherTok{\textless{}{-}} \FunctionTok{lik.c}\NormalTok{(pars.hc, }\AttributeTok{intermediates=}\NormalTok{F, }\AttributeTok{root=}\NormalTok{ROOT.GIVEN, }\AttributeTok{root.p=}\NormalTok{root, }\AttributeTok{condition.surv=}\NormalTok{T)}
  
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Working on: 1"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 2"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 3"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 4"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 5"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 6"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 7"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 8"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 9"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 10"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
\end{verbatim}

Compare Ln

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID4, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{COR8\_C.pars }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pars\_to\_arrays}\NormalTok{(pars.hc, }\DecValTok{8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{reoder\_lambdas}\NormalTok{(., }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{7}\NormalTok{, }\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{8}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $lam.tensor
## $lam.tensor$`1`
##            [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,] 0.05942176    0    0    0    0    0    0    0
## [2,] 0.00000000    0    0    0    0    0    0    0
## [3,] 0.00000000    0    0    0    0    0    0    0
## [4,] 0.00000000    0    0    0    0    0    0    0
## [5,] 0.00000000    0    0    0    0    0    0    0
## [6,] 0.00000000    0    0    0    0    0    0    0
## [7,] 0.00000000    0    0    0    0    0    0    0
## [8,] 0.00000000    0    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.05942176    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2]       [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0 0.00000000    0    0    0    0    0
## [2,]    0    0 0.00000000    0    0    0    0    0
## [3,]    0    0 0.08723677    0    0    0    0    0
## [4,]    0    0 0.00000000    0    0    0    0    0
## [5,]    0    0 0.00000000    0    0    0    0    0
## [6,]    0    0 0.00000000    0    0    0    0    0
## [7,]    0    0 0.00000000    0    0    0    0    0
## [8,]    0    0 0.00000000    0    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.08723677    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05942176    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.05942176    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6]       [,7] [,8]
## [1,]    0    0    0    0    0    0 0.00000000    0
## [2,]    0    0    0    0    0    0 0.00000000    0
## [3,]    0    0    0    0    0    0 0.00000000    0
## [4,]    0    0    0    0    0    0 0.00000000    0
## [5,]    0    0    0    0    0    0 0.00000000    0
## [6,]    0    0    0    0    0    0 0.00000000    0
## [7,]    0    0    0    0    0    0 0.08723677    0
## [8,]    0    0    0    0    0    0 0.00000000    0
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.08723677
## 
## 
## $mu
##         mu0         mu2         mu4         mu6         mu1         mu3         mu5         mu7 
## 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 
## 
## $Q
##             [,1]        [,2]        [,3]        [,4]        [,5]        [,6]        [,7]        [,8]
## [1,] -0.03790101  0.01263367  0.01263367  0.00000000  0.00000000  0.01263367  0.00000000  0.00000000
## [2,]  0.01263367 -0.03790101  0.00000000  0.01263367  0.01263367  0.00000000  0.00000000  0.00000000
## [3,]  0.01263367  0.00000000 -0.03790101  0.01263367  0.00000000  0.00000000  0.00000000  0.01263367
## [4,]  0.00000000  0.01263367  0.01263367 -0.03790101  0.00000000  0.00000000  0.01263367  0.00000000
## [5,]  0.00000000  0.01263367  0.00000000  0.00000000 -0.03790101  0.01263367  0.01263367  0.00000000
## [6,]  0.01263367  0.00000000  0.00000000  0.00000000  0.01263367 -0.03790101  0.00000000  0.01263367
## [7,]  0.00000000  0.00000000  0.00000000  0.01263367  0.01263367  0.00000000 -0.03790101  0.01263367
## [8,]  0.00000000  0.00000000  0.01263367  0.00000000  0.00000000  0.01263367  0.01263367 -0.03790101
\end{verbatim}

\hypertarget{cor8-nc-4-pars}{%
\subsubsection{COR8-NC (4 pars)}\label{cor8-nc-4-pars}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Args }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{Nstates =}\NormalTok{ 8L,}
  \AttributeTok{y =} \FunctionTok{list}\NormalTok{(}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{),}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{  ))}

\NormalTok{newArgs }\OtherTok{\textless{}{-}} \FunctionTok{makeArgs}\NormalTok{(Args)}
\CommentTok{\#printArgsGlobal()}
\NormalTok{args }\OtherTok{\textless{}{-}} \FunctionTok{argnames\_HiClaSSE}\NormalTok{(}\DecValTok{8}\NormalTok{)}
\CommentTok{\#args}
\end{Highlighting}
\end{Shaded}

Run inference

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{COR8\_NC.pars }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
\NormalTok{i}\OtherTok{=}\DecValTok{1}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{NSIM)\{}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{\textquotesingle{}Working on: \textquotesingle{}}\NormalTok{, i))}
  \CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{  est }\OtherTok{\textless{}{-}} \FunctionTok{get\_item}\NormalTok{(CID4[i], }\StringTok{\textquotesingle{}par\textquotesingle{}}\NormalTok{)}
\NormalTok{  pars.hc }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{length}\NormalTok{(args}\SpecialCharTok{$}\NormalTok{pars))}
  \FunctionTok{names}\NormalTok{(pars.hc) }\OtherTok{\textless{}{-}}\NormalTok{ args}\SpecialCharTok{$}\NormalTok{pars}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam111\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam333\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam444\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam555\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam666\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam777\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}mu0\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu1\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu2\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu3\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu4\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu5\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu6\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu7\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}mu0\textquotesingle{}}\NormalTok{]}
\NormalTok{  qs }\OtherTok{\textless{}{-}} \FunctionTok{extract\_off\_diagonal}\NormalTok{(Q\_cor8\_NC.r)}
\NormalTok{  qsl}\OtherTok{=}\FunctionTok{length}\NormalTok{(qs)}
\NormalTok{  qs[qs}\SpecialCharTok{==}\FloatTok{0.1}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}q01\textquotesingle{}}\NormalTok{]}
\NormalTok{  qs[qs}\SpecialCharTok{==}\FloatTok{0.01}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}q02\textquotesingle{}}\NormalTok{]}\SpecialCharTok{/}\DecValTok{2}
\NormalTok{  pars.hc[}\FunctionTok{c}\NormalTok{(}\FunctionTok{length}\NormalTok{(pars.hc)}\SpecialCharTok{{-}}\NormalTok{qsl}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pars.hc)] }\OtherTok{\textless{}{-}}\NormalTok{ qs}
  
  \CommentTok{\# pars.hc}
  \CommentTok{\# pars\_to\_arrays(pars.hc, 8)}
  \CommentTok{\# v=c(1,3,5,7, 2,4,6,8)}
  \CommentTok{\# pars\_to\_arrays(pars.hc, 8)$Q[v,v]}
  
  \CommentTok{\#{-}{-}{-}{-}{-}{-}}
\NormalTok{  tree }\OtherTok{\textless{}{-}}\NormalTok{ phy[[i]]}
\NormalTok{  states}\OtherTok{\textless{}{-}}\NormalTok{ tree}\SpecialCharTok{$}\NormalTok{tip.state}
\NormalTok{  states}\OtherTok{\textless{}{-}} \FunctionTok{mapvalues}\NormalTok{(states, }\AttributeTok{from =} \FunctionTok{c}\NormalTok{(}\StringTok{"0"}\NormalTok{, }\StringTok{"1"}\NormalTok{, }\StringTok{"2"}\NormalTok{, }\StringTok{"3"}\NormalTok{), }\AttributeTok{to=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{) )}
\NormalTok{  root }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\DecValTok{8}\NormalTok{, }\DecValTok{8}\NormalTok{)}
  
\NormalTok{  lik.c }\OtherTok{\textless{}{-}} \FunctionTok{make.HiClasse\_cpp}\NormalTok{(tree, states,  }\AttributeTok{sampling.f=}\ConstantTok{NULL}\NormalTok{,  }\AttributeTok{strict=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{control=}\FunctionTok{list}\NormalTok{(}\AttributeTok{backend =} \StringTok{"gslode"}\NormalTok{), newArgs)}
\NormalTok{  COR8\_NC.pars[[i]] }\OtherTok{\textless{}{-}} \FunctionTok{lik.c}\NormalTok{(pars.hc, }\AttributeTok{intermediates=}\NormalTok{F, }\AttributeTok{root=}\NormalTok{ROOT.GIVEN, }\AttributeTok{root.p=}\NormalTok{root, }\AttributeTok{condition.surv=}\NormalTok{T)}
  
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Working on: 1"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 2"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 3"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 4"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 5"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 6"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 7"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 8"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 9"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 10"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
\end{verbatim}

Some helper function to assess the inference parameters

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID4, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{COR8\_NC.pars }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -442.1584 -432.3652 -414.2528 -425.1997 -424.8447 -420.8153 -438.9214 -432.1182 -426.2918 -399.7270
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pars\_to\_arrays}\NormalTok{(pars.hc, }\DecValTok{8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{reoder\_lambdas}\NormalTok{(., }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{7}\NormalTok{, }\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{8}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $lam.tensor
## $lam.tensor$`1`
##            [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,] 0.05942176    0    0    0    0    0    0    0
## [2,] 0.00000000    0    0    0    0    0    0    0
## [3,] 0.00000000    0    0    0    0    0    0    0
## [4,] 0.00000000    0    0    0    0    0    0    0
## [5,] 0.00000000    0    0    0    0    0    0    0
## [6,] 0.00000000    0    0    0    0    0    0    0
## [7,] 0.00000000    0    0    0    0    0    0    0
## [8,] 0.00000000    0    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.05942176    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2]       [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0 0.00000000    0    0    0    0    0
## [2,]    0    0 0.00000000    0    0    0    0    0
## [3,]    0    0 0.08723677    0    0    0    0    0
## [4,]    0    0 0.00000000    0    0    0    0    0
## [5,]    0    0 0.00000000    0    0    0    0    0
## [6,]    0    0 0.00000000    0    0    0    0    0
## [7,]    0    0 0.00000000    0    0    0    0    0
## [8,]    0    0 0.00000000    0    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.08723677    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05942176    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.05942176    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6]       [,7] [,8]
## [1,]    0    0    0    0    0    0 0.00000000    0
## [2,]    0    0    0    0    0    0 0.00000000    0
## [3,]    0    0    0    0    0    0 0.00000000    0
## [4,]    0    0    0    0    0    0 0.00000000    0
## [5,]    0    0    0    0    0    0 0.00000000    0
## [6,]    0    0    0    0    0    0 0.00000000    0
## [7,]    0    0    0    0    0    0 0.08723677    0
## [8,]    0    0    0    0    0    0 0.00000000    0
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.08723677
## 
## 
## $mu
##         mu0         mu2         mu4         mu6         mu1         mu3         mu5         mu7 
## 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 
## 
## $Q
##             [,1]        [,2]        [,3]        [,4]        [,5]        [,6]        [,7]        [,8]
## [1,] -0.03790101  0.01263367  0.01263367  0.00000000  0.00000000  0.01263367  0.00000000  0.00000000
## [2,]  0.01263367 -0.02526734  0.00000000  0.01263367  0.00000000  0.00000000  0.00000000  0.00000000
## [3,]  0.01263367  0.00000000 -0.03790101  0.01263367  0.00000000  0.00000000  0.00000000  0.01263367
## [4,]  0.00000000  0.01263367  0.01263367 -0.02526734  0.00000000  0.00000000  0.00000000  0.00000000
## [5,]  0.00000000  0.01263367  0.00000000  0.00000000 -0.03790101  0.01263367  0.01263367  0.00000000
## [6,]  0.00000000  0.00000000  0.00000000  0.00000000  0.01263367 -0.02526734  0.00000000  0.01263367
## [7,]  0.00000000  0.00000000  0.00000000  0.01263367  0.01263367  0.00000000 -0.03790101  0.01263367
## [8,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.01263367  0.01263367 -0.02526734
\end{verbatim}

\hypertarget{cla8-c-4-pars}{%
\subsubsection{CLA8-C (4 pars)}\label{cla8-c-4-pars}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Args }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{Nstates =}\NormalTok{ 8L,}
  \AttributeTok{y =} \FunctionTok{list}\NormalTok{(}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{),}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{  ))}

\NormalTok{newArgs }\OtherTok{\textless{}{-}} \FunctionTok{makeArgs}\NormalTok{(Args)}
\CommentTok{\#printArgsGlobal()}
\NormalTok{args }\OtherTok{\textless{}{-}} \FunctionTok{argnames\_HiClaSSE}\NormalTok{(}\DecValTok{8}\NormalTok{)}
\CommentTok{\#args$arrays}
\CommentTok{\# reoder\_lambdas(args$arrays, c(1,3,5,7, 2,4,6,8))}
\end{Highlighting}
\end{Shaded}

Run inference

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{CLA8\_C.pars }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
\NormalTok{i}\OtherTok{=}\DecValTok{1}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{NSIM)\{}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{\textquotesingle{}Working on: \textquotesingle{}}\NormalTok{, i))}
  \CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{  est }\OtherTok{\textless{}{-}} \FunctionTok{get\_item}\NormalTok{(CID4[i], }\StringTok{\textquotesingle{}par\textquotesingle{}}\NormalTok{)}
\NormalTok{  pars.hc }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{length}\NormalTok{(args}\SpecialCharTok{$}\NormalTok{pars))}
  \FunctionTok{names}\NormalTok{(pars.hc) }\OtherTok{\textless{}{-}}\NormalTok{ args}\SpecialCharTok{$}\NormalTok{pars}
  \CommentTok{\# pars.hc[\textquotesingle{}lam000\textquotesingle{}] \textless{}{-} est[\textquotesingle{}lam000\textquotesingle{}]}
  \CommentTok{\# pars.hc[\textquotesingle{}lam111\textquotesingle{}] \textless{}{-} est[\textquotesingle{}lam000\textquotesingle{}]}
  \CommentTok{\# pars.hc[\textquotesingle{}lam222\textquotesingle{}] \textless{}{-} est[\textquotesingle{}lam000\textquotesingle{}]}
  \CommentTok{\# pars.hc[\textquotesingle{}lam333\textquotesingle{}] \textless{}{-} est[\textquotesingle{}lam000\textquotesingle{}]}
  \CommentTok{\# pars.hc[\textquotesingle{}lam444\textquotesingle{}] \textless{}{-} est[\textquotesingle{}lam222\textquotesingle{}]}
  \CommentTok{\# pars.hc[\textquotesingle{}lam555\textquotesingle{}] \textless{}{-} est[\textquotesingle{}lam222\textquotesingle{}]}
  \CommentTok{\# pars.hc[\textquotesingle{}lam666\textquotesingle{}] \textless{}{-} est[\textquotesingle{}lam222\textquotesingle{}]}
  \CommentTok{\# pars.hc[\textquotesingle{}lam777\textquotesingle{}] \textless{}{-} est[\textquotesingle{}lam222\textquotesingle{}]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam022\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam133\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam202\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam311\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam466\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam577\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam646\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam757\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}mu0\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu1\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu2\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu3\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu4\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu5\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu6\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu7\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}mu0\textquotesingle{}}\NormalTok{]}
\NormalTok{  qs }\OtherTok{\textless{}{-}} \FunctionTok{extract\_off\_diagonal}\NormalTok{(Q\_cor8\_C.r)}
\NormalTok{  qsl}\OtherTok{=}\FunctionTok{length}\NormalTok{(qs)}
\NormalTok{  qs[qs}\SpecialCharTok{==}\FloatTok{0.1}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}q01\textquotesingle{}}\NormalTok{]}
\NormalTok{  qs[qs}\SpecialCharTok{==}\FloatTok{0.01}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}q02\textquotesingle{}}\NormalTok{]}\SpecialCharTok{/}\DecValTok{2}
\NormalTok{  pars.hc[}\FunctionTok{c}\NormalTok{(}\FunctionTok{length}\NormalTok{(pars.hc)}\SpecialCharTok{{-}}\NormalTok{qsl}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pars.hc)] }\OtherTok{\textless{}{-}}\NormalTok{ qs}
  
  \CommentTok{\# pars.hc}
  \CommentTok{\# pars\_to\_arrays(pars.hc, 8)}
  \CommentTok{\# v=c(1,3,5,7, 2,4,6,8)}
  \CommentTok{\# pars\_to\_arrays(pars.hc, 8)$Q[v,v]}
  
  \CommentTok{\#{-}{-}{-}{-}{-}{-}}
\NormalTok{  tree }\OtherTok{\textless{}{-}}\NormalTok{ phy[[i]]}
\NormalTok{  states}\OtherTok{\textless{}{-}}\NormalTok{ tree}\SpecialCharTok{$}\NormalTok{tip.state}
\NormalTok{  states}\OtherTok{\textless{}{-}} \FunctionTok{mapvalues}\NormalTok{(states, }\AttributeTok{from =} \FunctionTok{c}\NormalTok{(}\StringTok{"0"}\NormalTok{, }\StringTok{"1"}\NormalTok{, }\StringTok{"2"}\NormalTok{, }\StringTok{"3"}\NormalTok{), }\AttributeTok{to=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{) )}
\NormalTok{  root }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\DecValTok{8}\NormalTok{, }\DecValTok{8}\NormalTok{)}
  
\NormalTok{  lik.c }\OtherTok{\textless{}{-}} \FunctionTok{make.HiClasse\_cpp}\NormalTok{(tree, states,  }\AttributeTok{sampling.f=}\ConstantTok{NULL}\NormalTok{,  }\AttributeTok{strict=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{control=}\FunctionTok{list}\NormalTok{(}\AttributeTok{backend =} \StringTok{"gslode"}\NormalTok{), newArgs)}
\NormalTok{  CLA8\_C.pars[[i]] }\OtherTok{\textless{}{-}} \FunctionTok{lik.c}\NormalTok{(pars.hc, }\AttributeTok{intermediates=}\NormalTok{F, }\AttributeTok{root=}\NormalTok{ROOT.GIVEN, }\AttributeTok{root.p=}\NormalTok{root, }\AttributeTok{condition.surv=}\NormalTok{T)}
  
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Working on: 1"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 2"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 3"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 4"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 5"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 6"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 7"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 8"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 9"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 10"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
\end{verbatim}

Some helper function to assess the inference parameters

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID4, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{CLA8\_C.pars }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pars\_to\_arrays}\NormalTok{(pars.hc, }\DecValTok{8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{reoder\_lambdas}\NormalTok{(., }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{7}\NormalTok{, }\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{8}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $lam.tensor
## $lam.tensor$`1`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.05942176    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.05942176    0    0    0    0    0    0
## [2,]    0 0.00000000    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.08723677    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.08723677    0    0    0    0
## [4,]    0    0    0 0.00000000    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.05942176    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05942176    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.08723677
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.08723677
## [8,]    0    0    0    0    0    0    0 0.00000000
## 
## 
## $mu
##         mu0         mu2         mu4         mu6         mu1         mu3         mu5         mu7 
## 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 
## 
## $Q
##             [,1]        [,2]        [,3]        [,4]        [,5]        [,6]        [,7]        [,8]
## [1,] -0.03790101  0.01263367  0.01263367  0.00000000  0.00000000  0.01263367  0.00000000  0.00000000
## [2,]  0.01263367 -0.03790101  0.00000000  0.01263367  0.01263367  0.00000000  0.00000000  0.00000000
## [3,]  0.01263367  0.00000000 -0.03790101  0.01263367  0.00000000  0.00000000  0.00000000  0.01263367
## [4,]  0.00000000  0.01263367  0.01263367 -0.03790101  0.00000000  0.00000000  0.01263367  0.00000000
## [5,]  0.00000000  0.01263367  0.00000000  0.00000000 -0.03790101  0.01263367  0.01263367  0.00000000
## [6,]  0.01263367  0.00000000  0.00000000  0.00000000  0.01263367 -0.03790101  0.00000000  0.01263367
## [7,]  0.00000000  0.00000000  0.00000000  0.01263367  0.01263367  0.00000000 -0.03790101  0.01263367
## [8,]  0.00000000  0.00000000  0.01263367  0.00000000  0.00000000  0.01263367  0.01263367 -0.03790101
\end{verbatim}

\hypertarget{cla8-nc-4-pars}{%
\subsubsection{CLA8-NC (4 pars)}\label{cla8-nc-4-pars}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Args }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{Nstates =}\NormalTok{ 8L,}
  \AttributeTok{y =} \FunctionTok{list}\NormalTok{(}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{),}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{  ))}

\NormalTok{newArgs }\OtherTok{\textless{}{-}} \FunctionTok{makeArgs}\NormalTok{(Args)}
\CommentTok{\#printArgsGlobal()}
\NormalTok{args }\OtherTok{\textless{}{-}} \FunctionTok{argnames\_HiClaSSE}\NormalTok{(}\DecValTok{8}\NormalTok{)}
\CommentTok{\#args$arrays}
\CommentTok{\#v=c(1,3,5,7, 2,4,6,8)}
\CommentTok{\#reoder\_lambdas(args$arrays, c(1,3,5,7, 2,4,6,8))}
\end{Highlighting}
\end{Shaded}

Run inference

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{CLA8\_NC.pars }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
\NormalTok{i}\OtherTok{=}\DecValTok{1}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{NSIM)\{}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{\textquotesingle{}Working on: \textquotesingle{}}\NormalTok{, i))}
  \CommentTok{\#{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{  est }\OtherTok{\textless{}{-}} \FunctionTok{get\_item}\NormalTok{(CID4[i], }\StringTok{\textquotesingle{}par\textquotesingle{}}\NormalTok{)}
\NormalTok{  pars.hc }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{length}\NormalTok{(args}\SpecialCharTok{$}\NormalTok{pars))}
  \FunctionTok{names}\NormalTok{(pars.hc) }\OtherTok{\textless{}{-}}\NormalTok{ args}\SpecialCharTok{$}\NormalTok{pars}
  \CommentTok{\# lam004, lam116, lam422 violate lumpability}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam004\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam116\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam202\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam311\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam422\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam577\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam646\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}lam757\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{]}
\NormalTok{  pars.hc[}\StringTok{\textquotesingle{}mu0\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu1\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu2\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu3\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu4\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu5\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu6\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu7\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}mu0\textquotesingle{}}\NormalTok{]}
\NormalTok{  qs }\OtherTok{\textless{}{-}} \FunctionTok{extract\_off\_diagonal}\NormalTok{(Q\_cor8\_C.r)}
\NormalTok{  qsl}\OtherTok{=}\FunctionTok{length}\NormalTok{(qs)}
\NormalTok{  qs[qs}\SpecialCharTok{==}\FloatTok{0.1}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}q01\textquotesingle{}}\NormalTok{]}
\NormalTok{  qs[qs}\SpecialCharTok{==}\FloatTok{0.01}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ est[}\StringTok{\textquotesingle{}q02\textquotesingle{}}\NormalTok{]}\SpecialCharTok{/}\DecValTok{2}
\NormalTok{  pars.hc[}\FunctionTok{c}\NormalTok{(}\FunctionTok{length}\NormalTok{(pars.hc)}\SpecialCharTok{{-}}\NormalTok{qsl}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pars.hc)] }\OtherTok{\textless{}{-}}\NormalTok{ qs}
  
  \CommentTok{\# pars.hc}
  \CommentTok{\# pars\_to\_arrays(pars.hc, 8)}
  \CommentTok{\# v=c(1,3,5,7, 2,4,6,8)}
  \CommentTok{\# pars\_to\_arrays(pars.hc, 8)$Q[v,v]}
  
  \CommentTok{\#{-}{-}{-}{-}{-}{-}}
\NormalTok{  tree }\OtherTok{\textless{}{-}}\NormalTok{ phy[[i]]}
\NormalTok{  states}\OtherTok{\textless{}{-}}\NormalTok{ tree}\SpecialCharTok{$}\NormalTok{tip.state}
\NormalTok{  states}\OtherTok{\textless{}{-}} \FunctionTok{mapvalues}\NormalTok{(states, }\AttributeTok{from =} \FunctionTok{c}\NormalTok{(}\StringTok{"0"}\NormalTok{, }\StringTok{"1"}\NormalTok{, }\StringTok{"2"}\NormalTok{, }\StringTok{"3"}\NormalTok{), }\AttributeTok{to=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{) )}
\NormalTok{  root }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\DecValTok{8}\NormalTok{, }\DecValTok{8}\NormalTok{)}
  
\NormalTok{  lik.c }\OtherTok{\textless{}{-}} \FunctionTok{make.HiClasse\_cpp}\NormalTok{(tree, states,  }\AttributeTok{sampling.f=}\ConstantTok{NULL}\NormalTok{,  }\AttributeTok{strict=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{control=}\FunctionTok{list}\NormalTok{(}\AttributeTok{backend =} \StringTok{"gslode"}\NormalTok{), newArgs)}
\NormalTok{  CLA8\_NC.pars[[i]] }\OtherTok{\textless{}{-}} \FunctionTok{lik.c}\NormalTok{(pars.hc, }\AttributeTok{intermediates=}\NormalTok{F, }\AttributeTok{root=}\NormalTok{ROOT.GIVEN, }\AttributeTok{root.p=}\NormalTok{root, }\AttributeTok{condition.surv=}\NormalTok{T)}
  
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Working on: 1"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 2"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 3"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 4"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 5"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 6"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 7"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 8"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 9"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 10"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
\end{verbatim}

Some helper function to assess the inference parameters

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID4, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{CLA8\_NC.pars }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -432.3801 -423.9786 -407.2375 -416.6835 -427.4961 -411.1675 -428.8506 -435.2936 -416.6131 -396.3307
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pars\_to\_arrays}\NormalTok{(pars.hc, }\DecValTok{8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{reoder\_lambdas}\NormalTok{(., }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{7}\NormalTok{, }\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{8}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $lam.tensor
## $lam.tensor$`1`
##      [,1] [,2]       [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0 0.05942176    0    0    0    0    0
## [2,]    0    0 0.00000000    0    0    0    0    0
## [3,]    0    0 0.00000000    0    0    0    0    0
## [4,]    0    0 0.00000000    0    0    0    0    0
## [5,]    0    0 0.00000000    0    0    0    0    0
## [6,]    0    0 0.00000000    0    0    0    0    0
## [7,]    0    0 0.00000000    0    0    0    0    0
## [8,]    0    0 0.00000000    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.05942176    0    0    0    0    0    0
## [2,]    0 0.00000000    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.08723677    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.08723677    0    0    0    0
## [4,]    0    0    0 0.00000000    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.00000000    0    0    0    0
## [5,]    0    0    0 0.05942176    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05942176    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.08723677
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.08723677
## [8,]    0    0    0    0    0    0    0 0.00000000
## 
## 
## $mu
##         mu0         mu2         mu4         mu6         mu1         mu3         mu5         mu7 
## 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 0.007294742 
## 
## $Q
##             [,1]        [,2]        [,3]        [,4]        [,5]        [,6]        [,7]        [,8]
## [1,] -0.03790101  0.01263367  0.01263367  0.00000000  0.00000000  0.01263367  0.00000000  0.00000000
## [2,]  0.01263367 -0.03790101  0.00000000  0.01263367  0.01263367  0.00000000  0.00000000  0.00000000
## [3,]  0.01263367  0.00000000 -0.03790101  0.01263367  0.00000000  0.00000000  0.00000000  0.01263367
## [4,]  0.00000000  0.01263367  0.01263367 -0.03790101  0.00000000  0.00000000  0.01263367  0.00000000
## [5,]  0.00000000  0.01263367  0.00000000  0.00000000 -0.03790101  0.01263367  0.01263367  0.00000000
## [6,]  0.01263367  0.00000000  0.00000000  0.00000000  0.01263367 -0.03790101  0.00000000  0.01263367
## [7,]  0.00000000  0.00000000  0.00000000  0.01263367  0.01263367  0.00000000 -0.03790101  0.01263367
## [8,]  0.00000000  0.00000000  0.01263367  0.00000000  0.00000000  0.01263367  0.01263367 -0.03790101
\end{verbatim}

\hypertarget{maximum-likelihood.-all-models-have-4-pars.}{%
\subsection{Maximum Likelihood. All models have 4 pars.}\label{maximum-likelihood.-all-models-have-4-pars.}}

\hypertarget{cid8}{%
\subsubsection{CID8}\label{cid8}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Args }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{Nstates =}\NormalTok{ 8L,}
  \AttributeTok{y =} \FunctionTok{list}\NormalTok{(}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{),}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{  ))}

\NormalTok{newArgs }\OtherTok{\textless{}{-}} \FunctionTok{makeArgs}\NormalTok{(Args)}
\CommentTok{\#printArgsGlobal()}
\NormalTok{args }\OtherTok{\textless{}{-}} \FunctionTok{argnames\_HiClaSSE}\NormalTok{(}\DecValTok{8}\NormalTok{)}
\CommentTok{\#args$arrays}
\CommentTok{\#args$pars}
\CommentTok{\#length(args$pars)}

\NormalTok{pars.hc }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{length}\NormalTok{(args}\SpecialCharTok{$}\NormalTok{pars))}
\FunctionTok{names}\NormalTok{(pars.hc) }\OtherTok{\textless{}{-}}\NormalTok{ args}\SpecialCharTok{$}\NormalTok{pars}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam111\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam333\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam444\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam555\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam666\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam777\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu0\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu1\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu2\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu3\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu4\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu5\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu6\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu7\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\FloatTok{0.1}
\NormalTok{qs }\OtherTok{\textless{}{-}} \FunctionTok{extract\_off\_diagonal}\NormalTok{(Q\_cid8.r)}
\NormalTok{qsl}\OtherTok{=}\FunctionTok{length}\NormalTok{(qs)}
\CommentTok{\#unique(qs)}
\NormalTok{pars.hc[}\FunctionTok{c}\NormalTok{(}\FunctionTok{length}\NormalTok{(pars.hc)}\SpecialCharTok{{-}}\NormalTok{qsl}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pars.hc)] }\OtherTok{\textless{}{-}}\NormalTok{ qs}

\CommentTok{\#pars.hc}
\CommentTok{\#pars\_to\_arrays(pars.hc,8)}
\CommentTok{\#args}

\NormalTok{zero.constr }\OtherTok{\textless{}{-}} \FunctionTok{formulas\_zero\_pars}\NormalTok{(pars.hc)}
\NormalTok{f.qs }\OtherTok{\textless{}{-}} \FunctionTok{assign\_classes\_pairwise}\NormalTok{(Q\_cid8.r, args}\SpecialCharTok{$}\NormalTok{arrays}\SpecialCharTok{$}\NormalTok{Q)}
\NormalTok{f.mu }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(mu1 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu2 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu3 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu4 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu5 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu6 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu7 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0)}
\NormalTok{f.lams }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(lam111 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam000, lam222 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam000, lam333 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam000,   }
\NormalTok{            lam555 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam444, lam666 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam444, lam777 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam444)}
\NormalTok{f.list}\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(zero.constr,  f.qs, f.mu, f.lams)}
\end{Highlighting}
\end{Shaded}

Run inference

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{CID8 }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
\NormalTok{i}\OtherTok{=}\DecValTok{1}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{NSIM)\{}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{\textquotesingle{}Working on: \textquotesingle{}}\NormalTok{, i))}
\NormalTok{  tree }\OtherTok{\textless{}{-}}\NormalTok{ phy[[i]]}
\NormalTok{  states}\OtherTok{\textless{}{-}}\NormalTok{ tree}\SpecialCharTok{$}\NormalTok{tip.state}
\NormalTok{  states}\OtherTok{\textless{}{-}} \FunctionTok{mapvalues}\NormalTok{(states, }\AttributeTok{from =} \FunctionTok{c}\NormalTok{(}\StringTok{"0"}\NormalTok{, }\StringTok{"1"}\NormalTok{, }\StringTok{"2"}\NormalTok{, }\StringTok{"3"}\NormalTok{), }\AttributeTok{to=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{) )}
\NormalTok{  root }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\DecValTok{8}\NormalTok{, }\DecValTok{8}\NormalTok{)}
  
\NormalTok{  lik.c }\OtherTok{\textless{}{-}} \FunctionTok{make.HiClasse\_cpp}\NormalTok{(tree, states,  }\AttributeTok{sampling.f=}\ConstantTok{NULL}\NormalTok{,  }\AttributeTok{strict=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{control=}\FunctionTok{list}\NormalTok{(}\AttributeTok{backend =} \StringTok{"gslode"}\NormalTok{), newArgs)}
\NormalTok{  lik.const }\OtherTok{\textless{}{-}} \FunctionTok{constrain}\NormalTok{(lik.c, }\AttributeTok{formulae =}\NormalTok{ f.list)}
\NormalTok{  arg.const }\OtherTok{\textless{}{-}} \FunctionTok{argnames}\NormalTok{(lik.const)}
\NormalTok{  starting.point }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[arg.const]}
  \CommentTok{\# starting.point \textless{}{-} get\_item(CID4[i], \textquotesingle{}par\textquotesingle{})}
  \CommentTok{\# names(starting.point) \textless{}{-} c(\textquotesingle{}lam444\textquotesingle{}, \textquotesingle{}lam000\textquotesingle{}, \textquotesingle{}mu0\textquotesingle{}, \textquotesingle{}q01\textquotesingle{}, \textquotesingle{}q02\textquotesingle{})}
  \CommentTok{\# starting.point[\textquotesingle{}q01\textquotesingle{}] \textless{}{-} starting.point[\textquotesingle{}q02\textquotesingle{}]/2}
  
\NormalTok{  CID8[[i]] }\OtherTok{\textless{}{-}} \FunctionTok{find.mle}\NormalTok{(lik.const, starting.point, }\AttributeTok{method=}\StringTok{"subplex"}\NormalTok{, }\AttributeTok{keep.func=}\NormalTok{F, }\AttributeTok{root=}\NormalTok{ROOT.GIVEN, }\AttributeTok{root.p=}\NormalTok{root, }\AttributeTok{condition.surv=}\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Working on: 1"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 2"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 3"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 4"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 5"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 6"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 7"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 8"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 9"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 10"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
\end{verbatim}

Assessing the inferred parameters

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID4, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID8, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID8[}\DecValTok{1}\NormalTok{], }\StringTok{\textquotesingle{}par\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       lam000       lam444          mu0          q01 
## 0.0509438630 0.0509155136 0.0003102256 0.0075620757
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID4[}\DecValTok{1}\NormalTok{], }\StringTok{\textquotesingle{}par\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       lam000       lam222          mu0          q01 
## 0.0509438630 0.0509155136 0.0003102256 0.0075620757
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#pars\_to\_arrays(CID8[[1]]$par.full, 8)}
\FunctionTok{pars\_to\_arrays}\NormalTok{(CID8[[}\DecValTok{1}\NormalTok{]]}\SpecialCharTok{$}\NormalTok{par.full, }\DecValTok{8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{reoder\_lambdas}\NormalTok{(., }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{7}\NormalTok{, }\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{8}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $lam.tensor
## $lam.tensor$`1`
##            [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,] 0.05094386    0    0    0    0    0    0    0
## [2,] 0.00000000    0    0    0    0    0    0    0
## [3,] 0.00000000    0    0    0    0    0    0    0
## [4,] 0.00000000    0    0    0    0    0    0    0
## [5,] 0.00000000    0    0    0    0    0    0    0
## [6,] 0.00000000    0    0    0    0    0    0    0
## [7,] 0.00000000    0    0    0    0    0    0    0
## [8,] 0.00000000    0    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.05094386    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2]       [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0 0.00000000    0    0    0    0    0
## [2,]    0    0 0.00000000    0    0    0    0    0
## [3,]    0    0 0.05091551    0    0    0    0    0
## [4,]    0    0 0.00000000    0    0    0    0    0
## [5,]    0    0 0.00000000    0    0    0    0    0
## [6,]    0    0 0.00000000    0    0    0    0    0
## [7,]    0    0 0.00000000    0    0    0    0    0
## [8,]    0    0 0.00000000    0    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.05091551    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05094386    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.05094386    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6]       [,7] [,8]
## [1,]    0    0    0    0    0    0 0.00000000    0
## [2,]    0    0    0    0    0    0 0.00000000    0
## [3,]    0    0    0    0    0    0 0.00000000    0
## [4,]    0    0    0    0    0    0 0.00000000    0
## [5,]    0    0    0    0    0    0 0.00000000    0
## [6,]    0    0    0    0    0    0 0.00000000    0
## [7,]    0    0    0    0    0    0 0.05091551    0
## [8,]    0    0    0    0    0    0 0.00000000    0
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.05091551
## 
## 
## $mu
##          mu0          mu2          mu4          mu6          mu1          mu3          mu5          mu7 
## 0.0003102256 0.0003102256 0.0003102256 0.0003102256 0.0003102256 0.0003102256 0.0003102256 0.0003102256 
## 
## $Q
##              [,1]         [,2]         [,3]         [,4]         [,5]         [,6]         [,7]         [,8]
## [1,] -0.022686227  0.007562076  0.007562076  0.000000000  0.007562076  0.000000000  0.000000000  0.000000000
## [2,]  0.007562076 -0.022686227  0.000000000  0.007562076  0.000000000  0.007562076  0.000000000  0.000000000
## [3,]  0.007562076  0.000000000 -0.022686227  0.007562076  0.000000000  0.000000000  0.007562076  0.000000000
## [4,]  0.000000000  0.007562076  0.007562076 -0.022686227  0.000000000  0.000000000  0.000000000  0.007562076
## [5,]  0.007562076  0.000000000  0.000000000  0.000000000 -0.022686227  0.007562076  0.007562076  0.000000000
## [6,]  0.000000000  0.007562076  0.000000000  0.000000000  0.007562076 -0.022686227  0.000000000  0.007562076
## [7,]  0.000000000  0.000000000  0.007562076  0.000000000  0.007562076  0.000000000 -0.022686227  0.007562076
## [8,]  0.000000000  0.000000000  0.000000000  0.007562076  0.000000000  0.007562076  0.007562076 -0.022686227
\end{verbatim}

\hypertarget{cor8-c}{%
\subsubsection{COR8-C}\label{cor8-c}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Args }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{Nstates =}\NormalTok{ 8L,}
  \AttributeTok{y =} \FunctionTok{list}\NormalTok{(}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{),}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{  ))}

\NormalTok{newArgs }\OtherTok{\textless{}{-}} \FunctionTok{makeArgs}\NormalTok{(Args)}
\CommentTok{\#printArgsGlobal()}
\NormalTok{args }\OtherTok{\textless{}{-}} \FunctionTok{argnames\_HiClaSSE}\NormalTok{(}\DecValTok{8}\NormalTok{)}
\CommentTok{\#args}
\CommentTok{\#args$pars}
\CommentTok{\#length(args$pars)}

\NormalTok{pars.hc }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{length}\NormalTok{(args}\SpecialCharTok{$}\NormalTok{pars))}
\FunctionTok{names}\NormalTok{(pars.hc) }\OtherTok{\textless{}{-}}\NormalTok{ args}\SpecialCharTok{$}\NormalTok{pars}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam111\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam333\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam444\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam555\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam666\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam777\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu0\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu1\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu2\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu3\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu4\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu5\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu6\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu7\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\FloatTok{0.1}
\NormalTok{qs }\OtherTok{\textless{}{-}} \FunctionTok{extract\_off\_diagonal}\NormalTok{(Q\_cor8\_C.r)}
\NormalTok{qsl}\OtherTok{=}\FunctionTok{length}\NormalTok{(qs)}
\NormalTok{pars.hc[}\FunctionTok{c}\NormalTok{(}\FunctionTok{length}\NormalTok{(pars.hc)}\SpecialCharTok{{-}}\NormalTok{qsl}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pars.hc)] }\OtherTok{\textless{}{-}}\NormalTok{ qs}

\CommentTok{\#pars.hc}
\CommentTok{\#pars\_to\_arrays(pars.hc,8)}
\CommentTok{\#args}

\NormalTok{zero.constr }\OtherTok{\textless{}{-}} \FunctionTok{formulas\_zero\_pars}\NormalTok{(pars.hc)}
\NormalTok{f.qs }\OtherTok{\textless{}{-}} \FunctionTok{assign\_classes\_pairwise}\NormalTok{(Q\_cor8\_C.r, args}\SpecialCharTok{$}\NormalTok{arrays}\SpecialCharTok{$}\NormalTok{Q)}
\NormalTok{f.mu }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(mu1 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu2 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu3 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu4 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu5 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu6 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu7 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0)}
\NormalTok{f.lams }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(lam111 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam000, lam222 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam000, lam333 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam000,   }
\NormalTok{            lam555 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam444, lam666 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam444, lam777 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam444)}
\NormalTok{f.list}\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(zero.constr,  f.qs, f.mu, f.lams)}
\end{Highlighting}
\end{Shaded}

Run inference

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{COR8\_C }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
\NormalTok{i}\OtherTok{=}\DecValTok{1}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{NSIM)\{}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{\textquotesingle{}Working on: \textquotesingle{}}\NormalTok{, i))}
\NormalTok{  tree }\OtherTok{\textless{}{-}}\NormalTok{ phy[[i]]}
\NormalTok{  states}\OtherTok{\textless{}{-}}\NormalTok{ tree}\SpecialCharTok{$}\NormalTok{tip.state}
\NormalTok{  states}\OtherTok{\textless{}{-}} \FunctionTok{mapvalues}\NormalTok{(states, }\AttributeTok{from =} \FunctionTok{c}\NormalTok{(}\StringTok{"0"}\NormalTok{, }\StringTok{"1"}\NormalTok{, }\StringTok{"2"}\NormalTok{, }\StringTok{"3"}\NormalTok{), }\AttributeTok{to=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{) )}
\NormalTok{  root }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\DecValTok{8}\NormalTok{, }\DecValTok{8}\NormalTok{)}
  
\NormalTok{  lik.c }\OtherTok{\textless{}{-}} \FunctionTok{make.HiClasse\_cpp}\NormalTok{(tree, states,  }\AttributeTok{sampling.f=}\ConstantTok{NULL}\NormalTok{,  }\AttributeTok{strict=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{control=}\FunctionTok{list}\NormalTok{(}\AttributeTok{backend =} \StringTok{"gslode"}\NormalTok{), newArgs)}
\NormalTok{  lik.const }\OtherTok{\textless{}{-}} \FunctionTok{constrain}\NormalTok{(lik.c, }\AttributeTok{formulae =}\NormalTok{ f.list)}
\NormalTok{  arg.const }\OtherTok{\textless{}{-}} \FunctionTok{argnames}\NormalTok{(lik.const)}
\NormalTok{  starting.point }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[arg.const]}
  \CommentTok{\# starting.point \textless{}{-} get\_item(CID8[i], \textquotesingle{}par\textquotesingle{})}
  \CommentTok{\# names(starting.point) \textless{}{-} arg.const}
  \CommentTok{\# starting.point[\textquotesingle{}q02\textquotesingle{}] \textless{}{-} get\_item(CID8[i], \textquotesingle{}par\textquotesingle{})[\textquotesingle{}q02\textquotesingle{}]}
  \CommentTok{\# starting.point[\textquotesingle{}q03\textquotesingle{}] \textless{}{-} get\_item(CID8[i], \textquotesingle{}par\textquotesingle{})[\textquotesingle{}q01\textquotesingle{}]}
\NormalTok{  COR8\_C[[i]] }\OtherTok{\textless{}{-}} \FunctionTok{find.mle}\NormalTok{(lik.const, starting.point, }\AttributeTok{method=}\StringTok{"subplex"}\NormalTok{, }\AttributeTok{keep.func=}\NormalTok{F, }\AttributeTok{root=}\NormalTok{ROOT.GIVEN, }\AttributeTok{root.p=}\NormalTok{root, }\AttributeTok{condition.surv=}\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Working on: 1"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 2"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 3"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 4"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 5"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 6"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 7"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 8"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 9"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 10"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
\end{verbatim}

Assessing the inferred parameters

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID4, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID8, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(COR8\_C, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(COR8\_C[}\DecValTok{1}\NormalTok{], }\StringTok{\textquotesingle{}par\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       lam000       lam444          mu0          q02 
## 0.0509438630 0.0509155136 0.0003102256 0.0075620757
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pars\_to\_arrays}\NormalTok{(COR8\_C[[}\DecValTok{1}\NormalTok{]]}\SpecialCharTok{$}\NormalTok{par.full, }\DecValTok{8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{reoder\_lambdas}\NormalTok{(., }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{7}\NormalTok{, }\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{8}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $lam.tensor
## $lam.tensor$`1`
##            [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,] 0.05094386    0    0    0    0    0    0    0
## [2,] 0.00000000    0    0    0    0    0    0    0
## [3,] 0.00000000    0    0    0    0    0    0    0
## [4,] 0.00000000    0    0    0    0    0    0    0
## [5,] 0.00000000    0    0    0    0    0    0    0
## [6,] 0.00000000    0    0    0    0    0    0    0
## [7,] 0.00000000    0    0    0    0    0    0    0
## [8,] 0.00000000    0    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.05094386    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2]       [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0 0.00000000    0    0    0    0    0
## [2,]    0    0 0.00000000    0    0    0    0    0
## [3,]    0    0 0.05091551    0    0    0    0    0
## [4,]    0    0 0.00000000    0    0    0    0    0
## [5,]    0    0 0.00000000    0    0    0    0    0
## [6,]    0    0 0.00000000    0    0    0    0    0
## [7,]    0    0 0.00000000    0    0    0    0    0
## [8,]    0    0 0.00000000    0    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.05091551    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05094386    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.05094386    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6]       [,7] [,8]
## [1,]    0    0    0    0    0    0 0.00000000    0
## [2,]    0    0    0    0    0    0 0.00000000    0
## [3,]    0    0    0    0    0    0 0.00000000    0
## [4,]    0    0    0    0    0    0 0.00000000    0
## [5,]    0    0    0    0    0    0 0.00000000    0
## [6,]    0    0    0    0    0    0 0.00000000    0
## [7,]    0    0    0    0    0    0 0.05091551    0
## [8,]    0    0    0    0    0    0 0.00000000    0
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.05091551
## 
## 
## $mu
##          mu0          mu2          mu4          mu6          mu1          mu3          mu5          mu7 
## 0.0003102256 0.0003102256 0.0003102256 0.0003102256 0.0003102256 0.0003102256 0.0003102256 0.0003102256 
## 
## $Q
##              [,1]         [,2]         [,3]         [,4]         [,5]         [,6]         [,7]         [,8]
## [1,] -0.022686227  0.007562076  0.007562076  0.000000000  0.000000000  0.007562076  0.000000000  0.000000000
## [2,]  0.007562076 -0.022686227  0.000000000  0.007562076  0.007562076  0.000000000  0.000000000  0.000000000
## [3,]  0.007562076  0.000000000 -0.022686227  0.007562076  0.000000000  0.000000000  0.000000000  0.007562076
## [4,]  0.000000000  0.007562076  0.007562076 -0.022686227  0.000000000  0.000000000  0.007562076  0.000000000
## [5,]  0.000000000  0.007562076  0.000000000  0.000000000 -0.022686227  0.007562076  0.007562076  0.000000000
## [6,]  0.007562076  0.000000000  0.000000000  0.000000000  0.007562076 -0.022686227  0.000000000  0.007562076
## [7,]  0.000000000  0.000000000  0.000000000  0.007562076  0.007562076  0.000000000 -0.022686227  0.007562076
## [8,]  0.000000000  0.000000000  0.007562076  0.000000000  0.000000000  0.007562076  0.007562076 -0.022686227
\end{verbatim}

\hypertarget{cor8-nc}{%
\subsubsection{COR8-NC}\label{cor8-nc}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Args }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{Nstates =}\NormalTok{ 8L,}
  \AttributeTok{y =} \FunctionTok{list}\NormalTok{(}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{),}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{  ))}

\NormalTok{newArgs }\OtherTok{\textless{}{-}} \FunctionTok{makeArgs}\NormalTok{(Args)}
\CommentTok{\#printArgsGlobal()}
\NormalTok{args }\OtherTok{\textless{}{-}} \FunctionTok{argnames\_HiClaSSE}\NormalTok{(}\DecValTok{8}\NormalTok{)}
\CommentTok{\#args}
\CommentTok{\#args$pars}
\CommentTok{\#length(args$pars)}

\NormalTok{pars.hc }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{length}\NormalTok{(args}\SpecialCharTok{$}\NormalTok{pars))}
\FunctionTok{names}\NormalTok{(pars.hc) }\OtherTok{\textless{}{-}}\NormalTok{ args}\SpecialCharTok{$}\NormalTok{pars}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam000\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam111\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam222\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam333\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam444\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam555\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam666\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam777\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu0\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu1\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu2\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu3\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu4\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu5\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu6\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu7\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\FloatTok{0.1}
\NormalTok{qs }\OtherTok{\textless{}{-}} \FunctionTok{extract\_off\_diagonal}\NormalTok{(Q\_cor8\_NC.r)}
\NormalTok{qsl}\OtherTok{=}\FunctionTok{length}\NormalTok{(qs)}
\NormalTok{pars.hc[}\FunctionTok{c}\NormalTok{(}\FunctionTok{length}\NormalTok{(pars.hc)}\SpecialCharTok{{-}}\NormalTok{qsl}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pars.hc)] }\OtherTok{\textless{}{-}}\NormalTok{ qs}

\CommentTok{\#pars.hc}
\CommentTok{\#pars\_to\_arrays(pars.hc,8)}
\CommentTok{\#args}

\NormalTok{zero.constr }\OtherTok{\textless{}{-}} \FunctionTok{formulas\_zero\_pars}\NormalTok{(pars.hc)}
\NormalTok{f.qs }\OtherTok{\textless{}{-}} \FunctionTok{assign\_classes\_pairwise}\NormalTok{(Q\_cor8\_NC.r, args}\SpecialCharTok{$}\NormalTok{arrays}\SpecialCharTok{$}\NormalTok{Q)}
\NormalTok{f.mu }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(mu1 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu2 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu3 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu4 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu5 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu6 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu7 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0)}
\NormalTok{f.lams }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(lam111 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam000, lam222 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam000, lam333 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam000,   }
\NormalTok{            lam555 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam444, lam666 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam444, lam777 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam444)}
\NormalTok{f.list}\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(zero.constr,  f.qs, f.mu, f.lams)}
\end{Highlighting}
\end{Shaded}

Run inference

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{COR8\_NC }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
\NormalTok{i}\OtherTok{=}\DecValTok{1}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{NSIM)\{}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{\textquotesingle{}Working on: \textquotesingle{}}\NormalTok{, i))}
\NormalTok{  tree }\OtherTok{\textless{}{-}}\NormalTok{ phy[[i]]}
\NormalTok{  states}\OtherTok{\textless{}{-}}\NormalTok{ tree}\SpecialCharTok{$}\NormalTok{tip.state}
\NormalTok{  states}\OtherTok{\textless{}{-}} \FunctionTok{mapvalues}\NormalTok{(states, }\AttributeTok{from =} \FunctionTok{c}\NormalTok{(}\StringTok{"0"}\NormalTok{, }\StringTok{"1"}\NormalTok{, }\StringTok{"2"}\NormalTok{, }\StringTok{"3"}\NormalTok{), }\AttributeTok{to=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{) )}
\NormalTok{  root }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\DecValTok{8}\NormalTok{, }\DecValTok{8}\NormalTok{)}
  
\NormalTok{  lik.c }\OtherTok{\textless{}{-}} \FunctionTok{make.HiClasse\_cpp}\NormalTok{(tree, states,  }\AttributeTok{sampling.f=}\ConstantTok{NULL}\NormalTok{,  }\AttributeTok{strict=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{control=}\FunctionTok{list}\NormalTok{(}\AttributeTok{backend =} \StringTok{"gslode"}\NormalTok{), newArgs)}
\NormalTok{  lik.const }\OtherTok{\textless{}{-}} \FunctionTok{constrain}\NormalTok{(lik.c, }\AttributeTok{formulae =}\NormalTok{ f.list)}
\NormalTok{  arg.const }\OtherTok{\textless{}{-}} \FunctionTok{argnames}\NormalTok{(lik.const)}
  \CommentTok{\# starting.point \textless{}{-} pars.hc[arg.const]}
\NormalTok{  starting.point }\OtherTok{\textless{}{-}} \FunctionTok{get\_item}\NormalTok{(COR8\_C[i], }\StringTok{\textquotesingle{}par\textquotesingle{}}\NormalTok{)}
\NormalTok{  COR8\_NC[[i]] }\OtherTok{\textless{}{-}} \FunctionTok{find.mle}\NormalTok{(lik.const, starting.point, }\AttributeTok{method=}\StringTok{"subplex"}\NormalTok{, }\AttributeTok{keep.func=}\NormalTok{F, }\AttributeTok{root=}\NormalTok{ROOT.GIVEN, }\AttributeTok{root.p=}\NormalTok{root, }\AttributeTok{condition.surv=}\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Working on: 1"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 2"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 3"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 4"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 5"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 6"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 7"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 8"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 9"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 10"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
\end{verbatim}

Assessing the inferred parameters

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID4, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID8, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(COR8\_NC, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -439.3721 -428.0217 -411.3027 -421.3187 -422.2212 -416.0885 -435.6355 -428.1737 -422.4050 -398.2370
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID8[}\DecValTok{1}\NormalTok{], }\StringTok{\textquotesingle{}par\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       lam000       lam444          mu0          q01 
## 0.0509438630 0.0509155136 0.0003102256 0.0075620757
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pars\_to\_arrays}\NormalTok{(COR8\_NC[[}\DecValTok{1}\NormalTok{]]}\SpecialCharTok{$}\NormalTok{par.full, }\DecValTok{8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{reoder\_lambdas}\NormalTok{(., }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{7}\NormalTok{, }\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{8}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $lam.tensor
## $lam.tensor$`1`
##            [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,] 0.06507655    0    0    0    0    0    0    0
## [2,] 0.00000000    0    0    0    0    0    0    0
## [3,] 0.00000000    0    0    0    0    0    0    0
## [4,] 0.00000000    0    0    0    0    0    0    0
## [5,] 0.00000000    0    0    0    0    0    0    0
## [6,] 0.00000000    0    0    0    0    0    0    0
## [7,] 0.00000000    0    0    0    0    0    0    0
## [8,] 0.00000000    0    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.06507655    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2]         [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0 0.000000e+00    0    0    0    0    0
## [2,]    0    0 0.000000e+00    0    0    0    0    0
## [3,]    0    0 1.009869e-06    0    0    0    0    0
## [4,]    0    0 0.000000e+00    0    0    0    0    0
## [5,]    0    0 0.000000e+00    0    0    0    0    0
## [6,]    0    0 0.000000e+00    0    0    0    0    0
## [7,]    0    0 0.000000e+00    0    0    0    0    0
## [8,]    0    0 0.000000e+00    0    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]         [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.000000e+00    0    0    0    0
## [2,]    0    0    0 0.000000e+00    0    0    0    0
## [3,]    0    0    0 0.000000e+00    0    0    0    0
## [4,]    0    0    0 1.009869e-06    0    0    0    0
## [5,]    0    0    0 0.000000e+00    0    0    0    0
## [6,]    0    0    0 0.000000e+00    0    0    0    0
## [7,]    0    0    0 0.000000e+00    0    0    0    0
## [8,]    0    0    0 0.000000e+00    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.06507655    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.06507655    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6]         [,7] [,8]
## [1,]    0    0    0    0    0    0 0.000000e+00    0
## [2,]    0    0    0    0    0    0 0.000000e+00    0
## [3,]    0    0    0    0    0    0 0.000000e+00    0
## [4,]    0    0    0    0    0    0 0.000000e+00    0
## [5,]    0    0    0    0    0    0 0.000000e+00    0
## [6,]    0    0    0    0    0    0 0.000000e+00    0
## [7,]    0    0    0    0    0    0 1.009869e-06    0
## [8,]    0    0    0    0    0    0 0.000000e+00    0
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]         [,8]
## [1,]    0    0    0    0    0    0    0 0.000000e+00
## [2,]    0    0    0    0    0    0    0 0.000000e+00
## [3,]    0    0    0    0    0    0    0 0.000000e+00
## [4,]    0    0    0    0    0    0    0 0.000000e+00
## [5,]    0    0    0    0    0    0    0 0.000000e+00
## [6,]    0    0    0    0    0    0    0 0.000000e+00
## [7,]    0    0    0    0    0    0    0 0.000000e+00
## [8,]    0    0    0    0    0    0    0 1.009869e-06
## 
## 
## $mu
##         mu0         mu2         mu4         mu6         mu1         mu3         mu5         mu7 
## 0.002305683 0.002305683 0.002305683 0.002305683 0.002305683 0.002305683 0.002305683 0.002305683 
## 
## $Q
##             [,1]        [,2]        [,3]        [,4]        [,5]        [,6]        [,7]        [,8]
## [1,] -0.06100916  0.02033639  0.02033639  0.00000000  0.00000000  0.02033639  0.00000000  0.00000000
## [2,]  0.02033639 -0.04067278  0.00000000  0.02033639  0.00000000  0.00000000  0.00000000  0.00000000
## [3,]  0.02033639  0.00000000 -0.06100916  0.02033639  0.00000000  0.00000000  0.00000000  0.02033639
## [4,]  0.00000000  0.02033639  0.02033639 -0.04067278  0.00000000  0.00000000  0.00000000  0.00000000
## [5,]  0.00000000  0.02033639  0.00000000  0.00000000 -0.06100916  0.02033639  0.02033639  0.00000000
## [6,]  0.00000000  0.00000000  0.00000000  0.00000000  0.02033639 -0.04067278  0.00000000  0.02033639
## [7,]  0.00000000  0.00000000  0.00000000  0.02033639  0.02033639  0.00000000 -0.06100916  0.02033639
## [8,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.02033639  0.02033639 -0.04067278
\end{verbatim}

\hypertarget{cla8-c}{%
\subsubsection{CLA8-C}\label{cla8-c}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Args }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{Nstates =}\NormalTok{ 8L,}
  \AttributeTok{y =} \FunctionTok{list}\NormalTok{(}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{),}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{  ))}

\NormalTok{newArgs }\OtherTok{\textless{}{-}} \FunctionTok{makeArgs}\NormalTok{(Args)}
\CommentTok{\#printArgsGlobal()}
\NormalTok{args }\OtherTok{\textless{}{-}} \FunctionTok{argnames\_HiClaSSE}\NormalTok{(}\DecValTok{8}\NormalTok{)}
\CommentTok{\#args}
\CommentTok{\#args$pars}
\CommentTok{\#length(args$pars)}

\NormalTok{pars.hc }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{length}\NormalTok{(args}\SpecialCharTok{$}\NormalTok{pars))}
\FunctionTok{names}\NormalTok{(pars.hc) }\OtherTok{\textless{}{-}}\NormalTok{ args}\SpecialCharTok{$}\NormalTok{pars}
\CommentTok{\# pars.hc[\textquotesingle{}lam000\textquotesingle{}] \textless{}{-} 0.1}
\CommentTok{\# pars.hc[\textquotesingle{}lam111\textquotesingle{}] \textless{}{-} 0.1}
\CommentTok{\# pars.hc[\textquotesingle{}lam222\textquotesingle{}] \textless{}{-} 0.1}
\CommentTok{\# pars.hc[\textquotesingle{}lam333\textquotesingle{}] \textless{}{-} 0.1}
\CommentTok{\# pars.hc[\textquotesingle{}lam444\textquotesingle{}] \textless{}{-} 0.05}
\CommentTok{\# pars.hc[\textquotesingle{}lam555\textquotesingle{}] \textless{}{-} 0.05}
\CommentTok{\# pars.hc[\textquotesingle{}lam666\textquotesingle{}] \textless{}{-} 0.05}
\CommentTok{\# pars.hc[\textquotesingle{}lam777\textquotesingle{}] \textless{}{-} 0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam022\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam133\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam202\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam311\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam466\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam577\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam646\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam757\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu0\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu1\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu2\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu3\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu4\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu5\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu6\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu7\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\FloatTok{0.1}
\NormalTok{qs }\OtherTok{\textless{}{-}} \FunctionTok{extract\_off\_diagonal}\NormalTok{(Q\_cor8\_C.r)}
\NormalTok{qsl}\OtherTok{=}\FunctionTok{length}\NormalTok{(qs)}
\NormalTok{pars.hc[}\FunctionTok{c}\NormalTok{(}\FunctionTok{length}\NormalTok{(pars.hc)}\SpecialCharTok{{-}}\NormalTok{qsl}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pars.hc)] }\OtherTok{\textless{}{-}}\NormalTok{ qs}

\CommentTok{\#pars.hc}
\CommentTok{\#pars\_to\_arrays(pars.hc,8)}
\CommentTok{\#args}

\NormalTok{zero.constr }\OtherTok{\textless{}{-}} \FunctionTok{formulas\_zero\_pars}\NormalTok{(pars.hc)}
\NormalTok{f.qs }\OtherTok{\textless{}{-}} \FunctionTok{assign\_classes\_pairwise}\NormalTok{(Q\_cor8\_C.r, args}\SpecialCharTok{$}\NormalTok{arrays}\SpecialCharTok{$}\NormalTok{Q)}
\NormalTok{f.mu }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(mu1 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu2 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu3 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu4 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu5 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu6 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu7 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0)}
\NormalTok{f.lams }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(lam133 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam022, lam202 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam022, lam311 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam022,   }
\NormalTok{            lam577 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam466, lam646 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam466, lam757 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam466)}
\NormalTok{f.list}\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(zero.constr,  f.qs, f.mu, f.lams)}
\end{Highlighting}
\end{Shaded}

Run inference

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{CLA8\_C }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
\NormalTok{i}\OtherTok{=}\DecValTok{1}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{NSIM)\{}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{\textquotesingle{}Working on: \textquotesingle{}}\NormalTok{, i))}
\NormalTok{  tree }\OtherTok{\textless{}{-}}\NormalTok{ phy[[i]]}
\NormalTok{  states}\OtherTok{\textless{}{-}}\NormalTok{ tree}\SpecialCharTok{$}\NormalTok{tip.state}
\NormalTok{  states}\OtherTok{\textless{}{-}} \FunctionTok{mapvalues}\NormalTok{(states, }\AttributeTok{from =} \FunctionTok{c}\NormalTok{(}\StringTok{"0"}\NormalTok{, }\StringTok{"1"}\NormalTok{, }\StringTok{"2"}\NormalTok{, }\StringTok{"3"}\NormalTok{), }\AttributeTok{to=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{) )}
\NormalTok{  root }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\DecValTok{8}\NormalTok{, }\DecValTok{8}\NormalTok{)}
  
\NormalTok{  lik.c }\OtherTok{\textless{}{-}} \FunctionTok{make.HiClasse\_cpp}\NormalTok{(tree, states,  }\AttributeTok{sampling.f=}\ConstantTok{NULL}\NormalTok{,  }\AttributeTok{strict=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{control=}\FunctionTok{list}\NormalTok{(}\AttributeTok{backend =} \StringTok{"gslode"}\NormalTok{), newArgs)}
\NormalTok{  lik.const }\OtherTok{\textless{}{-}} \FunctionTok{constrain}\NormalTok{(lik.c, }\AttributeTok{formulae =}\NormalTok{ f.list)}
\NormalTok{  arg.const }\OtherTok{\textless{}{-}} \FunctionTok{argnames}\NormalTok{(lik.const)}
  \CommentTok{\#starting.point \textless{}{-} pars.hc[arg.const]}
\NormalTok{  starting.point }\OtherTok{\textless{}{-}} \FunctionTok{get\_item}\NormalTok{(COR8\_C[i], }\StringTok{\textquotesingle{}par\textquotesingle{}}\NormalTok{)}
  \FunctionTok{names}\NormalTok{(starting.point) }\OtherTok{\textless{}{-}}\NormalTok{ arg.const}
\NormalTok{  CLA8\_C[[i]] }\OtherTok{\textless{}{-}} \FunctionTok{find.mle}\NormalTok{(lik.const, starting.point, }\AttributeTok{method=}\StringTok{"subplex"}\NormalTok{, }\AttributeTok{keep.func=}\NormalTok{F, }\AttributeTok{root=}\NormalTok{ROOT.GIVEN, }\AttributeTok{root.p=}\NormalTok{root, }\AttributeTok{condition.surv=}\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Working on: 1"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 2"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 3"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 4"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 5"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 6"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 7"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 8"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 9"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 10"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
\end{verbatim}

Assessing the inferred parameters

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID4, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CLA8\_C, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9548 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7798 -429.2834 -421.0964 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID8[}\DecValTok{1}\NormalTok{], }\StringTok{\textquotesingle{}par\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       lam000       lam444          mu0          q01 
## 0.0509438630 0.0509155136 0.0003102256 0.0075620757
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pars\_to\_arrays}\NormalTok{(CLA8\_C[[}\DecValTok{1}\NormalTok{]]}\SpecialCharTok{$}\NormalTok{par.full, }\DecValTok{8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{reoder\_lambdas}\NormalTok{(., }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{7}\NormalTok{, }\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{8}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $lam.tensor
## $lam.tensor$`1`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.05095631    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.05095631    0    0    0    0    0    0
## [2,]    0 0.00000000    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.05097545    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.05097545    0    0    0    0
## [4,]    0    0    0 0.00000000    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.05095631    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05095631    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.05097545
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.05097545
## [8,]    0    0    0    0    0    0    0 0.00000000
## 
## 
## $mu
##          mu0          mu2          mu4          mu6          mu1          mu3          mu5          mu7 
## 0.0003971397 0.0003971397 0.0003971397 0.0003971397 0.0003971397 0.0003971397 0.0003971397 0.0003971397 
## 
## $Q
##              [,1]         [,2]         [,3]         [,4]         [,5]         [,6]         [,7]         [,8]
## [1,] -0.022680368  0.007560123  0.007560123  0.000000000  0.000000000  0.007560123  0.000000000  0.000000000
## [2,]  0.007560123 -0.022680368  0.000000000  0.007560123  0.007560123  0.000000000  0.000000000  0.000000000
## [3,]  0.007560123  0.000000000 -0.022680368  0.007560123  0.000000000  0.000000000  0.000000000  0.007560123
## [4,]  0.000000000  0.007560123  0.007560123 -0.022680368  0.000000000  0.000000000  0.007560123  0.000000000
## [5,]  0.000000000  0.007560123  0.000000000  0.000000000 -0.022680368  0.007560123  0.007560123  0.000000000
## [6,]  0.007560123  0.000000000  0.000000000  0.000000000  0.007560123 -0.022680368  0.000000000  0.007560123
## [7,]  0.000000000  0.000000000  0.000000000  0.007560123  0.007560123  0.000000000 -0.022680368  0.007560123
## [8,]  0.000000000  0.000000000  0.007560123  0.000000000  0.000000000  0.007560123  0.007560123 -0.022680368
\end{verbatim}

\hypertarget{cla8-nc}{%
\subsubsection{CLA8-NC}\label{cla8-nc}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Args }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{Nstates =}\NormalTok{ 8L,}
  \AttributeTok{y =} \FunctionTok{list}\NormalTok{(}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{),}
    \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{  ))}

\NormalTok{newArgs }\OtherTok{\textless{}{-}} \FunctionTok{makeArgs}\NormalTok{(Args)}
\CommentTok{\#printArgsGlobal()}
\NormalTok{args }\OtherTok{\textless{}{-}} \FunctionTok{argnames\_HiClaSSE}\NormalTok{(}\DecValTok{8}\NormalTok{)}
\CommentTok{\#args}
\CommentTok{\#args$pars}
\CommentTok{\#length(args$pars)}

\NormalTok{pars.hc }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{length}\NormalTok{(args}\SpecialCharTok{$}\NormalTok{pars))}
\FunctionTok{names}\NormalTok{(pars.hc) }\OtherTok{\textless{}{-}}\NormalTok{ args}\SpecialCharTok{$}\NormalTok{pars}
\CommentTok{\# pars.hc[\textquotesingle{}lam000\textquotesingle{}] \textless{}{-} 0.1}
\CommentTok{\# pars.hc[\textquotesingle{}lam111\textquotesingle{}] \textless{}{-} 0.1}
\CommentTok{\# pars.hc[\textquotesingle{}lam222\textquotesingle{}] \textless{}{-} 0.1}
\CommentTok{\# pars.hc[\textquotesingle{}lam333\textquotesingle{}] \textless{}{-} 0.1}
\CommentTok{\# pars.hc[\textquotesingle{}lam444\textquotesingle{}] \textless{}{-} 0.05}
\CommentTok{\# pars.hc[\textquotesingle{}lam555\textquotesingle{}] \textless{}{-} 0.05}
\CommentTok{\# pars.hc[\textquotesingle{}lam666\textquotesingle{}] \textless{}{-} 0.05}
\CommentTok{\# pars.hc[\textquotesingle{}lam777\textquotesingle{}] \textless{}{-} 0.05}
\CommentTok{\# lam004, lam116, lam422 violate lumpability}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam004\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam116\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam202\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam311\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam422\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam577\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam646\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}lam757\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu0\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{pars.hc[}\StringTok{\textquotesingle{}mu1\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu2\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu3\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu4\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu5\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu6\textquotesingle{}}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{ pars.hc[}\StringTok{\textquotesingle{}mu7\textquotesingle{}}\NormalTok{] }\OtherTok{\textless{}{-}}\FloatTok{0.1}
\NormalTok{qs }\OtherTok{\textless{}{-}} \FunctionTok{extract\_off\_diagonal}\NormalTok{(Q\_cor8\_C.r)}
\NormalTok{qsl}\OtherTok{=}\FunctionTok{length}\NormalTok{(qs)}
\NormalTok{pars.hc[}\FunctionTok{c}\NormalTok{(}\FunctionTok{length}\NormalTok{(pars.hc)}\SpecialCharTok{{-}}\NormalTok{qsl}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pars.hc)] }\OtherTok{\textless{}{-}}\NormalTok{ qs}

\CommentTok{\#pars.hc}
\CommentTok{\#pars\_to\_arrays(pars.hc,8)}
\CommentTok{\#args}

\NormalTok{zero.constr }\OtherTok{\textless{}{-}} \FunctionTok{formulas\_zero\_pars}\NormalTok{(pars.hc)}
\NormalTok{f.qs }\OtherTok{\textless{}{-}} \FunctionTok{assign\_classes\_pairwise}\NormalTok{(Q\_cor8\_C.r, args}\SpecialCharTok{$}\NormalTok{arrays}\SpecialCharTok{$}\NormalTok{Q)}
\NormalTok{f.mu }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(mu1 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu2 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu3 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu4 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu5 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu6 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0, mu7 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mu0)}
\NormalTok{f.lams }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(lam116 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam004, lam202 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam004, lam311 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam004,   }
\NormalTok{            lam577 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam422, lam646 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam422, lam757 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lam422)}
\NormalTok{f.list}\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(zero.constr,  f.qs, f.mu, f.lams)}
\end{Highlighting}
\end{Shaded}

Run inference

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{CLA8\_NC }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
\NormalTok{i}\OtherTok{=}\DecValTok{1}
\CommentTok{\# skip 4 as mle search gets stuck and R crushes}
\NormalTok{seq }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\NormalTok{seq }\OtherTok{\textless{}{-}}\NormalTok{seq[}\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{]}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in}\NormalTok{ seq)\{}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{\textquotesingle{}Working on: \textquotesingle{}}\NormalTok{, i))}
\NormalTok{  tree }\OtherTok{\textless{}{-}}\NormalTok{ phy[[i]]}
\NormalTok{  states}\OtherTok{\textless{}{-}}\NormalTok{ tree}\SpecialCharTok{$}\NormalTok{tip.state}
\NormalTok{  states}\OtherTok{\textless{}{-}} \FunctionTok{mapvalues}\NormalTok{(states, }\AttributeTok{from =} \FunctionTok{c}\NormalTok{(}\StringTok{"0"}\NormalTok{, }\StringTok{"1"}\NormalTok{, }\StringTok{"2"}\NormalTok{, }\StringTok{"3"}\NormalTok{), }\AttributeTok{to=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{) )}
\NormalTok{  root }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\DecValTok{8}\NormalTok{, }\DecValTok{8}\NormalTok{)}
  
\NormalTok{  lik.c }\OtherTok{\textless{}{-}} \FunctionTok{make.HiClasse\_cpp}\NormalTok{(tree, states,  }\AttributeTok{sampling.f=}\ConstantTok{NULL}\NormalTok{,  }\AttributeTok{strict=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{control=}\FunctionTok{list}\NormalTok{(}\AttributeTok{backend =} \StringTok{"gslode"}\NormalTok{), newArgs)}
\NormalTok{  lik.const }\OtherTok{\textless{}{-}} \FunctionTok{constrain}\NormalTok{(lik.c, }\AttributeTok{formulae =}\NormalTok{ f.list)}
\NormalTok{  arg.const }\OtherTok{\textless{}{-}} \FunctionTok{argnames}\NormalTok{(lik.const)}
  \CommentTok{\#starting.point \textless{}{-} pars.hc[arg.const]}
\NormalTok{  starting.point }\OtherTok{\textless{}{-}} \FunctionTok{get\_item}\NormalTok{(CLA8\_C[i], }\StringTok{\textquotesingle{}par\textquotesingle{}}\NormalTok{)}
  \FunctionTok{names}\NormalTok{(starting.point) }\OtherTok{\textless{}{-}}\NormalTok{ arg.const}
\NormalTok{  CLA8\_NC[[i]] }\OtherTok{\textless{}{-}} \FunctionTok{find.mle}\NormalTok{(lik.const, starting.point, }\AttributeTok{method=}\StringTok{"subplex"}\NormalTok{, }\AttributeTok{keep.func=}\NormalTok{F, }\AttributeTok{root=}\NormalTok{ROOT.GIVEN, }\AttributeTok{root.p=}\NormalTok{root, }\AttributeTok{condition.surv=}\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Working on: 1"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 2"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 3"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 5"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 6"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 7"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 8"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 9"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
## [1] "Working on: 10"
## [1] "Recoding: 0010 -> 0000000010101010"
## [1] "Recoding: 0001 -> 0000000001010101"
\end{verbatim}

Assessing the inferred parameters

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID4, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -438.9549 -427.5105 -410.6673 -420.5590 -421.6901 -414.8487 -435.7799 -429.2834 -421.0965 -397.1996
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(COR8\_NC, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -439.3721 -428.0217 -411.3027 -421.3187 -422.2212 -416.0885 -435.6355 -428.1737 -422.4050 -398.2370
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CLA8\_NC, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -428.8063 -423.3527 -407.0617 -417.3582 -411.1370 -427.4852 -424.7370 -416.0654 -394.4739
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{get\_item}\NormalTok{(CID8[}\DecValTok{1}\NormalTok{], }\StringTok{\textquotesingle{}par\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       lam000       lam444          mu0          q01 
## 0.0509438630 0.0509155136 0.0003102256 0.0075620757
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pars\_to\_arrays}\NormalTok{(CLA8\_C[[}\DecValTok{1}\NormalTok{]]}\SpecialCharTok{$}\NormalTok{par.full, }\DecValTok{8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{reoder\_lambdas}\NormalTok{(., }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{7}\NormalTok{, }\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{8}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $lam.tensor
## $lam.tensor$`1`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.00000000    0    0    0    0    0    0
## [2,]    0 0.05095631    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`3`
##      [,1]       [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0 0.05095631    0    0    0    0    0    0
## [2,]    0 0.00000000    0    0    0    0    0    0
## [3,]    0 0.00000000    0    0    0    0    0    0
## [4,]    0 0.00000000    0    0    0    0    0    0
## [5,]    0 0.00000000    0    0    0    0    0    0
## [6,]    0 0.00000000    0    0    0    0    0    0
## [7,]    0 0.00000000    0    0    0    0    0    0
## [8,]    0 0.00000000    0    0    0    0    0    0
## 
## $lam.tensor$`5`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.00000000    0    0    0    0
## [4,]    0    0    0 0.05097545    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`7`
##      [,1] [,2] [,3]       [,4] [,5] [,6] [,7] [,8]
## [1,]    0    0    0 0.00000000    0    0    0    0
## [2,]    0    0    0 0.00000000    0    0    0    0
## [3,]    0    0    0 0.05097545    0    0    0    0
## [4,]    0    0    0 0.00000000    0    0    0    0
## [5,]    0    0    0 0.00000000    0    0    0    0
## [6,]    0    0    0 0.00000000    0    0    0    0
## [7,]    0    0    0 0.00000000    0    0    0    0
## [8,]    0    0    0 0.00000000    0    0    0    0
## 
## $lam.tensor$`2`
##      [,1] [,2] [,3] [,4] [,5]       [,6] [,7] [,8]
## [1,]    0    0    0    0    0 0.00000000    0    0
## [2,]    0    0    0    0    0 0.00000000    0    0
## [3,]    0    0    0    0    0 0.00000000    0    0
## [4,]    0    0    0    0    0 0.00000000    0    0
## [5,]    0    0    0    0    0 0.00000000    0    0
## [6,]    0    0    0    0    0 0.05095631    0    0
## [7,]    0    0    0    0    0 0.00000000    0    0
## [8,]    0    0    0    0    0 0.00000000    0    0
## 
## $lam.tensor$`4`
##      [,1] [,2] [,3] [,4]       [,5] [,6] [,7] [,8]
## [1,]    0    0    0    0 0.00000000    0    0    0
## [2,]    0    0    0    0 0.00000000    0    0    0
## [3,]    0    0    0    0 0.00000000    0    0    0
## [4,]    0    0    0    0 0.00000000    0    0    0
## [5,]    0    0    0    0 0.05095631    0    0    0
## [6,]    0    0    0    0 0.00000000    0    0    0
## [7,]    0    0    0    0 0.00000000    0    0    0
## [8,]    0    0    0    0 0.00000000    0    0    0
## 
## $lam.tensor$`6`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.00000000
## [8,]    0    0    0    0    0    0    0 0.05097545
## 
## $lam.tensor$`8`
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]       [,8]
## [1,]    0    0    0    0    0    0    0 0.00000000
## [2,]    0    0    0    0    0    0    0 0.00000000
## [3,]    0    0    0    0    0    0    0 0.00000000
## [4,]    0    0    0    0    0    0    0 0.00000000
## [5,]    0    0    0    0    0    0    0 0.00000000
## [6,]    0    0    0    0    0    0    0 0.00000000
## [7,]    0    0    0    0    0    0    0 0.05097545
## [8,]    0    0    0    0    0    0    0 0.00000000
## 
## 
## $mu
##          mu0          mu2          mu4          mu6          mu1          mu3          mu5          mu7 
## 0.0003971397 0.0003971397 0.0003971397 0.0003971397 0.0003971397 0.0003971397 0.0003971397 0.0003971397 
## 
## $Q
##              [,1]         [,2]         [,3]         [,4]         [,5]         [,6]         [,7]         [,8]
## [1,] -0.022680368  0.007560123  0.007560123  0.000000000  0.000000000  0.007560123  0.000000000  0.000000000
## [2,]  0.007560123 -0.022680368  0.000000000  0.007560123  0.007560123  0.000000000  0.000000000  0.000000000
## [3,]  0.007560123  0.000000000 -0.022680368  0.007560123  0.000000000  0.000000000  0.000000000  0.007560123
## [4,]  0.000000000  0.007560123  0.007560123 -0.022680368  0.000000000  0.000000000  0.007560123  0.000000000
## [5,]  0.000000000  0.007560123  0.000000000  0.000000000 -0.022680368  0.007560123  0.007560123  0.000000000
## [6,]  0.007560123  0.000000000  0.000000000  0.000000000  0.007560123 -0.022680368  0.000000000  0.007560123
## [7,]  0.000000000  0.000000000  0.000000000  0.007560123  0.007560123  0.000000000 -0.022680368  0.007560123
## [8,]  0.000000000  0.000000000  0.007560123  0.000000000  0.000000000  0.007560123  0.007560123 -0.022680368
\end{verbatim}

\hypertarget{results}{%
\subsection{Results}\label{results}}

\hypertarget{inferences-using-parameters-from-cid4-1}{%
\subsubsection{Inferences using parameters from CID4}\label{inferences-using-parameters-from-cid4-1}}

\hypertarget{likelihood-table}{%
\paragraph{Likelihood table}\label{likelihood-table}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cid4 }\OtherTok{=} \FunctionTok{get\_item}\NormalTok{(CID4, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{)}

\NormalTok{cor.pars }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
\StringTok{"N"} \OtherTok{=} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\NormalTok{NSIM),}
\StringTok{"cid4"} \OtherTok{=}\NormalTok{ cid4,}
\StringTok{"CID8.pars"}\OtherTok{=}\NormalTok{ CID8.pars }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist,}
\StringTok{"COR8{-}C.pars"}\OtherTok{=}\NormalTok{ COR8\_C.pars }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist,}
\StringTok{"CLA8{-}C.pars"} \OtherTok{=}\NormalTok{ CLA8\_C.pars }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist,}
\StringTok{"COR8{-}NC.pars"} \OtherTok{=}\NormalTok{ COR8\_NC.pars }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist,}
\StringTok{"CLA8{-}NC.pars"} \OtherTok{=}\NormalTok{ CLA8\_NC.pars }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist,}
\NormalTok{)}

\FunctionTok{kable}\NormalTok{(cor.pars, }\StringTok{"html"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{(}\AttributeTok{bootstrap\_options =} \FunctionTok{c}\NormalTok{(}\StringTok{"striped"}\NormalTok{, }\StringTok{"hover"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

N

cid4

CID8.pars

COR8-C.pars

CLA8-C.pars

COR8-NC.pars

CLA8-NC.pars

1

-438.9549

-438.9549

-438.9549

-438.9549

-442.1584

-432.3801

2

-427.5105

-427.5105

-427.5105

-427.5105

-432.3652

-423.9786

3

-410.6673

-410.6673

-410.6673

-410.6673

-414.2528

-407.2375

4

-420.5590

-420.5590

-420.5590

-420.5590

-425.1997

-416.6835

5

-421.6901

-421.6901

-421.6901

-421.6901

-424.8447

-427.4961

6

-414.8487

-414.8487

-414.8487

-414.8487

-420.8153

-411.1675

7

-435.7799

-435.7799

-435.7799

-435.7799

-438.9214

-428.8506

8

-429.2834

-429.2834

-429.2834

-429.2834

-432.1182

-435.2936

9

-421.0965

-421.0965

-421.0965

-421.0965

-426.2918

-416.6131

10

-397.1996

-397.1996

-397.1996

-397.1996

-399.7270

-396.3307

\hypertarget{mean-absolute-error}{%
\paragraph{Mean absolute error}\label{mean-absolute-error}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dcor.pars }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
\StringTok{"cid4"} \OtherTok{=}\NormalTok{ cid4,}
\StringTok{"CID8.pars"}\OtherTok{=}\NormalTok{ CID8.pars }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist,}
\StringTok{"COR8{-}C.pars"}\OtherTok{=}\NormalTok{ COR8\_C.pars }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist,}
\StringTok{"CLA8{-}C.pars"} \OtherTok{=}\NormalTok{ CLA8\_C.pars }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist,}
\StringTok{"COR8{-}NC.pars"} \OtherTok{=}\NormalTok{ COR8\_NC.pars }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist,}
\StringTok{"CLA8{-}NC.pars"} \OtherTok{=}\NormalTok{ CLA8\_NC.pars }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist,}
\NormalTok{)}
\NormalTok{cid4t }\OtherTok{\textless{}{-}}\NormalTok{ cid4}
\NormalTok{dcor.pars }\OtherTok{\textless{}{-}}\NormalTok{ dcor.pars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate\_all}\NormalTok{(}\SpecialCharTok{\textasciitilde{}} \FunctionTok{abs}\NormalTok{(cid4t }\SpecialCharTok{{-}}\NormalTok{ .) )}

\NormalTok{column\_means }\OtherTok{\textless{}{-}}\NormalTok{ dcor.pars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise\_all}\NormalTok{(}\SpecialCharTok{\textasciitilde{}} \FunctionTok{mean}\NormalTok{(.))}

\CommentTok{\# Data}
\NormalTok{delta\_values }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{Delta =} \FunctionTok{names}\NormalTok{(column\_means),}
  \AttributeTok{Value =}\NormalTok{ column\_means }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{slice}\NormalTok{(}\DecValTok{1}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{unlist}\NormalTok{()}
\NormalTok{)}

\FunctionTok{kable}\NormalTok{(column\_means, }\StringTok{"html"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{(}\AttributeTok{bootstrap\_options =} \FunctionTok{c}\NormalTok{(}\StringTok{"striped"}\NormalTok{, }\StringTok{"hover"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

cid4

CID8.pars

COR8-C.pars

CLA8-C.pars

COR8-NC.pars

CLA8-NC.pars

0

0

0

0

3.910447

4.519079

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create the plot}
\FunctionTok{ggplot}\NormalTok{(delta\_values, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Delta, }\AttributeTok{y =}\NormalTok{ Value, }\AttributeTok{label =} \FunctionTok{sprintf}\NormalTok{(}\StringTok{"\%.2e"}\NormalTok{, Value))) }\SpecialCharTok{+}
  \FunctionTok{geom\_col}\NormalTok{(}\AttributeTok{fill =} \FunctionTok{c}\NormalTok{(}\StringTok{"blue"}\NormalTok{, }\StringTok{"blue"}\NormalTok{, }\StringTok{"blue"}\NormalTok{, }\StringTok{"blue"}\NormalTok{, }\StringTok{"red"}\NormalTok{,  }\StringTok{"red"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_text}\NormalTok{(}\AttributeTok{vjust =} \SpecialCharTok{{-}}\FloatTok{0.5}\NormalTok{, }\AttributeTok{angle =} \DecValTok{45}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Comparison of Ln Differences"}\NormalTok{, }\AttributeTok{x =} \StringTok{"Deltas"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Magnitude"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{_main_files/figure-latex/unnamed-chunk-42-1.pdf}

\hypertarget{maximum-likelihood-estimates}{%
\subsubsection{Maximum Likelihood estimates}\label{maximum-likelihood-estimates}}

\hypertarget{likelihood-table-1}{%
\paragraph{Likelihood table}\label{likelihood-table-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cor.pars }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
\StringTok{"N"} \OtherTok{=} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\NormalTok{NSIM),}
\StringTok{"cid4"} \OtherTok{=}\NormalTok{ cid4,}
\StringTok{"CID8"}\OtherTok{=} \FunctionTok{get\_item}\NormalTok{(CID8, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{),}
\StringTok{"COR8{-}C"}\OtherTok{=} \FunctionTok{get\_item}\NormalTok{(COR8\_C, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{),}
\StringTok{"CLA8{-}C"} \OtherTok{=} \FunctionTok{get\_item}\NormalTok{(CLA8\_C, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{),}
\StringTok{"COR8{-}NC"} \OtherTok{=} \FunctionTok{get\_item}\NormalTok{(COR8\_NC, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{),}
\StringTok{"CLA8{-}NC"} \OtherTok{=} \FunctionTok{append}\NormalTok{(}\FunctionTok{get\_item}\NormalTok{(CLA8\_NC, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{), }\ConstantTok{NA}\NormalTok{, }\AttributeTok{after=}\DecValTok{3}\NormalTok{),}
\NormalTok{)}

\FunctionTok{kable}\NormalTok{(cor.pars, }\StringTok{"html"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{(}\AttributeTok{bootstrap\_options =} \FunctionTok{c}\NormalTok{(}\StringTok{"striped"}\NormalTok{, }\StringTok{"hover"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

N

cid4

CID8

COR8-C

CLA8-C

COR8-NC

CLA8-NC

1

-438.9549

-438.9549

-438.9549

-438.9548

-439.3721

-428.8063

2

-427.5105

-427.5105

-427.5105

-427.5105

-428.0217

-423.3527

3

-410.6673

-410.6673

-410.6673

-410.6673

-411.3027

-407.0617

4

-420.5590

-420.5590

-420.5590

-420.5590

-421.3187

NA

5

-421.6901

-421.6901

-421.6901

-421.6901

-422.2212

-417.3582

6

-414.8487

-414.8487

-414.8487

-414.8487

-416.0885

-411.1370

7

-435.7799

-435.7799

-435.7799

-435.7798

-435.6355

-427.4852

8

-429.2834

-429.2834

-429.2834

-429.2834

-428.1737

-424.7370

9

-421.0965

-421.0965

-421.0965

-421.0964

-422.4050

-416.0654

10

-397.1996

-397.1996

-397.1996

-397.1996

-398.2370

-394.4739

\hypertarget{mean-absolute-error-1}{%
\paragraph{Mean absolute error}\label{mean-absolute-error-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dcor.pars }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
\StringTok{"cid4"} \OtherTok{=}\NormalTok{ cid4,}
\StringTok{"CID8"}\OtherTok{=} \FunctionTok{get\_item}\NormalTok{(CID8, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{),}
\StringTok{"COR8{-}C"}\OtherTok{=} \FunctionTok{get\_item}\NormalTok{(COR8\_C, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{),}
\StringTok{"CLA8{-}C"} \OtherTok{=} \FunctionTok{get\_item}\NormalTok{(CLA8\_C, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{),}
\StringTok{"COR8{-}NC"} \OtherTok{=} \FunctionTok{get\_item}\NormalTok{(COR8\_NC, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{),}
\StringTok{"CLA8{-}NC"} \OtherTok{=} \FunctionTok{append}\NormalTok{(}\FunctionTok{get\_item}\NormalTok{(CLA8\_NC, }\StringTok{\textquotesingle{}lnLik\textquotesingle{}}\NormalTok{), }\ConstantTok{NA}\NormalTok{, }\AttributeTok{after=}\DecValTok{3}\NormalTok{),}
\NormalTok{)}

\CommentTok{\# dcor.pars \textless{}{-} tibble(}
\CommentTok{\# "cid4" = cid4,}
\CommentTok{\# "CID8.pars"= CID8.pars \%\textgreater{}\% unlist,}
\CommentTok{\# "COR8{-}C.pars"= COR8\_C.pars \%\textgreater{}\% unlist,}
\CommentTok{\# "CLA8{-}C.pars" = CLA8\_C.pars \%\textgreater{}\% unlist,}
\CommentTok{\# "COR8{-}NC.pars" = COR8\_NC.pars \%\textgreater{}\% unlist,}
\CommentTok{\# "CLA8{-}NC.pars" = CLA8\_NC.pars \%\textgreater{}\% unlist,}
\CommentTok{\# )}
\NormalTok{cid4t }\OtherTok{\textless{}{-}}\NormalTok{ cid4}
\NormalTok{dcor.pars }\OtherTok{\textless{}{-}}\NormalTok{ dcor.pars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate\_all}\NormalTok{(}\SpecialCharTok{\textasciitilde{}} \FunctionTok{abs}\NormalTok{(cid4t }\SpecialCharTok{{-}}\NormalTok{ .) )}

\NormalTok{column\_means }\OtherTok{\textless{}{-}}\NormalTok{ dcor.pars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise\_all}\NormalTok{(}\SpecialCharTok{\textasciitilde{}} \FunctionTok{mean}\NormalTok{(., }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Data}
\NormalTok{delta\_values }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{Delta =} \FunctionTok{names}\NormalTok{(column\_means),}
  \AttributeTok{Value =}\NormalTok{ column\_means }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{slice}\NormalTok{(}\DecValTok{1}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{unlist}\NormalTok{()}
\NormalTok{)}

\FunctionTok{kable}\NormalTok{(column\_means, }\StringTok{"html"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{kable\_styling}\NormalTok{(}\AttributeTok{bootstrap\_options =} \FunctionTok{c}\NormalTok{(}\StringTok{"striped"}\NormalTok{, }\StringTok{"hover"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

cid4

CID8

COR8-C

CLA8-C

COR8-NC

CLA8-NC

0

0

0

2.19e-05

0.7694592

5.172621

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create the plot}
\FunctionTok{ggplot}\NormalTok{(delta\_values, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Delta, }\AttributeTok{y =}\NormalTok{ Value, }\AttributeTok{label =} \FunctionTok{sprintf}\NormalTok{(}\StringTok{"\%.2e"}\NormalTok{, Value))) }\SpecialCharTok{+}
  \FunctionTok{geom\_col}\NormalTok{(}\AttributeTok{fill =} \FunctionTok{c}\NormalTok{(}\StringTok{"blue"}\NormalTok{, }\StringTok{"blue"}\NormalTok{, }\StringTok{"blue"}\NormalTok{, }\StringTok{"blue"}\NormalTok{, }\StringTok{"red"}\NormalTok{,  }\StringTok{"red"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_text}\NormalTok{(}\AttributeTok{vjust =} \SpecialCharTok{{-}}\FloatTok{0.5}\NormalTok{, }\AttributeTok{angle =} \DecValTok{45}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Comparison of Ln Differences"}\NormalTok{, }\AttributeTok{x =} \StringTok{"Deltas"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Magnitude"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{_main_files/figure-latex/unnamed-chunk-44-1.pdf}

\end{document}
